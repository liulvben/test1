var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var m=a[d];if(!(m in c))return;c=c[m]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var m=a.split(".");a=1===m.length;d=m[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var l=0;l<m.length-1;l++){var k=m[l];if(!(k in d))return;d=d[k]}m=m[m.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[m]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,m,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[m]&&($jscomp.propertyToPolyfillSymbol[m]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(m):
$jscomp.POLYFILL_PREFIX+m),$jscomp.defineProperty(d,$jscomp.propertyToPolyfillSymbol[m],{configurable:!0,writable:!0,value:b})))};$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var m in d)$jscomp.owns(d,m)&&(a[m]=d[m])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");
$jscomp.polyfill("globalThis",function(a){return a||$jscomp.global},"es_2020","es3");$jscomp.polyfill("Math.imul",function(a){return a?a:function(b,c){b=Number(b);c=Number(c);var d=b&65535,m=c&65535;return d*m+((b>>>16&65535)*m+d*(c>>>16&65535)<<16>>>0)|0}},"es6","es3");$jscomp.polyfill("Math.fround",function(a){if(a)return a;if($jscomp.SIMPLE_FROUND_POLYFILL||"function"!==typeof Float32Array)return function(c){return c};var b=new Float32Array(1);return function(c){b[0]=c;return b[0]}},"es6","es3");
$jscomp.polyfill("Math.clz32",function(a){return a?a:function(b){b=Number(b)>>>0;if(0===b)return 32;var c=0;0===(b&4294901760)&&(b<<=16,c+=16);0===(b&4278190080)&&(b<<=8,c+=8);0===(b&4026531840)&&(b<<=4,c+=4);0===(b&3221225472)&&(b<<=2,c+=2);0===(b&2147483648)&&c++;return c}},"es6","es3");$jscomp.polyfill("Math.trunc",function(a){return a?a:function(b){b=Number(b);if(isNaN(b)||Infinity===b||-Infinity===b||0===b)return b;var c=Math.floor(Math.abs(b));return 0>b?-c:c}},"es6","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(b,c){var d=$jscomp.checkStringArgs(this,b,"startsWith");b+="";var m=d.length,l=b.length;c=Math.max(0,Math.min(c|0,d.length));for(var k=0;k<l&&c<m;)if(d[c++]!=b[k++])return!1;return k>=l}},"es6","es3");$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};
$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(k){return k instanceof m?k:new m(function(n,p){n(k)})}if(a&&(!($jscomp.FORCE_POLYFILL_PROMISE||$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION&&"undefined"===typeof $jscomp.global.PromiseRejectionEvent)||!$jscomp.global.Promise||-1===$jscomp.global.Promise.toString().indexOf("[native code]")))return a;b.prototype.asyncExecute=function(k){if(null==this.batch_){this.batch_=[];var n=this;this.asyncExecuteFunction(function(){n.executeBatch_()})}this.batch_.push(k)};
var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(k){d(k,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var k=this.batch_;this.batch_=[];for(var n=0;n<k.length;++n){var p=k[n];k[n]=null;try{p()}catch(q){this.asyncThrow_(q)}}}this.batch_=null};b.prototype.asyncThrow_=function(k){this.asyncExecuteFunction(function(){throw k;})};var m=function(k){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];this.isRejectionHandled_=!1;var n=this.createResolveAndReject_();
try{k(n.resolve,n.reject)}catch(p){n.reject(p)}};m.prototype.createResolveAndReject_=function(){function k(q){return function(h){p||(p=!0,q.call(n,h))}}var n=this,p=!1;return{resolve:k(this.resolveTo_),reject:k(this.reject_)}};m.prototype.resolveTo_=function(k){if(k===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(k instanceof m)this.settleSameAsPromise_(k);else{a:switch(typeof k){case "object":var n=null!=k;break a;case "function":n=!0;break a;default:n=!1}n?this.resolveToNonPromiseObj_(k):
this.fulfill_(k)}};m.prototype.resolveToNonPromiseObj_=function(k){var n=void 0;try{n=k.then}catch(p){this.reject_(p);return}"function"==typeof n?this.settleSameAsThenable_(n,k):this.fulfill_(k)};m.prototype.reject_=function(k){this.settle_(2,k)};m.prototype.fulfill_=function(k){this.settle_(1,k)};m.prototype.settle_=function(k,n){if(0!=this.state_)throw Error("Cannot settle("+k+", "+n+"): Promise already settled in state"+this.state_);this.state_=k;this.result_=n;2===this.state_&&this.scheduleUnhandledRejectionCheck_();
this.executeOnSettledCallbacks_()};m.prototype.scheduleUnhandledRejectionCheck_=function(){var k=this;d(function(){if(k.notifyUnhandledRejection_()){var n=$jscomp.global.console;"undefined"!==typeof n&&n.error(k.result_)}},1)};m.prototype.notifyUnhandledRejection_=function(){if(this.isRejectionHandled_)return!1;var k=$jscomp.global.CustomEvent,n=$jscomp.global.Event,p=$jscomp.global.dispatchEvent;if("undefined"===typeof p)return!0;"function"===typeof k?k=new k("unhandledrejection",{cancelable:!0}):
"function"===typeof n?k=new n("unhandledrejection",{cancelable:!0}):(k=$jscomp.global.document.createEvent("CustomEvent"),k.initCustomEvent("unhandledrejection",!1,!0,k));k.promise=this;k.reason=this.result_;return p(k)};m.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var k=0;k<this.onSettledCallbacks_.length;++k)l.asyncExecute(this.onSettledCallbacks_[k]);this.onSettledCallbacks_=null}};var l=new b;m.prototype.settleSameAsPromise_=function(k){var n=this.createResolveAndReject_();
k.callWhenSettled_(n.resolve,n.reject)};m.prototype.settleSameAsThenable_=function(k,n){var p=this.createResolveAndReject_();try{k.call(n,p.resolve,p.reject)}catch(q){p.reject(q)}};m.prototype.then=function(k,n){function p(f,g){return"function"==typeof f?function(t){try{q(f(t))}catch(r){h(r)}}:g}var q,h,e=new m(function(f,g){q=f;h=g});this.callWhenSettled_(p(k,q),p(n,h));return e};m.prototype.catch=function(k){return this.then(void 0,k)};m.prototype.callWhenSettled_=function(k,n){function p(){switch(q.state_){case 1:k(q.result_);
break;case 2:n(q.result_);break;default:throw Error("Unexpected state: "+q.state_);}}var q=this;null==this.onSettledCallbacks_?l.asyncExecute(p):this.onSettledCallbacks_.push(p);this.isRejectionHandled_=!0};m.resolve=c;m.reject=function(k){return new m(function(n,p){p(k)})};m.race=function(k){return new m(function(n,p){for(var q=$jscomp.makeIterator(k),h=q.next();!h.done;h=q.next())c(h.value).callWhenSettled_(n,p)})};m.all=function(k){var n=$jscomp.makeIterator(k),p=n.next();return p.done?c([]):new m(function(q,
h){function e(t){return function(r){f[t]=r;g--;0==g&&q(f)}}var f=[],g=0;do f.push(void 0),g++,c(p.value).callWhenSettled_(e(f.length-1),h),p=n.next();while(!p.done)})};return m},"es6","es3");$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(b,c){var d=$jscomp.checkStringArgs(this,b,"endsWith");b+="";void 0===c&&(c=d.length);c=Math.max(0,Math.min(c|0,d.length));for(var m=b.length;0<m&&0<c;)if(d[--c]!=b[--m])return!1;return 0>=m}},"es6","es3");
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(b){var c=$jscomp.checkStringArgs(this,null,"repeat");if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}},"es6","es3");$jscomp.stringPadding=function(a,b){a=void 0!==a?String(a):" ";return 0<b&&a?a.repeat(Math.ceil(b/a.length)).substring(0,b):""};
$jscomp.polyfill("String.prototype.padStart",function(a){return a?a:function(b,c){var d=$jscomp.checkStringArgs(this,null,"padStart");return $jscomp.stringPadding(c,b-d.length)+d}},"es8","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(b,c){var d=this;d instanceof String&&(d=String(d));var m=d.length;c=c||0;for(0>c&&(c=Math.max(c+m,0));c<m;c++){var l=d[c];if(l===b||Object.is(l,b))return!0}return!1}},"es7","es3");$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(b,c){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,c||0)}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(b,c,d){var m=this.length||0;0>c&&(c=Math.max(0,m+c));if(null==d||d>m)d=m;d=Number(d);0>d&&(d=Math.max(0,m+d));for(c=Number(c||0);c<d;c++)this[c]=b;return this}},"es6","es3");$jscomp.typedArrayFill=function(a){return a?a:Array.prototype.fill};$jscomp.polyfill("Int8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Uint8ClampedArray.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint16Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Int32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.polyfill("Float32Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");
$jscomp.polyfill("Float64Array.prototype.fill",$jscomp.typedArrayFill,"es6","es5");$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(m,l){this.$jscomp$symbol$id_=m;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:l})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c=0,d=function(m){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(m||"")+"_"+c++,m)};return d},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d=!1,m={next:function(){if(!d&&c<a.length){var l=c++;return{value:b(l,a[l]),done:!1}}d=!0;return{done:!0,value:void 0}}};m[Symbol.iterator]=function(){return m};return m};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
$jscomp.polyfill("Array.prototype.copyWithin",function(a){function b(c){c=Number(c);return Infinity===c||-Infinity===c?c:c|0}return a?a:function(c,d,m){var l=this.length;c=b(c);d=b(d);m=void 0===m?l:b(m);c=0>c?Math.max(l+c,0):Math.min(c,l);d=0>d?Math.max(l+d,0):Math.min(d,l);m=0>m?Math.max(l+m,0):Math.min(m,l);if(c<d)for(;d<m;)d in this?this[c++]=this[d++]:(delete this[c++],d++);else for(m=Math.min(m,l+d-c),c+=m-d;m>d;)--m in this?this[--c]=this[m]:delete this[--c];return this}},"es6","es3");
$jscomp.typedArrayCopyWithin=function(a){return a?a:Array.prototype.copyWithin};$jscomp.polyfill("Int8Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Uint8Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Uint8ClampedArray.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Int16Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");
$jscomp.polyfill("Uint16Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Int32Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Uint32Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Float32Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");$jscomp.polyfill("Float64Array.prototype.copyWithin",$jscomp.typedArrayCopyWithin,"es6","es5");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(c,d,m){return c==a&&"q"==d&&m==b}}));return!0===b.q}catch(c){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var q=Object.seal({}),h=Object.seal({}),e=new a([[q,2],[h,3]]);if(2!=e.get(q)||3!=e.get(h))return!1;e.delete(q);e.set(h,4);return!e.has(q)&&4==e.get(h)}catch(f){return!1}}function c(){}function d(q){var h=typeof q;return"object"===h&&null!==q||"function"===h}function m(q){if(!$jscomp.owns(q,k)){var h=new c;$jscomp.defineProperty(q,k,{value:h})}}function l(q){if(!$jscomp.ISOLATE_POLYFILLS){var h=Object[q];h&&(Object[q]=
function(e){if(e instanceof c)return e;Object.isExtensible(e)&&m(e);return h(e)})}}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var k="$jscomp_hidden_"+Math.random();l("freeze");l("preventExtensions");l("seal");var n=0,p=function(q){this.id_=(n+=Math.random()+1).toString();if(q){q=$jscomp.makeIterator(q);for(var h;!(h=q.next()).done;)h=h.value,this.set(h[0],h[1])}};p.prototype.set=function(q,h){if(!d(q))throw Error("Invalid WeakMap key");
m(q);if(!$jscomp.owns(q,k))throw Error("WeakMap key fail: "+q);q[k][this.id_]=h;return this};p.prototype.get=function(q){return d(q)&&$jscomp.owns(q,k)?q[k][this.id_]:void 0};p.prototype.has=function(q){return d(q)&&$jscomp.owns(q,k)&&$jscomp.owns(q[k],this.id_)};p.prototype.delete=function(q){return d(q)&&$jscomp.owns(q,k)&&$jscomp.owns(q[k],this.id_)?delete q[k][this.id_]:!1};return p},"es6","es3");$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(c){}return!1};
$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;$jscomp.polyfill("Object.setPrototypeOf",function(a){return a||$jscomp.setPrototypeOf},"es6","es5");
var Module="undefined"!=typeof Module?Module:{},moduleOverrides=Object.assign({},Module),arguments_=[],thisProgram="./this.program",quit_=function(a,b){throw b;},ENVIRONMENT_IS_WEB="object"==typeof window,ENVIRONMENT_IS_WORKER="function"==typeof importScripts,ENVIRONMENT_IS_NODE="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;
if(Module.ENVIRONMENT)throw Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)");var scriptDirectory="";function locateFile(a){return Module.locateFile?Module.locateFile(a,scriptDirectory):scriptDirectory+a}var read_,readAsync,readBinary;
if(ENVIRONMENT_IS_NODE){if("undefined"==typeof process||!process.release||"node"!==process.release.name)throw Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");var nodeVersion=process.versions.node,numericVersion=nodeVersion.split(".").slice(0,3);numericVersion=1E4*numericVersion[0]+100*numericVersion[1]+1*numericVersion[2].split("-")[0];var minVersion=16E4;
if(16E4>numericVersion)throw Error("This emscripten-generated code requires node v16.0.0 (detected v"+nodeVersion+")");var fs=require("fs"),nodePath=require("path");scriptDirectory=ENVIRONMENT_IS_WORKER?nodePath.dirname(scriptDirectory)+"/":__dirname+"/";read_=function(a,b){a=isFileURI(a)?new URL(a):nodePath.normalize(a);return fs.readFileSync(a,b?void 0:"utf8")};readBinary=function(a){a=read_(a,!0);a.buffer||(a=new Uint8Array(a));assert(a.buffer);return a};readAsync=function(a,b,c,d){d=void 0===
d?!0:d;a=isFileURI(a)?new URL(a):nodePath.normalize(a);fs.readFile(a,d?void 0:"utf8",function(m,l){m?c(m):b(d?l.buffer:l)})};!Module.thisProgram&&1<process.argv.length&&(thisProgram=process.argv[1].replace(/\\/g,"/"));arguments_=process.argv.slice(2);"undefined"!=typeof module&&(module.exports=Module);process.on("uncaughtException",function(a){if(!("unwind"===a||a instanceof ExitStatus||a.context instanceof ExitStatus))throw a;});quit_=function(a,b){process.exitCode=a;throw b;};Module.inspect=function(){return"[Emscripten Module object]"}}else if(ENVIRONMENT_IS_SHELL){if("object"==
typeof process&&"function"===typeof require||"object"==typeof window||"function"==typeof importScripts)throw Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");"undefined"!=typeof read&&(read_=read);readBinary=function(a){if("function"==typeof readbuffer)return new Uint8Array(readbuffer(a));a=read(a,"binary");assert("object"==typeof a);return a};readAsync=function(a,
b,c){setTimeout(function(){return b(readBinary(a))})};"undefined"==typeof clearTimeout&&(globalThis.clearTimeout=function(a){});"undefined"==typeof setTimeout&&(globalThis.setTimeout=function(a){return"function"==typeof a?a():abort()});"undefined"!=typeof scriptArgs?arguments_=scriptArgs:"undefined"!=typeof arguments&&(arguments_=arguments);"function"==typeof quit&&(quit_=function(a,b){setTimeout(function(){if(!(b instanceof ExitStatus)){var c=b;b&&"object"==typeof b&&b.stack&&(c=[b,b.stack]);err("exiting due to exception: "+
c)}quit(a)});throw b;});"undefined"!=typeof print&&("undefined"==typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!=typeof printErr?printErr:print)}else if(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER){ENVIRONMENT_IS_WORKER?scriptDirectory=self.location.href:"undefined"!=typeof document&&document.currentScript&&(scriptDirectory=document.currentScript.src);scriptDirectory=0!==scriptDirectory.indexOf("blob:")?scriptDirectory.substr(0,scriptDirectory.replace(/[?#].*/,
"").lastIndexOf("/")+1):"";if("object"!=typeof window&&"function"!=typeof importScripts)throw Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");read_=function(a){var b=new XMLHttpRequest;b.open("GET",a,!1);b.send(null);return b.responseText};ENVIRONMENT_IS_WORKER&&(readBinary=function(a){var b=new XMLHttpRequest;b.open("GET",a,!1);b.responseType="arraybuffer";
b.send(null);return new Uint8Array(b.response)});readAsync=function(a,b,c){var d=new XMLHttpRequest;d.open("GET",a,!0);d.responseType="arraybuffer";d.onload=function(){200==d.status||0==d.status&&d.response?b(d.response):c()};d.onerror=c;d.send(null)}}else throw Error("environment detection error");var out=Module.print||console.log.bind(console),err=Module.printErr||console.error.bind(console);Object.assign(Module,moduleOverrides);moduleOverrides=null;checkIncomingModuleAPI();
Module.arguments&&(arguments_=Module.arguments);legacyModuleProp("arguments","arguments_");Module.thisProgram&&(thisProgram=Module.thisProgram);legacyModuleProp("thisProgram","thisProgram");Module.quit&&(quit_=Module.quit);legacyModuleProp("quit","quit_");assert("undefined"==typeof Module.memoryInitializerPrefixURL,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead");assert("undefined"==typeof Module.pthreadMainPrefixURL,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead");
assert("undefined"==typeof Module.cdInitializerPrefixURL,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead");assert("undefined"==typeof Module.filePackagePrefixURL,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead");assert("undefined"==typeof Module.read,"Module.read option was removed (modify read_ in JS)");assert("undefined"==typeof Module.readAsync,"Module.readAsync option was removed (modify readAsync in JS)");
assert("undefined"==typeof Module.readBinary,"Module.readBinary option was removed (modify readBinary in JS)");assert("undefined"==typeof Module.setWindowTitle,"Module.setWindowTitle option was removed (modify emscripten_set_window_title in JS)");assert("undefined"==typeof Module.TOTAL_MEMORY,"Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY");legacyModuleProp("asm","wasmExports");legacyModuleProp("read","read_");legacyModuleProp("readAsync","readAsync");legacyModuleProp("readBinary","readBinary");
legacyModuleProp("setWindowTitle","setWindowTitle");
var IDBFS="IDBFS is no longer included by default; build with -lidbfs.js",PROXYFS="PROXYFS is no longer included by default; build with -lproxyfs.js",WORKERFS="WORKERFS is no longer included by default; build with -lworkerfs.js",FETCHFS="FETCHFS is no longer included by default; build with -lfetchfs.js",ICASEFS="ICASEFS is no longer included by default; build with -licasefs.js",JSFILEFS="JSFILEFS is no longer included by default; build with -ljsfilefs.js",OPFS="OPFS is no longer included by default; build with -lopfs.js",
NODEFS="NODEFS is no longer included by default; build with -lnodefs.js";assert(!ENVIRONMENT_IS_SHELL,"shell environment detected but not enabled at build time.  Add 'shell' to `-sENVIRONMENT` to enable.");var wasmBinary;Module.wasmBinary&&(wasmBinary=Module.wasmBinary);legacyModuleProp("wasmBinary","wasmBinary");"object"!=typeof WebAssembly&&abort("no native wasm support detected");var wasmMemory,ABORT=!1,EXITSTATUS;function assert(a,b){a||abort("Assertion failed"+(b?": "+b:""))}
var HEAP,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateMemoryViews(){var a=wasmMemory.buffer;Module.HEAP8=HEAP8=new Int8Array(a);Module.HEAP16=HEAP16=new Int16Array(a);Module.HEAPU8=HEAPU8=new Uint8Array(a);Module.HEAPU16=HEAPU16=new Uint16Array(a);Module.HEAP32=HEAP32=new Int32Array(a);Module.HEAPU32=HEAPU32=new Uint32Array(a);Module.HEAPF32=HEAPF32=new Float32Array(a);Module.HEAPF64=HEAPF64=new Float64Array(a)}assert(!Module.STACK_SIZE,"STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time");
assert("undefined"!=typeof Int32Array&&"undefined"!==typeof Float64Array&&void 0!=Int32Array.prototype.subarray&&void 0!=Int32Array.prototype.set,"JS engine does not provide full typed array support");assert(!Module.wasmMemory,"Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally");assert(!Module.INITIAL_MEMORY,"Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically");
function writeStackCookie(){var a=_emscripten_stack_get_end();assert(0==(a&3));0==a&&(a+=4);HEAPU32[a>>2]=34821223;HEAPU32[a+4>>2]=2310721022;HEAPU32[0]=1668509029}
function checkStackCookie(){if(!ABORT){var a=_emscripten_stack_get_end();0==a&&(a+=4);var b=HEAPU32[a>>2],c=HEAPU32[a+4>>2];34821223==b&&2310721022==c||abort("Stack overflow! Stack cookie has been overwritten at "+ptrToString(a)+", expected hex dwords 0x89BACDFE and 0x2135467, but received "+ptrToString(c)+" "+ptrToString(b));1668509029!=HEAPU32[0]&&abort("Runtime error: The application has corrupted its heap memory area (address zero)!")}}
(function(){var a=new Int16Array(1),b=new Int8Array(a.buffer);a[0]=25459;if(115!==b[0]||99!==b[1])throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)";})();var __ATPRERUN__=[],__ATINIT__=[],__ATEXIT__=[],__ATPOSTRUN__=[],runtimeInitialized=!1;function preRun(){if(Module.preRun)for("function"==typeof Module.preRun&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}
function initRuntime(){assert(!runtimeInitialized);runtimeInitialized=!0;checkStackCookie();Module.noFSInit||FS.init.initialized||FS.init();FS.ignorePermissions=!1;TTY.init();SOCKFS.root=FS.mount(SOCKFS,{},null);callRuntimeCallbacks(__ATINIT__)}function postRun(){checkStackCookie();if(Module.postRun)for("function"==typeof Module.postRun&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}
function addOnPreRun(a){__ATPRERUN__.unshift(a)}function addOnInit(a){__ATINIT__.unshift(a)}function addOnExit(a){}function addOnPostRun(a){__ATPOSTRUN__.unshift(a)}assert(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");assert(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");assert(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");
assert(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null,runDependencyTracking={};function getUniqueRunDependency(a){for(var b=a;;){if(!runDependencyTracking[a])return a;a=b+Math.random()}}
function addRunDependency(a){runDependencies++;Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies);a?(assert(!runDependencyTracking[a]),runDependencyTracking[a]=1,null===runDependencyWatcher&&"undefined"!=typeof setInterval&&(runDependencyWatcher=setInterval(function(){if(ABORT)clearInterval(runDependencyWatcher),runDependencyWatcher=null;else{var b=!1,c;for(c in runDependencyTracking)b||(b=!0,err("still waiting on run dependencies:")),err("dependency: "+c);b&&err("(end of list)")}},
1E4))):err("warning: run dependency added without ID")}function removeRunDependency(a){runDependencies--;Module.monitorRunDependencies&&Module.monitorRunDependencies(runDependencies);a?(assert(runDependencyTracking[a]),delete runDependencyTracking[a]):err("warning: run dependency removed without ID");0==runDependencies&&(null!==runDependencyWatcher&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled&&(a=dependenciesFulfilled,dependenciesFulfilled=null,a()))}
function abort(a){if(Module.onAbort)Module.onAbort(a);a="Aborted("+a+")";err(a);ABORT=!0;EXITSTATUS=1;throw new WebAssembly.RuntimeError(a);}var dataURIPrefix="data:application/octet-stream;base64,",isDataURI=function(a){return a.startsWith(dataURIPrefix)},isFileURI=function(a){return a.startsWith("file://")};
function createExportWrapper(a){return function(){assert(runtimeInitialized,"native function `"+a+"` called before runtime initialization");var b=wasmExports[a];assert(b,"exported native function `"+a+"` not found");return b.apply(null,arguments)}}var wasmBinaryFile;wasmBinaryFile="photon-em.wasm";isDataURI(wasmBinaryFile)||(wasmBinaryFile=locateFile(wasmBinaryFile));
function getBinarySync(a){if(a==wasmBinaryFile&&wasmBinary)return new Uint8Array(wasmBinary);if(readBinary)return readBinary(a);throw"both async and sync fetching of the wasm failed";}
function getBinaryPromise(a){if(!wasmBinary&&(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)){if("function"==typeof fetch&&!isFileURI(a))return fetch(a,{credentials:"same-origin"}).then(function(b){if(!b.ok)throw"failed to load wasm binary file at '"+a+"'";return b.arrayBuffer()}).catch(function(){return getBinarySync(a)});if(readAsync)return new Promise(function(b,c){readAsync(a,function(d){return b(new Uint8Array(d))},c)})}return Promise.resolve().then(function(){return getBinarySync(a)})}
function instantiateArrayBuffer(a,b,c){return getBinaryPromise(a).then(function(d){return WebAssembly.instantiate(d,b)}).then(function(d){return d}).then(c,function(d){err("failed to asynchronously prepare wasm: "+d);isFileURI(wasmBinaryFile)&&err("warning: Loading from a file URI ("+wasmBinaryFile+") is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing");abort(d)})}
function instantiateAsync(a,b,c,d){return a||"function"!=typeof WebAssembly.instantiateStreaming||isDataURI(b)||isFileURI(b)||ENVIRONMENT_IS_NODE||"function"!=typeof fetch?instantiateArrayBuffer(b,c,d):fetch(b,{credentials:"same-origin"}).then(function(m){return WebAssembly.instantiateStreaming(m,c).then(d,function(l){err("wasm streaming compile failed: "+l);err("falling back to ArrayBuffer instantiation");return instantiateArrayBuffer(b,c,d)})})}
function createWasm(){function a(d,m){wasmExports=d.exports;wasmMemory=wasmExports.memory;assert(wasmMemory,"memory not found in wasm exports");updateMemoryViews();wasmTable=wasmExports.__indirect_function_table;assert(wasmTable,"table not found in wasm exports");addOnInit(wasmExports.__wasm_call_ctors);removeRunDependency("wasm-instantiate");return wasmExports}var b={env:wasmImports,wasi_snapshot_preview1:wasmImports};addRunDependency("wasm-instantiate");var c=Module;if(Module.instantiateWasm)try{return Module.instantiateWasm(b,
a)}catch(d){return err("Module.instantiateWasm callback failed with error: "+d),!1}instantiateAsync(wasmBinary,wasmBinaryFile,b,function(d){assert(Module===c,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?");c=null;a(d.instance)});return{}}var tempDouble,tempI64;
function legacyModuleProp(a,b,c){c=void 0===c?!0:c;Object.getOwnPropertyDescriptor(Module,a)||Object.defineProperty(Module,a,{configurable:!0,get:function(){abort("`Module."+a+"` has been replaced by `"+b+"`"+(c?" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)":""))}})}
function ignoredModuleProp(a){Object.getOwnPropertyDescriptor(Module,a)&&abort("`Module."+a+"` was supplied but `"+a+"` not included in INCOMING_MODULE_JS_API")}function isExportedByForceFilesystem(a){return"FS_createPath"===a||"FS_createDataFile"===a||"FS_createPreloadedFile"===a||"FS_unlink"===a||"addRunDependency"===a||"FS_createLazyFile"===a||"FS_createDevice"===a||"removeRunDependency"===a}
function missingGlobal(a,b){"undefined"!==typeof globalThis&&Object.defineProperty(globalThis,a,{configurable:!0,get:function(){warnOnce("`"+a+"` is not longer defined by emscripten. "+b)}})}missingGlobal("buffer","Please use HEAP8.buffer or wasmMemory.buffer");missingGlobal("asm","Please use wasmExports instead");
function missingLibrarySymbol(a){"undefined"===typeof globalThis||Object.getOwnPropertyDescriptor(globalThis,a)||Object.defineProperty(globalThis,a,{configurable:!0,get:function(){var b="`"+a+"` is a library symbol and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line",c=a;c.startsWith("_")||(c="$"+a);b+=" (e.g. -sDEFAULT_LIBRARY_FUNCS_TO_INCLUDE='"+c+"')";isExportedByForceFilesystem(a)&&(b+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you");
warnOnce(b)}});unexportedRuntimeSymbol(a)}function unexportedRuntimeSymbol(a){Object.getOwnPropertyDescriptor(Module,a)||Object.defineProperty(Module,a,{configurable:!0,get:function(){var b="'"+a+"' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the Emscripten FAQ)";isExportedByForceFilesystem(a)&&(b+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you");abort(b)}})}function dbg(a){console.warn.apply(console,arguments)}
var ASM_CONSTS={266696:function(a,b){Module.websocket.subprotocol=UTF8ToString(a);Module.websocket.url=UTF8ToString(b)}};function ExitStatus(a){this.name="ExitStatus";this.message="Program terminated with exit("+a+")";this.status=a}
var callRuntimeCallbacks=function(a){for(;0<a.length;)a.shift()(Module)},withStackSave=function(a){var b=stackSave();a=a();stackRestore(b);return a},lengthBytesUTF8=function(a){for(var b=0,c=0;c<a.length;++c){var d=a.charCodeAt(c);127>=d?b++:2047>=d?b+=2:55296<=d&&57343>=d?(b+=4,++c):b+=3}return b},stringToUTF8Array=function(a,b,c,d){assert("string"===typeof a);if(!(0<d))return 0;var m=c;d=c+d-1;for(var l=0;l<a.length;++l){var k=a.charCodeAt(l);if(55296<=k&&57343>=k){var n=a.charCodeAt(++l);k=65536+
((k&1023)<<10)|n&1023}if(127>=k){if(c>=d)break;b[c++]=k}else{if(2047>=k){if(c+1>=d)break;b[c++]=192|k>>6}else{if(65535>=k){if(c+2>=d)break;b[c++]=224|k>>12}else{if(c+3>=d)break;1114111<k&&warnOnce("Invalid Unicode code point "+ptrToString(k)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF).");b[c++]=240|k>>18;b[c++]=128|k>>12&63}b[c++]=128|k>>6&63}b[c++]=128|k&63}}b[c]=0;return c-m},stringToUTF8=function(a,b,c){assert("number"==
typeof c,"stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!");return stringToUTF8Array(a,HEAPU8,b,c)},stringToUTF8OnStack=function(a){var b=lengthBytesUTF8(a)+1,c=stackAlloc(b);stringToUTF8(a,c,b);return c},UTF8Decoder="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0,UTF8ArrayToString=function(a,b,c){var d=b+c;for(c=b;a[c]&&!(c>=d);)++c;if(16<c-b&&a.buffer&&UTF8Decoder)return UTF8Decoder.decode(a.subarray(b,c));
for(d="";b<c;){var m=a[b++];if(m&128){var l=a[b++]&63;if(192==(m&224))d+=String.fromCharCode((m&31)<<6|l);else{var k=a[b++]&63;224==(m&240)?m=(m&15)<<12|l<<6|k:(240!=(m&248)&&warnOnce("Invalid UTF-8 leading byte "+ptrToString(m)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),m=(m&7)<<18|l<<12|k<<6|a[b++]&63);65536>m?d+=String.fromCharCode(m):(m-=65536,d+=String.fromCharCode(55296|m>>10,56320|m&1023))}}else d+=String.fromCharCode(m)}return d},UTF8ToString=function(a,
b){assert("number"==typeof a);return a?UTF8ArrayToString(HEAPU8,a,b):""},demangle=function(a){demangle.recursionGuard=(demangle.recursionGuard|0)+1;return 1<demangle.recursionGuard?a:withStackSave(function(){try{var b=a;b.startsWith("__Z")&&(b=b.substr(1));var c=stringToUTF8OnStack(b),d=stackAlloc(4),m=___cxa_demangle(c,0,0,d);if(0===HEAP32[d>>2]&&m)return UTF8ToString(m)}catch(l){}finally{_free(m),2>demangle.recursionGuard&&--demangle.recursionGuard}return a})};
function getValue(a,b){b=void 0===b?"i8":b;b.endsWith("*")&&(b="*");switch(b){case "i1":return HEAP8[a>>0];case "i8":return HEAP8[a>>0];case "i16":return HEAP16[a>>1];case "i32":return HEAP32[a>>2];case "i64":abort("to do getValue(i64) use WASM_BIGINT");case "float":return HEAPF32[a>>2];case "double":return HEAPF64[a>>3];case "*":return HEAPU32[a>>2];default:abort("invalid type for getValue: "+b)}}
var noExitRuntime=Module.noExitRuntime||!0,ptrToString=function(a){assert("number"===typeof a);return"0x"+(a>>>0).toString(16).padStart(8,"0")};
function setValue(a,b,c){c=void 0===c?"i8":c;c.endsWith("*")&&(c="*");switch(c){case "i1":HEAP8[a>>0]=b;break;case "i8":HEAP8[a>>0]=b;break;case "i16":HEAP16[a>>1]=b;break;case "i32":HEAP32[a>>2]=b;break;case "i64":abort("to do setValue(i64) use WASM_BIGINT");case "float":HEAPF32[a>>2]=b;break;case "double":HEAPF64[a>>3]=b;break;case "*":HEAPU32[a>>2]=b;break;default:abort("invalid type for setValue: "+c)}}
function jsStackTrace(){var a=Error();if(!a.stack){try{throw Error();}catch(b){a=b}if(!a.stack)return"(no stack trace available)"}return a.stack.toString()}var demangleAll=function(a){return a.replace(/\b_Z[\w\d_]+/g,function(b){var c=demangle(b);return b===c?b:c+" ["+b+"]"})};function stackTrace(){var a=jsStackTrace();Module.extraStackTrace&&(a+="\n"+Module.extraStackTrace());return demangleAll(a)}
var warnOnce=function(a){warnOnce.shown||(warnOnce.shown={});warnOnce.shown[a]||(warnOnce.shown[a]=1,ENVIRONMENT_IS_NODE&&(a="warning: "+a),err(a))},___assert_fail=function(a,b,c,d){abort("Assertion failed: "+UTF8ToString(a)+", at: "+[b?UTF8ToString(b):"unknown filename",c,d?UTF8ToString(d):"unknown function"])};
function ExceptionInfo(a){this.excPtr=a;this.ptr=a-24;this.set_type=function(b){HEAPU32[this.ptr+4>>2]=b};this.get_type=function(){return HEAPU32[this.ptr+4>>2]};this.set_destructor=function(b){HEAPU32[this.ptr+8>>2]=b};this.get_destructor=function(){return HEAPU32[this.ptr+8>>2]};this.set_caught=function(b){HEAP8[this.ptr+12>>0]=b?1:0};this.get_caught=function(){return 0!=HEAP8[this.ptr+12>>0]};this.set_rethrown=function(b){HEAP8[this.ptr+13>>0]=b?1:0};this.get_rethrown=function(){return 0!=HEAP8[this.ptr+
13>>0]};this.init=function(b,c){this.set_adjusted_ptr(0);this.set_type(b);this.set_destructor(c)};this.set_adjusted_ptr=function(b){HEAPU32[this.ptr+16>>2]=b};this.get_adjusted_ptr=function(){return HEAPU32[this.ptr+16>>2]};this.get_exception_ptr=function(){if(___cxa_is_pointer_type(this.get_type()))return HEAPU32[this.excPtr>>2];var b=this.get_adjusted_ptr();return 0!==b?b:this.excPtr}}
var exceptionLast=0,uncaughtExceptionCount=0,___cxa_throw=function(a,b,c){(new ExceptionInfo(a)).init(b,c);exceptionLast=a;uncaughtExceptionCount++;assert(!1,"Exception thrown, but exception catching is not enabled. Compile with -sNO_DISABLE_EXCEPTION_CATCHING or -sEXCEPTION_CATCHING_ALLOWED=[..] to catch.")},PATH={isAbs:function(a){return"/"===a.charAt(0)},splitPath:function(a){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(a).slice(1)},normalizeArray:function(a,b){for(var c=
0,d=a.length-1;0<=d;d--){var m=a[d];"."===m?a.splice(d,1):".."===m?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c;c--)a.unshift("..");return a},normalize:function(a){var b=PATH.isAbs(a),c="/"===a.substr(-1);(a=PATH.normalizeArray(a.split("/").filter(function(d){return!!d}),!b).join("/"))||b||(a=".");a&&c&&(a+="/");return(b?"/":"")+a},dirname:function(a){var b=PATH.splitPath(a);a=b[0];b=b[1];if(!a&&!b)return".";b&&(b=b.substr(0,b.length-1));return a+b},basename:function(a){if("/"===a)return"/";
a=PATH.normalize(a);a=a.replace(/\/$/,"");var b=a.lastIndexOf("/");return-1===b?a:a.substr(b+1)},join:function(){var a=Array.prototype.slice.call(arguments);return PATH.normalize(a.join("/"))},join2:function(a,b){return PATH.normalize(a+"/"+b)}},initRandomFill=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues)return function(c){return crypto.getRandomValues(c)};if(ENVIRONMENT_IS_NODE)try{var a=require("crypto");if(a.randomFillSync)return function(c){return a.randomFillSync(c)};
var b=a.randomBytes;return function(c){return c.set(b(c.byteLength)),c}}catch(c){}abort("no cryptographic support found for randomDevice. consider polyfilling it if you want to use something insecure like Math.random(), e.g. put this in a --pre-js: var crypto = { getRandomValues: (array) => { for (var i = 0; i < array.length; i++) array[i] = (Math.random()*256)|0 } };")},randomFill=function(a){return(randomFill=initRandomFill())(a)},PATH_FS={resolve:function(){for(var a="",b=!1,c=arguments.length-
1;-1<=c&&!b;c--){b=0<=c?arguments[c]:FS.cwd();if("string"!=typeof b)throw new TypeError("Arguments to path.resolve must be strings");if(!b)return"";a=b+"/"+a;b=PATH.isAbs(b)}a=PATH.normalizeArray(a.split("/").filter(function(d){return!!d}),!b).join("/");return(b?"/":"")+a||"."},relative:function(a,b){function c(k){for(var n=0;n<k.length&&""===k[n];n++);for(var p=k.length-1;0<=p&&""===k[p];p--);return n>p?[]:k.slice(n,p-n+1)}a=PATH_FS.resolve(a).substr(1);b=PATH_FS.resolve(b).substr(1);a=c(a.split("/"));
b=c(b.split("/"));for(var d=Math.min(a.length,b.length),m=d,l=0;l<d;l++)if(a[l]!==b[l]){m=l;break}d=[];for(l=m;l<a.length;l++)d.push("..");d=d.concat(b.slice(m));return d.join("/")}},FS_stdin_getChar_buffer=[];function intArrayFromString(a,b,c){c=0<c?c:lengthBytesUTF8(a)+1;c=Array(c);a=stringToUTF8Array(a,c,0,c.length);b&&(c.length=a);return c}
var FS_stdin_getChar=function(){if(!FS_stdin_getChar_buffer.length){var a=null;if(ENVIRONMENT_IS_NODE){a=Buffer.alloc(256);var b=0,c=process.stdin.fd;try{b=fs.readSync(c,a)}catch(d){if(d.toString().includes("EOF"))b=0;else throw d;}a=0<b?a.slice(0,b).toString("utf-8"):null}else"undefined"!=typeof window&&"function"==typeof window.prompt?(a=window.prompt("Input: "),null!==a&&(a+="\n")):"function"==typeof readline&&(a=readline(),null!==a&&(a+="\n"));if(!a)return null;FS_stdin_getChar_buffer=intArrayFromString(a,
!0)}return FS_stdin_getChar_buffer.shift()},TTY={ttys:[],init:function(){},shutdown:function(){},register:function(a,b){TTY.ttys[a]={input:[],output:[],ops:b};FS.registerDevice(a,TTY.stream_ops)},stream_ops:{open:function(a){var b=TTY.ttys[a.node.rdev];if(!b)throw new FS.ErrnoError(43);a.tty=b;a.seekable=!1},close:function(a){a.tty.ops.fsync(a.tty)},fsync:function(a){a.tty.ops.fsync(a.tty)},read:function(a,b,c,d,m){if(!a.tty||!a.tty.ops.get_char)throw new FS.ErrnoError(60);for(var l=m=0;l<d;l++){try{var k=
a.tty.ops.get_char(a.tty)}catch(n){throw new FS.ErrnoError(29);}if(void 0===k&&0===m)throw new FS.ErrnoError(6);if(null===k||void 0===k)break;m++;b[c+l]=k}m&&(a.node.timestamp=Date.now());return m},write:function(a,b,c,d,m){if(!a.tty||!a.tty.ops.put_char)throw new FS.ErrnoError(60);try{for(m=0;m<d;m++)a.tty.ops.put_char(a.tty,b[c+m])}catch(l){throw new FS.ErrnoError(29);}d&&(a.node.timestamp=Date.now());return m}},default_tty_ops:{get_char:function(a){return FS_stdin_getChar()},put_char:function(a,
b){null===b||10===b?(out(UTF8ArrayToString(a.output,0)),a.output=[]):0!=b&&a.output.push(b)},fsync:function(a){a.output&&0<a.output.length&&(out(UTF8ArrayToString(a.output,0)),a.output=[])},ioctl_tcgets:function(a){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets:function(a,b,c){return 0},ioctl_tiocgwinsz:function(a){return[24,80]}},default_tty1_ops:{put_char:function(a,b){null===b||10===b?(err(UTF8ArrayToString(a.output,
0)),a.output=[]):0!=b&&a.output.push(b)},fsync:function(a){a.output&&0<a.output.length&&(err(UTF8ArrayToString(a.output,0)),a.output=[])}}},zeroMemory=function(a,b){HEAPU8.fill(0,a,a+b);return a},alignMemory=function(a,b){assert(b,"alignment argument is required");return Math.ceil(a/b)*b},mmapAlloc=function(a){abort("internal error: mmapAlloc called but `emscripten_builtin_memalign` native symbol not exported")},MEMFS={ops_table:null,mount:function(a){return MEMFS.createNode(null,"/",16895,0)},createNode:function(a,
b,c,d){if(FS.isBlkdev(c)||FS.isFIFO(c))throw new FS.ErrnoError(63);MEMFS.ops_table||(MEMFS.ops_table={dir:{node:{getattr:MEMFS.node_ops.getattr,setattr:MEMFS.node_ops.setattr,lookup:MEMFS.node_ops.lookup,mknod:MEMFS.node_ops.mknod,rename:MEMFS.node_ops.rename,unlink:MEMFS.node_ops.unlink,rmdir:MEMFS.node_ops.rmdir,readdir:MEMFS.node_ops.readdir,symlink:MEMFS.node_ops.symlink},stream:{llseek:MEMFS.stream_ops.llseek}},file:{node:{getattr:MEMFS.node_ops.getattr,setattr:MEMFS.node_ops.setattr},stream:{llseek:MEMFS.stream_ops.llseek,
read:MEMFS.stream_ops.read,write:MEMFS.stream_ops.write,allocate:MEMFS.stream_ops.allocate,mmap:MEMFS.stream_ops.mmap,msync:MEMFS.stream_ops.msync}},link:{node:{getattr:MEMFS.node_ops.getattr,setattr:MEMFS.node_ops.setattr,readlink:MEMFS.node_ops.readlink},stream:{}},chrdev:{node:{getattr:MEMFS.node_ops.getattr,setattr:MEMFS.node_ops.setattr},stream:FS.chrdev_stream_ops}});c=FS.createNode(a,b,c,d);FS.isDir(c.mode)?(c.node_ops=MEMFS.ops_table.dir.node,c.stream_ops=MEMFS.ops_table.dir.stream,c.contents=
{}):FS.isFile(c.mode)?(c.node_ops=MEMFS.ops_table.file.node,c.stream_ops=MEMFS.ops_table.file.stream,c.usedBytes=0,c.contents=null):FS.isLink(c.mode)?(c.node_ops=MEMFS.ops_table.link.node,c.stream_ops=MEMFS.ops_table.link.stream):FS.isChrdev(c.mode)&&(c.node_ops=MEMFS.ops_table.chrdev.node,c.stream_ops=MEMFS.ops_table.chrdev.stream);c.timestamp=Date.now();a&&(a.contents[b]=c,a.timestamp=c.timestamp);return c},getFileDataAsTypedArray:function(a){return a.contents?a.contents.subarray?a.contents.subarray(0,
a.usedBytes):new Uint8Array(a.contents):new Uint8Array(0)},expandFileStorage:function(a,b){var c=a.contents?a.contents.length:0;c>=b||(b=Math.max(b,c*(1048576>c?2:1.125)>>>0),0!=c&&(b=Math.max(b,256)),c=a.contents,a.contents=new Uint8Array(b),0<a.usedBytes&&a.contents.set(c.subarray(0,a.usedBytes),0))},resizeFileStorage:function(a,b){if(a.usedBytes!=b)if(0==b)a.contents=null,a.usedBytes=0;else{var c=a.contents;a.contents=new Uint8Array(b);c&&a.contents.set(c.subarray(0,Math.min(b,a.usedBytes)));a.usedBytes=
b}},node_ops:{getattr:function(a){var b={};b.dev=FS.isChrdev(a.mode)?a.id:1;b.ino=a.id;b.mode=a.mode;b.nlink=1;b.uid=0;b.gid=0;b.rdev=a.rdev;FS.isDir(a.mode)?b.size=4096:FS.isFile(a.mode)?b.size=a.usedBytes:FS.isLink(a.mode)?b.size=a.link.length:b.size=0;b.atime=new Date(a.timestamp);b.mtime=new Date(a.timestamp);b.ctime=new Date(a.timestamp);b.blksize=4096;b.blocks=Math.ceil(b.size/b.blksize);return b},setattr:function(a,b){void 0!==b.mode&&(a.mode=b.mode);void 0!==b.timestamp&&(a.timestamp=b.timestamp);
void 0!==b.size&&MEMFS.resizeFileStorage(a,b.size)},lookup:function(a,b){throw FS.genericErrors[44];},mknod:function(a,b,c,d){return MEMFS.createNode(a,b,c,d)},rename:function(a,b,c){if(FS.isDir(a.mode)){try{var d=FS.lookupNode(b,c)}catch(l){}if(d)for(var m in d.contents)throw new FS.ErrnoError(55);}delete a.parent.contents[a.name];a.parent.timestamp=Date.now();a.name=c;b.contents[c]=a;b.timestamp=a.parent.timestamp;a.parent=b},unlink:function(a,b){delete a.contents[b];a.timestamp=Date.now()},rmdir:function(a,
b){var c=FS.lookupNode(a,b),d;for(d in c.contents)throw new FS.ErrnoError(55);delete a.contents[b];a.timestamp=Date.now()},readdir:function(a){var b=[".",".."],c;for(c in a.contents)a.contents.hasOwnProperty(c)&&b.push(c);return b},symlink:function(a,b,c){a=MEMFS.createNode(a,b,41471,0);a.link=c;return a},readlink:function(a){if(!FS.isLink(a.mode))throw new FS.ErrnoError(28);return a.link}},stream_ops:{read:function(a,b,c,d,m){var l=a.node.contents;if(m>=a.node.usedBytes)return 0;a=Math.min(a.node.usedBytes-
m,d);assert(0<=a);if(8<a&&l.subarray)b.set(l.subarray(m,m+a),c);else for(d=0;d<a;d++)b[c+d]=l[m+d];return a},write:function(a,b,c,d,m,l){assert(!(b instanceof ArrayBuffer));b.buffer===HEAP8.buffer&&(l=!1);if(!d)return 0;a=a.node;a.timestamp=Date.now();if(b.subarray&&(!a.contents||a.contents.subarray)){if(l)return assert(0===m,"canOwn must imply no weird position inside the file"),a.contents=b.subarray(c,c+d),a.usedBytes=d;if(0===a.usedBytes&&0===m)return a.contents=b.slice(c,c+d),a.usedBytes=d;if(m+
d<=a.usedBytes)return a.contents.set(b.subarray(c,c+d),m),d}MEMFS.expandFileStorage(a,m+d);if(a.contents.subarray&&b.subarray)a.contents.set(b.subarray(c,c+d),m);else for(l=0;l<d;l++)a.contents[m+l]=b[c+l];a.usedBytes=Math.max(a.usedBytes,m+d);return d},llseek:function(a,b,c){1===c?b+=a.position:2===c&&FS.isFile(a.node.mode)&&(b+=a.node.usedBytes);if(0>b)throw new FS.ErrnoError(28);return b},allocate:function(a,b,c){MEMFS.expandFileStorage(a.node,b+c);a.node.usedBytes=Math.max(a.node.usedBytes,b+
c)},mmap:function(a,b,c,d,m){if(!FS.isFile(a.node.mode))throw new FS.ErrnoError(43);a=a.node.contents;if(m&2||a.buffer!==HEAP8.buffer){if(0<c||c+b<a.length)a=a.subarray?a.subarray(c,c+b):Array.prototype.slice.call(a,c,c+b);c=!0;b=mmapAlloc(b);if(!b)throw new FS.ErrnoError(48);HEAP8.set(a,b)}else c=!1,b=a.byteOffset;return{ptr:b,allocated:c}},msync:function(a,b,c,d,m){MEMFS.stream_ops.write(a,b,0,d,c,!1);return 0}}},asyncLoad=function(a,b,c,d){var m=d?"":getUniqueRunDependency("al "+a);readAsync(a,
function(l){assert(l,'Loading data file "'+a+'" failed (no arrayBuffer).');b(new Uint8Array(l));m&&removeRunDependency(m)},function(l){if(c)c();else throw'Loading data file "'+a+'" failed.';});m&&addRunDependency(m)},FS_createDataFile=function(a,b,c,d,m,l){return FS.createDataFile(a,b,c,d,m,l)},preloadPlugins=Module.preloadPlugins||[],FS_handledByPreloadPlugin=function(a,b,c,d){"undefined"!=typeof Browser&&Browser.init();var m=!1;preloadPlugins.forEach(function(l){!m&&l.canHandle(b)&&(l.handle(a,
b,c,d),m=!0)});return m},FS_createPreloadedFile=function(a,b,c,d,m,l,k,n,p,q){function h(g){function t(r){q&&q();n||FS_createDataFile(a,b,r,d,m,p);l&&l();removeRunDependency(f)}FS_handledByPreloadPlugin(g,e,t,function(){k&&k();removeRunDependency(f)})||t(g)}var e=b?PATH_FS.resolve(PATH.join2(a,b)):a,f=getUniqueRunDependency("cp "+e);addRunDependency(f);"string"==typeof c?asyncLoad(c,function(g){return h(g)},k):h(c)},FS_modeStringToFlags=function(a){var b={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090}[a];
if("undefined"==typeof b)throw Error("Unknown file open mode: "+a);return b},FS_getMode=function(a,b){var c=0;a&&(c|=365);b&&(c|=146);return c},ERRNO_MESSAGES={0:"Success",1:"Arg list too long",2:"Permission denied",3:"Address already in use",4:"Address not available",5:"Address family not supported by protocol family",6:"No more processes",7:"Socket already connected",8:"Bad file number",9:"Trying to read unreadable message",10:"Mount device busy",11:"Operation canceled",12:"No children",13:"Connection aborted",
14:"Connection refused",15:"Connection reset by peer",16:"File locking deadlock error",17:"Destination address required",18:"Math arg out of domain of func",19:"Quota exceeded",20:"File exists",21:"Bad address",22:"File too large",23:"Host is unreachable",24:"Identifier removed",25:"Illegal byte sequence",26:"Connection already in progress",27:"Interrupted system call",28:"Invalid argument",29:"I/O error",30:"Socket is already connected",31:"Is a directory",32:"Too many symbolic links",33:"Too many open files",
34:"Too many links",35:"Message too long",36:"Multihop attempted",37:"File or path name too long",38:"Network interface is not configured",39:"Connection reset by network",40:"Network is unreachable",41:"Too many open files in system",42:"No buffer space available",43:"No such device",44:"No such file or directory",45:"Exec format error",46:"No record locks available",47:"The link has been severed",48:"Not enough core",49:"No message of desired type",50:"Protocol not available",51:"No space left on device",
52:"Function not implemented",53:"Socket is not connected",54:"Not a directory",55:"Directory not empty",56:"State not recoverable",57:"Socket operation on non-socket",59:"Not a typewriter",60:"No such device or address",61:"Value too large for defined data type",62:"Previous owner died",63:"Not super-user",64:"Broken pipe",65:"Protocol error",66:"Unknown protocol",67:"Protocol wrong type for socket",68:"Math result not representable",69:"Read only file system",70:"Illegal seek",71:"No such process",
72:"Stale file handle",73:"Connection timed out",74:"Text file busy",75:"Cross-device link",100:"Device not a stream",101:"Bad font file fmt",102:"Invalid slot",103:"Invalid request code",104:"No anode",105:"Block device required",106:"Channel number out of range",107:"Level 3 halted",108:"Level 3 reset",109:"Link number out of range",110:"Protocol driver not attached",111:"No CSI structure available",112:"Level 2 halted",113:"Invalid exchange",114:"Invalid request descriptor",115:"Exchange full",
116:"No data (for no delay io)",117:"Timer expired",118:"Out of streams resources",119:"Machine is not on the network",120:"Package not installed",121:"The object is remote",122:"Advertise error",123:"Srmount error",124:"Communication error on send",125:"Cross mount point (not really error)",126:"Given log. name not unique",127:"f.d. invalid for this operation",128:"Remote address changed",129:"Can   access a needed shared lib",130:"Accessing a corrupted shared lib",131:".lib section in a.out corrupted",
132:"Attempting to link in too many libs",133:"Attempting to exec a shared library",135:"Streams pipe error",136:"Too many users",137:"Socket type not supported",138:"Not supported",139:"Protocol family not supported",140:"Can't send after socket shutdown",141:"Too many references",142:"Host is down",148:"No medium (in tape drive)",156:"Level 2 not synchronized"},ERRNO_CODES={},FS={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,
ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:function(a,b){b=void 0===b?{}:b;a=PATH_FS.resolve(a);if(!a)return{path:"",node:null};b=Object.assign({follow_mount:!0,recurse_count:0},b);if(8<b.recurse_count)throw new FS.ErrnoError(32);a=a.split("/").filter(function(k){return!!k});for(var c=FS.root,d="/",m=0;m<a.length;m++){var l=m===a.length-1;if(l&&b.parent)break;c=FS.lookupNode(c,a[m]);d=PATH.join2(d,a[m]);FS.isMountpoint(c)&&(!l||l&&b.follow_mount)&&(c=c.mounted.root);
if(!l||b.follow)for(l=0;FS.isLink(c.mode);)if(c=FS.readlink(d),d=PATH_FS.resolve(PATH.dirname(d),c),c=FS.lookupPath(d,{recurse_count:b.recurse_count+1}).node,40<l++)throw new FS.ErrnoError(32);}return{path:d,node:c}},getPath:function(a){for(var b;;){if(FS.isRoot(a))return a=a.mount.mountpoint,b?"/"!==a[a.length-1]?a+"/"+b:a+b:a;b=b?a.name+"/"+b:a.name;a=a.parent}},hashName:function(a,b){for(var c=0,d=0;d<b.length;d++)c=(c<<5)-c+b.charCodeAt(d)|0;return(a+c>>>0)%FS.nameTable.length},hashAddNode:function(a){var b=
FS.hashName(a.parent.id,a.name);a.name_next=FS.nameTable[b];FS.nameTable[b]=a},hashRemoveNode:function(a){var b=FS.hashName(a.parent.id,a.name);if(FS.nameTable[b]===a)FS.nameTable[b]=a.name_next;else for(b=FS.nameTable[b];b;){if(b.name_next===a){b.name_next=a.name_next;break}b=b.name_next}},lookupNode:function(a,b){var c=FS.mayLookup(a);if(c)throw new FS.ErrnoError(c,a);c=FS.hashName(a.id,b);for(c=FS.nameTable[c];c;c=c.name_next){var d=c.name;if(c.parent.id===a.id&&d===b)return c}return FS.lookup(a,
b)},createNode:function(a,b,c,d){assert("object"==typeof a);a=new FS.FSNode(a,b,c,d);FS.hashAddNode(a);return a},destroyNode:function(a){FS.hashRemoveNode(a)},isRoot:function(a){return a===a.parent},isMountpoint:function(a){return!!a.mounted},isFile:function(a){return 32768===(a&61440)},isDir:function(a){return 16384===(a&61440)},isLink:function(a){return 40960===(a&61440)},isChrdev:function(a){return 8192===(a&61440)},isBlkdev:function(a){return 24576===(a&61440)},isFIFO:function(a){return 4096===
(a&61440)},isSocket:function(a){return 49152===(a&49152)},flagsToPermissionString:function(a){var b=["r","w","rw"][a&3];a&512&&(b+="w");return b},nodePermissions:function(a,b){if(FS.ignorePermissions)return 0;if(!b.includes("r")||a.mode&292){if(b.includes("w")&&!(a.mode&146)||b.includes("x")&&!(a.mode&73))return 2}else return 2;return 0},mayLookup:function(a){var b=FS.nodePermissions(a,"x");return b?b:a.node_ops.lookup?0:2},mayCreate:function(a,b){try{return FS.lookupNode(a,b),20}catch(c){}return FS.nodePermissions(a,
"wx")},mayDelete:function(a,b,c){try{var d=FS.lookupNode(a,b)}catch(m){return m.errno}if(a=FS.nodePermissions(a,"wx"))return a;if(c){if(!FS.isDir(d.mode))return 54;if(FS.isRoot(d)||FS.getPath(d)===FS.cwd())return 10}else if(FS.isDir(d.mode))return 31;return 0},mayOpen:function(a,b){return a?FS.isLink(a.mode)?32:FS.isDir(a.mode)&&("r"!==FS.flagsToPermissionString(b)||b&512)?31:FS.nodePermissions(a,FS.flagsToPermissionString(b)):44},MAX_OPEN_FDS:4096,nextfd:function(){for(var a=0;a<=FS.MAX_OPEN_FDS;a++)if(!FS.streams[a])return a;
throw new FS.ErrnoError(33);},getStreamChecked:function(a){a=FS.getStream(a);if(!a)throw new FS.ErrnoError(8);return a},getStream:function(a){return FS.streams[a]},createStream:function(a,b){b=void 0===b?-1:b;FS.FSStream||(FS.FSStream=function(){this.shared={}},FS.FSStream.prototype={},Object.defineProperties(FS.FSStream.prototype,{object:{get:function(){return this.node},set:function(c){this.node=c}},isRead:{get:function(){return 1!==(this.flags&2097155)}},isWrite:{get:function(){return 0!==(this.flags&
2097155)}},isAppend:{get:function(){return this.flags&1024}},flags:{get:function(){return this.shared.flags},set:function(c){this.shared.flags=c}},position:{get:function(){return this.shared.position},set:function(c){this.shared.position=c}}}));a=Object.assign(new FS.FSStream,a);-1==b&&(b=FS.nextfd());a.fd=b;return FS.streams[b]=a},closeStream:function(a){FS.streams[a]=null},chrdev_stream_ops:{open:function(a){var b=FS.getDevice(a.node.rdev);a.stream_ops=b.stream_ops;a.stream_ops.open&&a.stream_ops.open(a)},
llseek:function(){throw new FS.ErrnoError(70);}},major:function(a){return a>>8},minor:function(a){return a&255},makedev:function(a,b){return a<<8|b},registerDevice:function(a,b){FS.devices[a]={stream_ops:b}},getDevice:function(a){return FS.devices[a]},getMounts:function(a){var b=[];for(a=[a];a.length;){var c=a.pop();b.push(c);a.push.apply(a,c.mounts)}return b},syncfs:function(a,b){function c(k){assert(0<FS.syncFSRequests);FS.syncFSRequests--;return b(k)}function d(k){if(k){if(!d.errored)return d.errored=
!0,c(k)}else++l>=m.length&&c(null)}"function"==typeof a&&(b=a,a=!1);FS.syncFSRequests++;1<FS.syncFSRequests&&err("warning: "+FS.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var m=FS.getMounts(FS.root.mount),l=0;m.forEach(function(k){if(!k.type.syncfs)return d(null);k.type.syncfs(k,a,d)})},mount:function(a,b,c){if("string"==typeof a)throw a;var d="/"===c,m=!c;if(d&&FS.root)throw new FS.ErrnoError(10);if(!d&&!m){var l=FS.lookupPath(c,{follow_mount:!1});c=
l.path;l=l.node;if(FS.isMountpoint(l))throw new FS.ErrnoError(10);if(!FS.isDir(l.mode))throw new FS.ErrnoError(54);}b={type:a,opts:b,mountpoint:c,mounts:[]};a=a.mount(b);a.mount=b;b.root=a;d?FS.root=a:l&&(l.mounted=b,l.mount&&l.mount.mounts.push(b));return a},unmount:function(a){a=FS.lookupPath(a,{follow_mount:!1});if(!FS.isMountpoint(a.node))throw new FS.ErrnoError(28);a=a.node;var b=a.mounted,c=FS.getMounts(b);Object.keys(FS.nameTable).forEach(function(d){for(d=FS.nameTable[d];d;){var m=d.name_next;
c.includes(d.mount)&&FS.destroyNode(d);d=m}});a.mounted=null;b=a.mount.mounts.indexOf(b);assert(-1!==b);a.mount.mounts.splice(b,1)},lookup:function(a,b){return a.node_ops.lookup(a,b)},mknod:function(a,b,c){var d=FS.lookupPath(a,{parent:!0}).node;a=PATH.basename(a);if(!a||"."===a||".."===a)throw new FS.ErrnoError(28);var m=FS.mayCreate(d,a);if(m)throw new FS.ErrnoError(m);if(!d.node_ops.mknod)throw new FS.ErrnoError(63);return d.node_ops.mknod(d,a,b,c)},create:function(a,b){return FS.mknod(a,(void 0!==
b?b:438)&4095|32768,0)},mkdir:function(a,b){return FS.mknod(a,(void 0!==b?b:511)&1023|16384,0)},mkdirTree:function(a,b){a=a.split("/");for(var c="",d=0;d<a.length;++d)if(a[d]){c+="/"+a[d];try{FS.mkdir(c,b)}catch(m){if(20!=m.errno)throw m;}}},mkdev:function(a,b,c){"undefined"==typeof c&&(c=b,b=438);return FS.mknod(a,b|8192,c)},symlink:function(a,b){if(!PATH_FS.resolve(a))throw new FS.ErrnoError(44);var c=FS.lookupPath(b,{parent:!0}).node;if(!c)throw new FS.ErrnoError(44);b=PATH.basename(b);var d=FS.mayCreate(c,
b);if(d)throw new FS.ErrnoError(d);if(!c.node_ops.symlink)throw new FS.ErrnoError(63);return c.node_ops.symlink(c,b,a)},rename:function(a,b){var c=PATH.dirname(a),d=PATH.dirname(b),m=PATH.basename(a),l=PATH.basename(b);var k=FS.lookupPath(a,{parent:!0});var n=k.node;k=FS.lookupPath(b,{parent:!0});k=k.node;if(!n||!k)throw new FS.ErrnoError(44);if(n.mount!==k.mount)throw new FS.ErrnoError(75);var p=FS.lookupNode(n,m);a=PATH_FS.relative(a,d);if("."!==a.charAt(0))throw new FS.ErrnoError(28);a=PATH_FS.relative(b,
c);if("."!==a.charAt(0))throw new FS.ErrnoError(55);try{var q=FS.lookupNode(k,l)}catch(h){}if(p!==q){b=FS.isDir(p.mode);if(m=FS.mayDelete(n,m,b))throw new FS.ErrnoError(m);if(m=q?FS.mayDelete(k,l,b):FS.mayCreate(k,l))throw new FS.ErrnoError(m);if(!n.node_ops.rename)throw new FS.ErrnoError(63);if(FS.isMountpoint(p)||q&&FS.isMountpoint(q))throw new FS.ErrnoError(10);if(k!==n&&(m=FS.nodePermissions(n,"w")))throw new FS.ErrnoError(m);FS.hashRemoveNode(p);try{n.node_ops.rename(p,k,l)}catch(h){throw h;
}finally{FS.hashAddNode(p)}}},rmdir:function(a){var b=FS.lookupPath(a,{parent:!0}).node;a=PATH.basename(a);var c=FS.lookupNode(b,a),d=FS.mayDelete(b,a,!0);if(d)throw new FS.ErrnoError(d);if(!b.node_ops.rmdir)throw new FS.ErrnoError(63);if(FS.isMountpoint(c))throw new FS.ErrnoError(10);b.node_ops.rmdir(b,a);FS.destroyNode(c)},readdir:function(a){a=FS.lookupPath(a,{follow:!0}).node;if(!a.node_ops.readdir)throw new FS.ErrnoError(54);return a.node_ops.readdir(a)},unlink:function(a){var b=FS.lookupPath(a,
{parent:!0}).node;if(!b)throw new FS.ErrnoError(44);a=PATH.basename(a);var c=FS.lookupNode(b,a),d=FS.mayDelete(b,a,!1);if(d)throw new FS.ErrnoError(d);if(!b.node_ops.unlink)throw new FS.ErrnoError(63);if(FS.isMountpoint(c))throw new FS.ErrnoError(10);b.node_ops.unlink(b,a);FS.destroyNode(c)},readlink:function(a){a=FS.lookupPath(a).node;if(!a)throw new FS.ErrnoError(44);if(!a.node_ops.readlink)throw new FS.ErrnoError(28);return PATH_FS.resolve(FS.getPath(a.parent),a.node_ops.readlink(a))},stat:function(a,
b){a=FS.lookupPath(a,{follow:!b}).node;if(!a)throw new FS.ErrnoError(44);if(!a.node_ops.getattr)throw new FS.ErrnoError(63);return a.node_ops.getattr(a)},lstat:function(a){return FS.stat(a,!0)},chmod:function(a,b,c){a="string"==typeof a?FS.lookupPath(a,{follow:!c}).node:a;if(!a.node_ops.setattr)throw new FS.ErrnoError(63);a.node_ops.setattr(a,{mode:b&4095|a.mode&-4096,timestamp:Date.now()})},lchmod:function(a,b){FS.chmod(a,b,!0)},fchmod:function(a,b){a=FS.getStreamChecked(a);FS.chmod(a.node,b)},chown:function(a,
b,c,d){a="string"==typeof a?FS.lookupPath(a,{follow:!d}).node:a;if(!a.node_ops.setattr)throw new FS.ErrnoError(63);a.node_ops.setattr(a,{timestamp:Date.now()})},lchown:function(a,b,c){FS.chown(a,b,c,!0)},fchown:function(a,b,c){a=FS.getStreamChecked(a);FS.chown(a.node,b,c)},truncate:function(a,b){if(0>b)throw new FS.ErrnoError(28);a="string"==typeof a?FS.lookupPath(a,{follow:!0}).node:a;if(!a.node_ops.setattr)throw new FS.ErrnoError(63);if(FS.isDir(a.mode))throw new FS.ErrnoError(31);if(!FS.isFile(a.mode))throw new FS.ErrnoError(28);
var c=FS.nodePermissions(a,"w");if(c)throw new FS.ErrnoError(c);a.node_ops.setattr(a,{size:b,timestamp:Date.now()})},ftruncate:function(a,b){a=FS.getStreamChecked(a);if(0===(a.flags&2097155))throw new FS.ErrnoError(28);FS.truncate(a.node,b)},utime:function(a,b,c){a=FS.lookupPath(a,{follow:!0}).node;a.node_ops.setattr(a,{timestamp:Math.max(b,c)})},open:function(a,b,c){if(""===a)throw new FS.ErrnoError(44);b="string"==typeof b?FS_modeStringToFlags(b):b;c=b&64?("undefined"==typeof c?438:c)&4095|32768:
0;if("object"==typeof a)var d=a;else{a=PATH.normalize(a);try{d=FS.lookupPath(a,{follow:!(b&131072)}).node}catch(l){}}var m=!1;if(b&64)if(d){if(b&128)throw new FS.ErrnoError(20);}else d=FS.mknod(a,c,0),m=!0;if(!d)throw new FS.ErrnoError(44);FS.isChrdev(d.mode)&&(b&=-513);if(b&65536&&!FS.isDir(d.mode))throw new FS.ErrnoError(54);if(!m&&(c=FS.mayOpen(d,b)))throw new FS.ErrnoError(c);b&512&&!m&&FS.truncate(d,0);b&=-131713;d=FS.createStream({node:d,path:FS.getPath(d),flags:b,seekable:!0,position:0,stream_ops:d.stream_ops,
ungotten:[],error:!1});d.stream_ops.open&&d.stream_ops.open(d);!Module.logReadFiles||b&1||(FS.readFiles||(FS.readFiles={}),a in FS.readFiles||(FS.readFiles[a]=1));return d},close:function(a){if(FS.isClosed(a))throw new FS.ErrnoError(8);a.getdents&&(a.getdents=null);try{a.stream_ops.close&&a.stream_ops.close(a)}catch(b){throw b;}finally{FS.closeStream(a.fd)}a.fd=null},isClosed:function(a){return null===a.fd},llseek:function(a,b,c){if(FS.isClosed(a))throw new FS.ErrnoError(8);if(!a.seekable||!a.stream_ops.llseek)throw new FS.ErrnoError(70);
if(0!=c&&1!=c&&2!=c)throw new FS.ErrnoError(28);a.position=a.stream_ops.llseek(a,b,c);a.ungotten=[];return a.position},read:function(a,b,c,d,m){assert(0<=c);if(0>d||0>m)throw new FS.ErrnoError(28);if(FS.isClosed(a))throw new FS.ErrnoError(8);if(1===(a.flags&2097155))throw new FS.ErrnoError(8);if(FS.isDir(a.node.mode))throw new FS.ErrnoError(31);if(!a.stream_ops.read)throw new FS.ErrnoError(28);var l="undefined"!=typeof m;if(!l)m=a.position;else if(!a.seekable)throw new FS.ErrnoError(70);b=a.stream_ops.read(a,
b,c,d,m);l||(a.position+=b);return b},write:function(a,b,c,d,m,l){assert(0<=c);if(0>d||0>m)throw new FS.ErrnoError(28);if(FS.isClosed(a))throw new FS.ErrnoError(8);if(0===(a.flags&2097155))throw new FS.ErrnoError(8);if(FS.isDir(a.node.mode))throw new FS.ErrnoError(31);if(!a.stream_ops.write)throw new FS.ErrnoError(28);a.seekable&&a.flags&1024&&FS.llseek(a,0,2);var k="undefined"!=typeof m;if(!k)m=a.position;else if(!a.seekable)throw new FS.ErrnoError(70);b=a.stream_ops.write(a,b,c,d,m,l);k||(a.position+=
b);return b},allocate:function(a,b,c){if(FS.isClosed(a))throw new FS.ErrnoError(8);if(0>b||0>=c)throw new FS.ErrnoError(28);if(0===(a.flags&2097155))throw new FS.ErrnoError(8);if(!FS.isFile(a.node.mode)&&!FS.isDir(a.node.mode))throw new FS.ErrnoError(43);if(!a.stream_ops.allocate)throw new FS.ErrnoError(138);a.stream_ops.allocate(a,b,c)},mmap:function(a,b,c,d,m){if(0!==(d&2)&&0===(m&2)&&2!==(a.flags&2097155))throw new FS.ErrnoError(2);if(1===(a.flags&2097155))throw new FS.ErrnoError(2);if(!a.stream_ops.mmap)throw new FS.ErrnoError(43);
return a.stream_ops.mmap(a,b,c,d,m)},msync:function(a,b,c,d,m){assert(0<=c);return a.stream_ops.msync?a.stream_ops.msync(a,b,c,d,m):0},munmap:function(a){return 0},ioctl:function(a,b,c){if(!a.stream_ops.ioctl)throw new FS.ErrnoError(59);return a.stream_ops.ioctl(a,b,c)},readFile:function(a,b){b=void 0===b?{}:b;b.flags=b.flags||0;b.encoding=b.encoding||"binary";if("utf8"!==b.encoding&&"binary"!==b.encoding)throw Error('Invalid encoding type "'+b.encoding+'"');var c,d=FS.open(a,b.flags);a=FS.stat(a).size;
var m=new Uint8Array(a);FS.read(d,m,0,a,0);"utf8"===b.encoding?c=UTF8ArrayToString(m,0):"binary"===b.encoding&&(c=m);FS.close(d);return c},writeFile:function(a,b,c){c=void 0===c?{}:c;c.flags=c.flags||577;a=FS.open(a,c.flags,c.mode);if("string"==typeof b){var d=new Uint8Array(lengthBytesUTF8(b)+1);b=stringToUTF8Array(b,d,0,d.length);FS.write(a,d,0,b,void 0,c.canOwn)}else if(ArrayBuffer.isView(b))FS.write(a,b,0,b.byteLength,void 0,c.canOwn);else throw Error("Unsupported data type");FS.close(a)},cwd:function(){return FS.currentPath},
chdir:function(a){a=FS.lookupPath(a,{follow:!0});if(null===a.node)throw new FS.ErrnoError(44);if(!FS.isDir(a.node.mode))throw new FS.ErrnoError(54);var b=FS.nodePermissions(a.node,"x");if(b)throw new FS.ErrnoError(b);FS.currentPath=a.path},createDefaultDirectories:function(){FS.mkdir("/tmp");FS.mkdir("/home");FS.mkdir("/home/web_user")},createDefaultDevices:function(){FS.mkdir("/dev");FS.registerDevice(FS.makedev(1,3),{read:function(){return 0},write:function(d,m,l,k,n){return k}});FS.mkdev("/dev/null",
FS.makedev(1,3));TTY.register(FS.makedev(5,0),TTY.default_tty_ops);TTY.register(FS.makedev(6,0),TTY.default_tty1_ops);FS.mkdev("/dev/tty",FS.makedev(5,0));FS.mkdev("/dev/tty1",FS.makedev(6,0));var a=new Uint8Array(1024),b=0,c=function(){0===b&&(b=randomFill(a).byteLength);return a[--b]};FS.createDevice("/dev","random",c);FS.createDevice("/dev","urandom",c);FS.mkdir("/dev/shm");FS.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){FS.mkdir("/proc");var a=FS.mkdir("/proc/self");FS.mkdir("/proc/self/fd");
FS.mount({mount:function(){var b=FS.createNode(a,"fd",16895,73);b.node_ops={lookup:function(c,d){var m=FS.getStreamChecked(+d);c={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return m.path}}};return c.parent=c}};return b}},{},"/proc/self/fd")},createStandardStreams:function(){Module.stdin?FS.createDevice("/dev","stdin",Module.stdin):FS.symlink("/dev/tty","/dev/stdin");Module.stdout?FS.createDevice("/dev","stdout",null,Module.stdout):FS.symlink("/dev/tty","/dev/stdout");Module.stderr?
FS.createDevice("/dev","stderr",null,Module.stderr):FS.symlink("/dev/tty1","/dev/stderr");var a=FS.open("/dev/stdin",0),b=FS.open("/dev/stdout",1),c=FS.open("/dev/stderr",1);assert(0===a.fd,"invalid handle for stdin ("+a.fd+")");assert(1===b.fd,"invalid handle for stdout ("+b.fd+")");assert(2===c.fd,"invalid handle for stderr ("+c.fd+")")},ensureErrnoError:function(){FS.ErrnoError||(FS.ErrnoError=function(a,b){this.name="ErrnoError";this.node=b;this.setErrno=function(c){this.errno=c;for(var d in ERRNO_CODES)if(ERRNO_CODES[d]===
c){this.code=d;break}};this.setErrno(a);this.message=ERRNO_MESSAGES[a];this.stack&&(Object.defineProperty(this,"stack",{value:Error().stack,writable:!0}),this.stack=demangleAll(this.stack))},FS.ErrnoError.prototype=Error(),FS.ErrnoError.prototype.constructor=FS.ErrnoError,[44].forEach(function(a){FS.genericErrors[a]=new FS.ErrnoError(a);FS.genericErrors[a].stack="<generic error, no stack>"}))},staticInit:function(){FS.ensureErrnoError();FS.nameTable=Array(4096);FS.mount(MEMFS,{},"/");FS.createDefaultDirectories();
FS.createDefaultDevices();FS.createSpecialDirectories();FS.filesystems={MEMFS:MEMFS}},init:function(a,b,c){assert(!FS.init.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)");FS.init.initialized=!0;FS.ensureErrnoError();Module.stdin=a||Module.stdin;Module.stdout=b||Module.stdout;Module.stderr=c||Module.stderr;FS.createStandardStreams()},quit:function(){FS.init.initialized=
!1;_fflush(0);for(var a=0;a<FS.streams.length;a++){var b=FS.streams[a];b&&FS.close(b)}},findObject:function(a,b){a=FS.analyzePath(a,b);return a.exists?a.object:null},analyzePath:function(a,b){try{var c=FS.lookupPath(a,{follow:!b});a=c.path}catch(m){}var d={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{c=FS.lookupPath(a,{parent:!0}),d.parentExists=!0,d.parentPath=c.path,d.parentObject=c.node,d.name=PATH.basename(a),c=FS.lookupPath(a,
{follow:!b}),d.exists=!0,d.path=c.path,d.object=c.node,d.name=c.node.name,d.isRoot="/"===c.path}catch(m){d.error=m.errno}return d},createPath:function(a,b,c,d){a="string"==typeof a?a:FS.getPath(a);for(b=b.split("/").reverse();b.length;)if(c=b.pop()){var m=PATH.join2(a,c);try{FS.mkdir(m)}catch(l){}a=m}return m},createFile:function(a,b,c,d,m){a=PATH.join2("string"==typeof a?a:FS.getPath(a),b);d=FS_getMode(d,m);return FS.create(a,d)},createDataFile:function(a,b,c,d,m,l){var k=b;a&&(a="string"==typeof a?
a:FS.getPath(a),k=b?PATH.join2(a,b):a);a=FS_getMode(d,m);k=FS.create(k,a);if(c){if("string"==typeof c){b=Array(c.length);d=0;for(m=c.length;d<m;++d)b[d]=c.charCodeAt(d);c=b}FS.chmod(k,a|146);b=FS.open(k,577);FS.write(b,c,0,c.length,0,l);FS.close(b);FS.chmod(k,a)}return k},createDevice:function(a,b,c,d){a=PATH.join2("string"==typeof a?a:FS.getPath(a),b);b=FS_getMode(!!c,!!d);FS.createDevice.major||(FS.createDevice.major=64);var m=FS.makedev(FS.createDevice.major++,0);FS.registerDevice(m,{open:function(l){l.seekable=
!1},close:function(l){d&&d.buffer&&d.buffer.length&&d(10)},read:function(l,k,n,p,q){for(var h=q=0;h<p;h++){try{var e=c()}catch(f){throw new FS.ErrnoError(29);}if(void 0===e&&0===q)throw new FS.ErrnoError(6);if(null===e||void 0===e)break;q++;k[n+h]=e}q&&(l.node.timestamp=Date.now());return q},write:function(l,k,n,p,q){for(q=0;q<p;q++)try{d(k[n+q])}catch(h){throw new FS.ErrnoError(29);}p&&(l.node.timestamp=Date.now());return q}});return FS.mkdev(a,b,m)},forceLoadFile:function(a){if(a.isDevice||a.isFolder||
a.link||a.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(read_)try{a.contents=intArrayFromString(read_(a.url),!0),a.usedBytes=a.contents.length}catch(b){throw new FS.ErrnoError(29);}else throw Error("Cannot load without read() or XMLHttpRequest.");},createLazyFile:function(a,b,c,d,
m){function l(){this.lengthKnown=!1;this.chunks=[]}function k(h,e,f,g,t){h=h.node.contents;if(t>=h.length)return 0;g=Math.min(h.length-t,g);assert(0<=g);if(h.slice)for(var r=0;r<g;r++)e[f+r]=h[t+r];else for(r=0;r<g;r++)e[f+r]=h.get(t+r);return g}l.prototype.get=function(h){if(!(h>this.length-1||0>h)){var e=h%this.chunkSize;return this.getter(h/this.chunkSize|0)[e]}};l.prototype.setDataGetter=function(h){this.getter=h};l.prototype.cacheLength=function(){var h=new XMLHttpRequest;h.open("HEAD",c,!1);
h.send(null);if(!(200<=h.status&&300>h.status||304===h.status))throw Error("Couldn't load "+c+". Status: "+h.status);var e=Number(h.getResponseHeader("Content-length")),f,g=(f=h.getResponseHeader("Accept-Ranges"))&&"bytes"===f;h=(f=h.getResponseHeader("Content-Encoding"))&&"gzip"===f;var t=1048576;g||(t=e);var r=this;r.setDataGetter(function(u){var v=u*t,w=(u+1)*t-1;w=Math.min(w,e-1);if("undefined"==typeof r.chunks[u]){var x=r.chunks;if(v>w)throw Error("invalid range ("+v+", "+w+") or no bytes requested!");
if(w>e-1)throw Error("only "+e+" bytes available! programmer error!");var y=new XMLHttpRequest;y.open("GET",c,!1);e!==t&&y.setRequestHeader("Range","bytes="+v+"-"+w);y.responseType="arraybuffer";y.overrideMimeType&&y.overrideMimeType("text/plain; charset=x-user-defined");y.send(null);if(!(200<=y.status&&300>y.status||304===y.status))throw Error("Couldn't load "+c+". Status: "+y.status);v=void 0!==y.response?new Uint8Array(y.response||[]):intArrayFromString(y.responseText||"",!0);x[u]=v}if("undefined"==
typeof r.chunks[u])throw Error("doXHR failed!");return r.chunks[u]});if(h||!e)t=e=1,t=e=this.getter(0).length,out("LazyFiles on gzip forces download of the whole file when length is accessed");this._length=e;this._chunkSize=t;this.lengthKnown=!0};if("undefined"!=typeof XMLHttpRequest){if(!ENVIRONMENT_IS_WORKER)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var n=new l;Object.defineProperties(n,{length:{get:function(){this.lengthKnown||
this.cacheLength();return this._length}},chunkSize:{get:function(){this.lengthKnown||this.cacheLength();return this._chunkSize}}});n={isDevice:!1,contents:n}}else n={isDevice:!1,url:c};var p=FS.createFile(a,b,n,d,m);n.contents?p.contents=n.contents:n.url&&(p.contents=null,p.url=n.url);Object.defineProperties(p,{usedBytes:{get:function(){return this.contents.length}}});var q={};Object.keys(p.stream_ops).forEach(function(h){var e=p.stream_ops[h];q[h]=function(){FS.forceLoadFile(p);return e.apply(null,
arguments)}});q.read=function(h,e,f,g,t){FS.forceLoadFile(p);return k(h,e,f,g,t)};q.mmap=function(h,e,f,g,t){FS.forceLoadFile(p);g=mmapAlloc(e);if(!g)throw new FS.ErrnoError(48);k(h,HEAP8,g,e,f);return{ptr:g,allocated:!0}};p.stream_ops=q;return p},absolutePath:function(){abort("FS.absolutePath has been removed; use PATH_FS.resolve instead")},createFolder:function(){abort("FS.createFolder has been removed; use FS.mkdir instead")},createLink:function(){abort("FS.createLink has been removed; use FS.symlink instead")},
joinPath:function(){abort("FS.joinPath has been removed; use PATH.join instead")},mmapAlloc:function(){abort("FS.mmapAlloc has been replaced by the top level function mmapAlloc")},standardizePath:function(){abort("FS.standardizePath has been removed; use PATH.normalize instead")}},SYSCALLS={DEFAULT_POLLMASK:5,calculateAt:function(a,b,c){if(PATH.isAbs(b))return b;a=-100===a?FS.cwd():SYSCALLS.getStreamFromFD(a).path;if(0==b.length){if(!c)throw new FS.ErrnoError(44);return a}return PATH.join2(a,b)},
doStat:function(a,b,c){try{var d=a(b)}catch(l){if(l&&l.node&&PATH.normalize(b)!==PATH.normalize(FS.getPath(l.node)))return-54;throw l;}HEAP32[c>>2]=d.dev;HEAP32[c+4>>2]=d.mode;HEAPU32[c+8>>2]=d.nlink;HEAP32[c+12>>2]=d.uid;HEAP32[c+16>>2]=d.gid;HEAP32[c+20>>2]=d.rdev;tempI64=[d.size>>>0,(tempDouble=d.size,1<=+Math.abs(tempDouble)?0<tempDouble?+Math.floor(tempDouble/4294967296)>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)];HEAP32[c+24>>2]=tempI64[0];HEAP32[c+28>>2]=tempI64[1];
HEAP32[c+32>>2]=4096;HEAP32[c+36>>2]=d.blocks;a=d.atime.getTime();b=d.mtime.getTime();var m=d.ctime.getTime();tempI64=[Math.floor(a/1E3)>>>0,(tempDouble=Math.floor(a/1E3),1<=+Math.abs(tempDouble)?0<tempDouble?+Math.floor(tempDouble/4294967296)>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)];HEAP32[c+40>>2]=tempI64[0];HEAP32[c+44>>2]=tempI64[1];HEAPU32[c+48>>2]=a%1E3*1E3;tempI64=[Math.floor(b/1E3)>>>0,(tempDouble=Math.floor(b/1E3),1<=+Math.abs(tempDouble)?0<tempDouble?+Math.floor(tempDouble/
4294967296)>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)];HEAP32[c+56>>2]=tempI64[0];HEAP32[c+60>>2]=tempI64[1];HEAPU32[c+64>>2]=b%1E3*1E3;tempI64=[Math.floor(m/1E3)>>>0,(tempDouble=Math.floor(m/1E3),1<=+Math.abs(tempDouble)?0<tempDouble?+Math.floor(tempDouble/4294967296)>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)];HEAP32[c+72>>2]=tempI64[0];HEAP32[c+76>>2]=tempI64[1];HEAPU32[c+80>>2]=m%1E3*1E3;tempI64=[d.ino>>>0,(tempDouble=d.ino,1<=+Math.abs(tempDouble)?
0<tempDouble?+Math.floor(tempDouble/4294967296)>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)];HEAP32[c+88>>2]=tempI64[0];HEAP32[c+92>>2]=tempI64[1];return 0},doMsync:function(a,b,c,d,m){if(!FS.isFile(b.node.mode))throw new FS.ErrnoError(43);if(d&2)return 0;a=HEAPU8.slice(a,a+c);FS.msync(b,a,m,c,d)},varargs:void 0,get:function(){assert(void 0!=SYSCALLS.varargs);var a=HEAP32[+SYSCALLS.varargs>>2];SYSCALLS.varargs+=4;return a},getp:function(){return SYSCALLS.get()},getStr:function(a){return UTF8ToString(a)},
getStreamFromFD:function(a){return FS.getStreamChecked(a)}};
function ___syscall__newselect(a,b,c,d,m){try{assert(64>=a,"nfds must be less than or equal to 64");for(var l=0,k=b?HEAP32[b>>2]:0,n=b?HEAP32[b+4>>2]:0,p=c?HEAP32[c>>2]:0,q=c?HEAP32[c+4>>2]:0,h=d?HEAP32[d>>2]:0,e=d?HEAP32[d+4>>2]:0,f=0,g=0,t=0,r=0,u=0,v=0,w=(b?HEAP32[b>>2]:0)|(c?HEAP32[c>>2]:0)|(d?HEAP32[d>>2]:0),x=(b?HEAP32[b+4>>2]:0)|(c?HEAP32[c+4>>2]:0)|(d?HEAP32[d+4>>2]:0),y=0;y<a;y++){var z=1<<y%32;if(32>y?w&z:x&z){var B=SYSCALLS.getStreamFromFD(y),A=SYSCALLS.DEFAULT_POLLMASK;if(B.stream_ops.poll){var D=
-1;m&&(D=1E3*((b?HEAP32[m>>2]:0)+(b?HEAP32[m+8>>2]:0)/1E6));A=B.stream_ops.poll(B,D)}A&1&&(32>y?k&z:n&z)&&(32>y?f|=z:g|=z,l++);A&4&&(32>y?p&z:q&z)&&(32>y?t|=z:r|=z,l++);A&2&&(32>y?h&z:e&z)&&(32>y?u|=z:v|=z,l++)}}b&&(HEAP32[b>>2]=f,HEAP32[b+4>>2]=g);c&&(HEAP32[c>>2]=t,HEAP32[c+4>>2]=r);d&&(HEAP32[d>>2]=u,HEAP32[d+4>>2]=v);return l}catch(C){if("undefined"==typeof FS||"ErrnoError"!==C.name)throw C;return-C.errno}}
var SOCKFS={mount:function(a){Module.websocket=Module.websocket&&"object"===typeof Module.websocket?Module.websocket:{};Module.websocket._callbacks={};Module.websocket.on=function(b,c){"function"===typeof c&&(this._callbacks[b]=c);return this};Module.websocket.emit=function(b,c){"function"===typeof this._callbacks[b]&&this._callbacks[b].call(this,c)};return FS.createNode(null,"/",16895,0)},createSocket:function(a,b,c){b&=-526337;if(1==b&&c&&6!=c)throw new FS.ErrnoError(66);a={family:a,type:b,protocol:c,
server:null,error:null,peers:{},pending:[],recv_queue:[],sock_ops:SOCKFS.websocket_sock_ops};b=SOCKFS.nextname();c=FS.createNode(SOCKFS.root,b,49152,0);c.sock=a;b=FS.createStream({path:b,node:c,flags:2,seekable:!1,stream_ops:SOCKFS.stream_ops});a.stream=b;return a},getSocket:function(a){return(a=FS.getStream(a))&&FS.isSocket(a.node.mode)?a.node.sock:null},stream_ops:{poll:function(a){a=a.node.sock;return a.sock_ops.poll(a)},ioctl:function(a,b,c){a=a.node.sock;return a.sock_ops.ioctl(a,b,c)},read:function(a,
b,c,d,m){a=a.node.sock;d=a.sock_ops.recvmsg(a,d);if(!d)return 0;b.set(d.buffer,c);return d.buffer.length},write:function(a,b,c,d,m){a=a.node.sock;return a.sock_ops.sendmsg(a,b,c,d)},close:function(a){a=a.node.sock;a.sock_ops.close(a)}},nextname:function(){SOCKFS.nextname.current||(SOCKFS.nextname.current=0);return"socket["+SOCKFS.nextname.current++ +"]"},websocket_sock_ops:{createPeer:function(a,b,c){if("object"==typeof b){var d=b;c=b=null}if(d)if(d._socket)b=d._socket.remoteAddress,c=d._socket.remotePort;
else{c=/ws[s]?:\/\/([^:]+):(\d+)/.exec(d.url);if(!c)throw Error("WebSocket URL must be in the format ws(s)://address:port");b=c[1];c=parseInt(c[2],10)}else try{var m=Module.websocket&&"object"===typeof Module.websocket,l="ws:#".replace("#","//");m&&"string"===typeof Module.websocket.url&&(l=Module.websocket.url);if("ws://"===l||"wss://"===l){var k=b.split("/");l=l+k[0]+":"+c+"/"+k.slice(1).join("/")}k="binary";m&&"string"===typeof Module.websocket.subprotocol&&(k=Module.websocket.subprotocol);var n=
void 0;"null"!==k&&(n=k=k.replace(/^ +| +$/g,"").split(/ *, */));m&&null===Module.websocket.subprotocol&&(n=void 0);d=new (ENVIRONMENT_IS_NODE?require("ws"):WebSocket)(l,n);d.binaryType="arraybuffer"}catch(p){throw new FS.ErrnoError(23);}b={addr:b,port:c,socket:d,dgram_send_queue:[]};SOCKFS.websocket_sock_ops.addPeer(a,b);SOCKFS.websocket_sock_ops.handlePeerEvents(a,b);2===a.type&&"undefined"!=typeof a.sport&&b.dgram_send_queue.push(new Uint8Array([255,255,255,255,112,111,114,116,(a.sport&65280)>>
8,a.sport&255]));return b},getPeer:function(a,b,c){return a.peers[b+":"+c]},addPeer:function(a,b){a.peers[b.addr+":"+b.port]=b},removePeer:function(a,b){delete a.peers[b.addr+":"+b.port]},handlePeerEvents:function(a,b){function c(l){if("string"==typeof l)l=(new TextEncoder).encode(l);else{assert(void 0!==l.byteLength);if(0==l.byteLength)return;l=new Uint8Array(l)}var k=d;d=!1;k&&10===l.length&&255===l[0]&&255===l[1]&&255===l[2]&&255===l[3]&&112===l[4]&&111===l[5]&&114===l[6]&&116===l[7]?(l=l[8]<<
8|l[9],SOCKFS.websocket_sock_ops.removePeer(a,b),b.port=l,SOCKFS.websocket_sock_ops.addPeer(a,b)):(a.recv_queue.push({addr:b.addr,port:b.port,data:l}),Module.websocket.emit("message",a.stream.fd))}var d=!0,m=function(){Module.websocket.emit("open",a.stream.fd);try{for(var l=b.dgram_send_queue.shift();l;)b.socket.send(l),l=b.dgram_send_queue.shift()}catch(k){b.socket.close()}};ENVIRONMENT_IS_NODE?(b.socket.on("open",m),b.socket.on("message",function(l,k){k&&c((new Uint8Array(l)).buffer)}),b.socket.on("close",
function(){Module.websocket.emit("close",a.stream.fd)}),b.socket.on("error",function(l){a.error=14;Module.websocket.emit("error",[a.stream.fd,a.error,"ECONNREFUSED: Connection refused"])})):(b.socket.onopen=m,b.socket.onclose=function(){Module.websocket.emit("close",a.stream.fd)},b.socket.onmessage=function(l){c(l.data)},b.socket.onerror=function(l){a.error=14;Module.websocket.emit("error",[a.stream.fd,a.error,"ECONNREFUSED: Connection refused"])})},poll:function(a){if(1===a.type&&a.server)return a.pending.length?
65:0;var b=0,c=1===a.type?SOCKFS.websocket_sock_ops.getPeer(a,a.daddr,a.dport):null;if(a.recv_queue.length||!c||c&&c.socket.readyState===c.socket.CLOSING||c&&c.socket.readyState===c.socket.CLOSED)b|=65;if(!c||c&&c.socket.readyState===c.socket.OPEN)b|=4;if(c&&c.socket.readyState===c.socket.CLOSING||c&&c.socket.readyState===c.socket.CLOSED)b|=16;return b},ioctl:function(a,b,c){switch(b){case 21531:return b=0,a.recv_queue.length&&(b=a.recv_queue[0].data.length),HEAP32[c>>2]=b,0;default:return 28}},close:function(a){if(a.server){try{a.server.close()}catch(m){}a.server=
null}for(var b=Object.keys(a.peers),c=0;c<b.length;c++){var d=a.peers[b[c]];try{d.socket.close()}catch(m){}SOCKFS.websocket_sock_ops.removePeer(a,d)}return 0},bind:function(a,b,c){if("undefined"!=typeof a.saddr||"undefined"!=typeof a.sport)throw new FS.ErrnoError(28);a.saddr=b;a.sport=c;if(2===a.type){a.server&&(a.server.close(),a.server=null);try{a.sock_ops.listen(a,0)}catch(d){if("ErrnoError"!==d.name)throw d;if(138!==d.errno)throw d;}}},connect:function(a,b,c){if(a.server)throw new FS.ErrnoError(138);
if("undefined"!=typeof a.daddr&&"undefined"!=typeof a.dport){var d=SOCKFS.websocket_sock_ops.getPeer(a,a.daddr,a.dport);if(d){if(d.socket.readyState===d.socket.CONNECTING)throw new FS.ErrnoError(7);throw new FS.ErrnoError(30);}}b=SOCKFS.websocket_sock_ops.createPeer(a,b,c);a.daddr=b.addr;a.dport=b.port;throw new FS.ErrnoError(26);},listen:function(a,b){if(!ENVIRONMENT_IS_NODE)throw new FS.ErrnoError(138);if(a.server)throw new FS.ErrnoError(28);b=require("ws").Server;a.server=new b({host:a.saddr,port:a.sport});
Module.websocket.emit("listen",a.stream.fd);a.server.on("connection",function(c){if(1===a.type){var d=SOCKFS.createSocket(a.family,a.type,a.protocol);c=SOCKFS.websocket_sock_ops.createPeer(d,c);d.daddr=c.addr;d.dport=c.port;a.pending.push(d);Module.websocket.emit("connection",d.stream.fd)}else SOCKFS.websocket_sock_ops.createPeer(a,c),Module.websocket.emit("connection",a.stream.fd)});a.server.on("close",function(){Module.websocket.emit("close",a.stream.fd);a.server=null});a.server.on("error",function(c){a.error=
23;Module.websocket.emit("error",[a.stream.fd,a.error,"EHOSTUNREACH: Host is unreachable"])})},accept:function(a){if(!a.server||!a.pending.length)throw new FS.ErrnoError(28);var b=a.pending.shift();b.stream.flags=a.stream.flags;return b},getname:function(a,b){if(b){if(void 0===a.daddr||void 0===a.dport)throw new FS.ErrnoError(53);b=a.daddr;a=a.dport}else b=a.saddr||0,a=a.sport||0;return{addr:b,port:a}},sendmsg:function(a,b,c,d,m,l){if(2===a.type){if(void 0===m||void 0===l)m=a.daddr,l=a.dport;if(void 0===
m||void 0===l)throw new FS.ErrnoError(17);}else m=a.daddr,l=a.dport;var k=SOCKFS.websocket_sock_ops.getPeer(a,m,l);if(1===a.type){if(!k||k.socket.readyState===k.socket.CLOSING||k.socket.readyState===k.socket.CLOSED)throw new FS.ErrnoError(53);if(k.socket.readyState===k.socket.CONNECTING)throw new FS.ErrnoError(6);}ArrayBuffer.isView(b)&&(c+=b.byteOffset,b=b.buffer);b=b.slice(c,c+d);if(2===a.type&&(!k||k.socket.readyState!==k.socket.OPEN))return k&&k.socket.readyState!==k.socket.CLOSING&&k.socket.readyState!==
k.socket.CLOSED||(k=SOCKFS.websocket_sock_ops.createPeer(a,m,l)),k.dgram_send_queue.push(b),d;try{return k.socket.send(b),d}catch(n){throw new FS.ErrnoError(28);}},recvmsg:function(a,b){if(1===a.type&&a.server)throw new FS.ErrnoError(53);var c=a.recv_queue.shift();if(!c){if(1===a.type){a=SOCKFS.websocket_sock_ops.getPeer(a,a.daddr,a.dport);if(!a)throw new FS.ErrnoError(53);if(a.socket.readyState===a.socket.CLOSING||a.socket.readyState===a.socket.CLOSED)return null}throw new FS.ErrnoError(6);}var d=
c.data.byteLength||c.data.length,m=c.data.byteOffset||0,l=c.data.buffer||c.data;b=Math.min(b,d);var k={buffer:new Uint8Array(l,m,b),addr:c.addr,port:c.port};1===a.type&&b<d&&(c.data=new Uint8Array(l,m+b,d-b),a.recv_queue.unshift(c));return k}}},getSocketFromFD=function(a){a=SOCKFS.getSocket(a);if(!a)throw new FS.ErrnoError(8);return a},setErrNo=function(a){return HEAP32[___errno_location()>>2]=a},Sockets={BUFFER_SIZE:10240,MAX_BUFFER_SIZE:10485760,nextFd:1,fds:{},nextport:1,maxport:65535,peer:null,
connections:{},portmap:{},localAddr:4261412874,addrPool:[33554442,50331658,67108874,83886090,100663306,117440522,134217738,150994954,167772170,184549386,201326602,218103818,234881034]},inetNtop4=function(a){return(a&255)+"."+(a>>8&255)+"."+(a>>16&255)+"."+(a>>24&255)},inetNtop6=function(a){var b="",c,d=0,m=0,l=0,k=0;a=[a[0]&65535,a[0]>>16,a[1]&65535,a[1]>>16,a[2]&65535,a[2]>>16,a[3]&65535,a[3]>>16];var n=!0;for(c=0;5>c;c++)if(0!==a[c]){n=!1;break}if(n){c=inetNtop4(a[6]|a[7]<<16);if(-1===a[5])return"::ffff:"+
c;if(0===a[5])return"0.0.0.0"===c&&(c=""),"0.0.0.1"===c&&(c="1"),"::"+c}for(c=0;8>c;c++)0===a[c]&&(1<c-m&&(k=0),m=c,k++),k>d&&(d=k,l=c-d+1);for(c=0;8>c;c++)1<d&&0===a[c]&&c>=l&&c<l+d?c===l&&(b+=":",0===l&&(b+=":")):(b+=Number(_ntohs(a[c]&65535)).toString(16),b+=7>c?":":"");return b},readSockaddr=function(a,b){var c=HEAP16[a>>1],d=_ntohs(HEAPU16[a+2>>1]);switch(c){case 2:if(16!==b)return{errno:28};a=HEAP32[a+4>>2];a=inetNtop4(a);break;case 10:if(28!==b)return{errno:28};a=[HEAP32[a+8>>2],HEAP32[a+12>>
2],HEAP32[a+16>>2],HEAP32[a+20>>2]];a=inetNtop6(a);break;default:return{errno:5}}return{family:c,addr:a,port:d}},inetPton4=function(a){a=a.split(".");for(var b=0;4>b;b++){var c=Number(a[b]);if(isNaN(c))return null;a[b]=c}return(a[0]|a[1]<<8|a[2]<<16|a[3]<<24)>>>0},jstoi_q=function(a){return parseInt(a)},inetPton6=function(a){var b,c,d=[];if(!/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i.test(a))return null;
if("::"===a)return[0,0,0,0,0,0,0,0];a=a.startsWith("::")?a.replace("::","Z:"):a.replace("::",":Z:");0<a.indexOf(".")?(a=a.replace(/[.]/g,":"),a=a.split(":"),a[a.length-4]=jstoi_q(a[a.length-4])+256*jstoi_q(a[a.length-3]),a[a.length-3]=jstoi_q(a[a.length-2])+256*jstoi_q(a[a.length-1]),a=a.slice(0,a.length-2)):a=a.split(":");for(b=c=0;b<a.length;b++)if("string"==typeof a[b])if("Z"===a[b]){for(c=0;c<8-a.length+1;c++)d[b+c]=0;--c}else d[b+c]=_htons(parseInt(a[b],16));else d[b+c]=a[b];return[d[1]<<16|
d[0],d[3]<<16|d[2],d[5]<<16|d[4],d[7]<<16|d[6]]},DNS={address_map:{id:1,addrs:{},names:{}},lookup_name:function(a){var b=inetPton4(a);if(null!==b)return a;b=inetPton6(a);if(null!==b)return a;DNS.address_map.addrs[a]?b=DNS.address_map.addrs[a]:(b=DNS.address_map.id++,assert(65535>b,"exceeded max address mappings of 65535"),b="172.29."+(b&255)+"."+(b&65280),DNS.address_map.names[b]=a,DNS.address_map.addrs[a]=b);return b},lookup_addr:function(a){return DNS.address_map.names[a]?DNS.address_map.names[a]:
null}},getSocketAddress=function(a,b,c){if(c&&0===a)return null;a=readSockaddr(a,b);if(a.errno)throw new FS.ErrnoError(a.errno);a.addr=DNS.lookup_addr(a.addr)||a.addr;return a};function ___syscall_connect(a,b,c,d,m,l){try{var k=getSocketFromFD(a),n=getSocketAddress(b,c);k.sock_ops.connect(k,n.addr,n.port);return 0}catch(p){if("undefined"==typeof FS||"ErrnoError"!==p.name)throw p;return-p.errno}}
function ___syscall_fcntl64(a,b,c){SYSCALLS.varargs=c;try{var d=SYSCALLS.getStreamFromFD(a);switch(b){case 0:var m=SYSCALLS.get();if(0>m)return-28;for(;FS.streams[m];)m++;return FS.createStream(d,m).fd;case 1:case 2:return 0;case 3:return d.flags;case 4:return m=SYSCALLS.get(),d.flags|=m,0;case 5:return m=SYSCALLS.getp(),HEAP16[m+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return setErrNo(28),-1;default:return-28}}catch(l){if("undefined"==typeof FS||"ErrnoError"!==l.name)throw l;
return-l.errno}}
function ___syscall_ioctl(a,b,c){SYSCALLS.varargs=c;try{var d=SYSCALLS.getStreamFromFD(a);switch(b){case 21509:return d.tty?0:-59;case 21505:if(!d.tty)return-59;if(d.tty.ops.ioctl_tcgets){var m=d.tty.ops.ioctl_tcgets(d),l=SYSCALLS.getp();HEAP32[l>>2]=m.c_iflag||0;HEAP32[l+4>>2]=m.c_oflag||0;HEAP32[l+8>>2]=m.c_cflag||0;HEAP32[l+12>>2]=m.c_lflag||0;for(var k=0;32>k;k++)HEAP8[l+k+17>>0]=m.c_cc[k]||0}return 0;case 21510:case 21511:case 21512:return d.tty?0:-59;case 21506:case 21507:case 21508:if(!d.tty)return-59;if(d.tty.ops.ioctl_tcsets){l=
SYSCALLS.getp();var n=HEAP32[l>>2],p=HEAP32[l+4>>2],q=HEAP32[l+8>>2],h=HEAP32[l+12>>2];a=[];for(k=0;32>k;k++)a.push(HEAP8[l+k+17>>0]);return d.tty.ops.ioctl_tcsets(d.tty,b,{c_iflag:n,c_oflag:p,c_cflag:q,c_lflag:h,c_cc:a})}return 0;case 21519:if(!d.tty)return-59;l=SYSCALLS.getp();return HEAP32[l>>2]=0;case 21520:return d.tty?-28:-59;case 21531:return l=SYSCALLS.getp(),FS.ioctl(d,b,l);case 21523:if(!d.tty)return-59;if(d.tty.ops.ioctl_tiocgwinsz){var e=d.tty.ops.ioctl_tiocgwinsz(d.tty);l=SYSCALLS.getp();
HEAP16[l>>1]=e[0];HEAP16[l+2>>1]=e[1]}return 0;case 21524:return d.tty?0:-59;case 21515:return d.tty?0:-59;default:return-28}}catch(f){if("undefined"==typeof FS||"ErrnoError"!==f.name)throw f;return-f.errno}}
var writeSockaddr=function(a,b,c,d,m){switch(b){case 2:c=inetPton4(c);zeroMemory(a,16);m&&(HEAP32[m>>2]=16);HEAP16[a>>1]=b;HEAP32[a+4>>2]=c;HEAP16[a+2>>1]=_htons(d);break;case 10:c=inetPton6(c);zeroMemory(a,28);m&&(HEAP32[m>>2]=28);HEAP32[a>>2]=b;HEAP32[a+8>>2]=c[0];HEAP32[a+12>>2]=c[1];HEAP32[a+16>>2]=c[2];HEAP32[a+20>>2]=c[3];HEAP16[a+2>>1]=_htons(d);break;default:return 5}return 0};
function ___syscall_recvfrom(a,b,c,d,m,l){try{var k=getSocketFromFD(a),n=k.sock_ops.recvmsg(k,c);if(!n)return 0;if(m){var p=writeSockaddr(m,k.family,DNS.lookup_name(n.addr),n.port,l);assert(!p)}HEAPU8.set(n.buffer,b);return n.buffer.byteLength}catch(q){if("undefined"==typeof FS||"ErrnoError"!==q.name)throw q;return-q.errno}}
function ___syscall_sendto(a,b,c,d,m,l){try{var k=getSocketFromFD(a),n=getSocketAddress(m,l,!0);return n?k.sock_ops.sendmsg(k,HEAP8,b,c,n.addr,n.port):FS.write(k.stream,HEAP8,b,c)}catch(p){if("undefined"==typeof FS||"ErrnoError"!==p.name)throw p;return-p.errno}}function ___syscall_socket(a,b,c){try{var d=SOCKFS.createSocket(a,b,c);assert(64>d.stream.fd);return d.stream.fd}catch(m){if("undefined"==typeof FS||"ErrnoError"!==m.name)throw m;return-m.errno}}
var isLeapYear=function(a){return 0===a%4&&(0!==a%100||0===a%400)},MONTH_DAYS_LEAP_CUMULATIVE=[0,31,60,91,121,152,182,213,244,274,305,335],MONTH_DAYS_REGULAR_CUMULATIVE=[0,31,59,90,120,151,181,212,243,273,304,334],ydayFromDate=function(a){return(isLeapYear(a.getFullYear())?MONTH_DAYS_LEAP_CUMULATIVE:MONTH_DAYS_REGULAR_CUMULATIVE)[a.getMonth()]+a.getDate()-1},convertI32PairToI53Checked=function(a,b){assert(a==a>>>0||a==(a|0));assert(b===(b|0));return b+2097152>>>0<4194305-!!a?(a>>>0)+4294967296*b:
NaN};
function __localtime_js(a,b,c){a=convertI32PairToI53Checked(a,b);a=new Date(1E3*a);HEAP32[c>>2]=a.getSeconds();HEAP32[c+4>>2]=a.getMinutes();HEAP32[c+8>>2]=a.getHours();HEAP32[c+12>>2]=a.getDate();HEAP32[c+16>>2]=a.getMonth();HEAP32[c+20>>2]=a.getFullYear()-1900;HEAP32[c+24>>2]=a.getDay();b=ydayFromDate(a)|0;HEAP32[c+28>>2]=b;HEAP32[c+36>>2]=-(60*a.getTimezoneOffset());var d=new Date(a.getFullYear(),0,1);b=(new Date(a.getFullYear(),6,1)).getTimezoneOffset();d=d.getTimezoneOffset();a=(b!=d&&a.getTimezoneOffset()==Math.min(d,
b))|0;HEAP32[c+32>>2]=a}
var stringToNewUTF8=function(a){var b=lengthBytesUTF8(a)+1,c=_malloc(b);c&&stringToUTF8(a,c,b);return c},__tzset_js=function(a,b,c){function d(p){return(p=p.toTimeString().match(/\(([A-Za-z ]+)\)$/))?p[1]:"GMT"}var m=(new Date).getFullYear(),l=new Date(m,0,1),k=new Date(m,6,1);m=l.getTimezoneOffset();var n=k.getTimezoneOffset();HEAPU32[a>>2]=60*Math.max(m,n);HEAP32[b>>2]=Number(m!=n);a=d(l);b=d(k);a=stringToNewUTF8(a);b=stringToNewUTF8(b);n<m?(HEAPU32[c>>2]=a,HEAPU32[c+4>>2]=b):(HEAPU32[c>>2]=b,HEAPU32[c+
4>>2]=a)},_abort=function(){abort("native code called abort()")},readEmAsmArgsArray=[],readEmAsmArgs=function(a,b){assert(Array.isArray(readEmAsmArgsArray));assert(0==b%16);readEmAsmArgsArray.length=0;for(var c;c=HEAPU8[a++];){var d=String.fromCharCode(c),m=["d","f","i","p"];assert(m.includes(d),"Invalid character "+c+'("'+d+'") in readEmAsmArgs! Use only ['+m+'], and do not specify "v" for void return argument.');d=105!=c;d&=112!=c;b+=d&&b%8?4:0;readEmAsmArgsArray.push(112==c?HEAPU32[b>>2]:105==
c?HEAP32[b>>2]:HEAPF64[b>>3]);b+=d?8:4}return readEmAsmArgsArray},runEmAsmFunction=function(a,b,c){b=readEmAsmArgs(b,c);assert(ASM_CONSTS.hasOwnProperty(a),"No EM_ASM constant found at address "+a+".  The loaded WebAssembly file is likely out of sync with the generated JavaScript.");return ASM_CONSTS[a].apply(null,b)},_emscripten_asm_const_int=function(a,b,c){return runEmAsmFunction(a,b,c)},_emscripten_date_now=function(){return Date.now()},_emscripten_memcpy_js=function(a,b,c){return HEAPU8.copyWithin(a,
b,b+c)},getHeapMax=function(){return 2147483648},growMemory=function(a){var b=wasmMemory.buffer,c=(a-b.byteLength+65535)/65536;try{return wasmMemory.grow(c),updateMemoryViews(),1}catch(d){err("growMemory: Attempted to grow heap from "+b.byteLength+" bytes to "+a+" bytes, but got error: "+d)}},_emscripten_resize_heap=function(a){var b=HEAPU8.length;a>>>=0;assert(a>b);var c=getHeapMax();if(a>c)return err("Cannot enlarge memory, requested "+a+" bytes, but the limit is "+c+" bytes!"),!1;for(var d=1;4>=
d;d*=2){var m=b*(1+.2/d);m=Math.min(m,a+100663296);var l=Math;m=Math.max(a,m);l=l.min.call(l,c,m+(65536-m%65536)%65536);if(growMemory(l))return!0}err("Failed to grow the heap from "+b+" bytes to "+l+" bytes, not enough memory!");return!1},ENV={},getExecutableName=function(){return thisProgram||"./this.program"},getEnvStrings=function(){if(!getEnvStrings.strings){var a={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&
navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:getExecutableName()},b;for(b in ENV)void 0===ENV[b]?delete a[b]:a[b]=ENV[b];var c=[];for(b in a)c.push(b+"="+a[b]);getEnvStrings.strings=c}return getEnvStrings.strings},stringToAscii=function(a,b){for(var c=0;c<a.length;++c)assert(a.charCodeAt(c)===(a.charCodeAt(c)&255)),HEAP8[b++>>0]=a.charCodeAt(c);HEAP8[b>>0]=0},_environ_get=function(a,b){var c=0;getEnvStrings().forEach(function(d,m){var l=b+c;HEAPU32[a+4*m>>2]=l;stringToAscii(d,l);c+=d.length+
1});return 0},_environ_sizes_get=function(a,b){var c=getEnvStrings();HEAPU32[a>>2]=c.length;var d=0;c.forEach(function(m){return d+=m.length+1});HEAPU32[b>>2]=d;return 0};function _fd_close(a){try{var b=SYSCALLS.getStreamFromFD(a);FS.close(b);return 0}catch(c){if("undefined"==typeof FS||"ErrnoError"!==c.name)throw c;return c.errno}}
var doReadv=function(a,b,c,d){for(var m=0,l=0;l<c;l++){var k=HEAPU32[b>>2],n=HEAPU32[b+4>>2];b+=8;k=FS.read(a,HEAP8,k,n,d);if(0>k)return-1;m+=k;if(k<n)break;"undefined"!==typeof d&&(d+=k)}return m};function _fd_read(a,b,c,d){try{var m=SYSCALLS.getStreamFromFD(a),l=doReadv(m,b,c);HEAPU32[d>>2]=l;return 0}catch(k){if("undefined"==typeof FS||"ErrnoError"!==k.name)throw k;return k.errno}}
function _fd_seek(a,b,c,d,m){b=convertI32PairToI53Checked(b,c);try{if(isNaN(b))return 61;var l=SYSCALLS.getStreamFromFD(a);FS.llseek(l,b,d);tempI64=[l.position>>>0,(tempDouble=l.position,1<=+Math.abs(tempDouble)?0<tempDouble?+Math.floor(tempDouble/4294967296)>>>0:~~+Math.ceil((tempDouble-+(~~tempDouble>>>0))/4294967296)>>>0:0)];HEAP32[m>>2]=tempI64[0];HEAP32[m+4>>2]=tempI64[1];l.getdents&&0===b&&0===d&&(l.getdents=null);return 0}catch(k){if("undefined"==typeof FS||"ErrnoError"!==k.name)throw k;return k.errno}}
var doWritev=function(a,b,c,d){for(var m=0,l=0;l<c;l++){var k=HEAPU32[b>>2],n=HEAPU32[b+4>>2];b+=8;k=FS.write(a,HEAP8,k,n,d);if(0>k)return-1;m+=k;"undefined"!==typeof d&&(d+=k)}return m};function _fd_write(a,b,c,d){try{var m=SYSCALLS.getStreamFromFD(a),l=doWritev(m,b,c);HEAPU32[d>>2]=l;return 0}catch(k){if("undefined"==typeof FS||"ErrnoError"!==k.name)throw k;return k.errno}}
var _getentropy=function(a,b){randomFill(HEAPU8.subarray(a,a+b));return 0},arraySum=function(a,b){for(var c=0,d=0;d<=b;c+=a[d++]);return c},MONTH_DAYS_LEAP=[31,29,31,30,31,30,31,31,30,31,30,31],MONTH_DAYS_REGULAR=[31,28,31,30,31,30,31,31,30,31,30,31],addDays=function(a,b){for(a=new Date(a.getTime());0<b;){var c=isLeapYear(a.getFullYear()),d=a.getMonth();c=(c?MONTH_DAYS_LEAP:MONTH_DAYS_REGULAR)[d];if(b>c-a.getDate())b-=c-a.getDate()+1,a.setDate(1),11>d?a.setMonth(d+1):(a.setMonth(0),a.setFullYear(a.getFullYear()+
1));else{a.setDate(a.getDate()+b);break}}return a},writeArrayToMemory=function(a,b){assert(0<=a.length,"writeArrayToMemory array must have a length (should be an array or typed array)");HEAP8.set(a,b)},_strftime=function(a,b,c,d){function m(g,t,r){for(g="number"==typeof g?g.toString():g||"";g.length<t;)g=r[0]+g;return g}function l(g,t){return m(g,t,"0")}function k(g,t){function r(v){return 0>v?-1:0<v?1:0}var u;0===(u=r(g.getFullYear()-t.getFullYear()))&&0===(u=r(g.getMonth()-t.getMonth()))&&(u=r(g.getDate()-
t.getDate()));return u}function n(g){switch(g.getDay()){case 0:return new Date(g.getFullYear()-1,11,29);case 1:return g;case 2:return new Date(g.getFullYear(),0,3);case 3:return new Date(g.getFullYear(),0,2);case 4:return new Date(g.getFullYear(),0,1);case 5:return new Date(g.getFullYear()-1,11,31);case 6:return new Date(g.getFullYear()-1,11,30)}}function p(g){g=addDays(new Date(g.tm_year+1900,0,1),g.tm_yday);var t=new Date(g.getFullYear(),0,4),r=new Date(g.getFullYear()+1,0,4);t=n(t);r=n(r);return 0>=
k(t,g)?0>=k(r,g)?g.getFullYear()+1:g.getFullYear():g.getFullYear()-1}var q=HEAPU32[d+40>>2];d={tm_sec:HEAP32[d>>2],tm_min:HEAP32[d+4>>2],tm_hour:HEAP32[d+8>>2],tm_mday:HEAP32[d+12>>2],tm_mon:HEAP32[d+16>>2],tm_year:HEAP32[d+20>>2],tm_wday:HEAP32[d+24>>2],tm_yday:HEAP32[d+28>>2],tm_isdst:HEAP32[d+32>>2],tm_gmtoff:HEAP32[d+36>>2],tm_zone:q?UTF8ToString(q):""};c=UTF8ToString(c);q={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y",
"%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var h in q)c=c.replace(new RegExp(h,"g"),q[h]);var e="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),f="January February March April May June July August September October November December".split(" ");q={"%a":function(g){return e[g.tm_wday].substring(0,
3)},"%A":function(g){return e[g.tm_wday]},"%b":function(g){return f[g.tm_mon].substring(0,3)},"%B":function(g){return f[g.tm_mon]},"%C":function(g){return l((g.tm_year+1900)/100|0,2)},"%d":function(g){return l(g.tm_mday,2)},"%e":function(g){return m(g.tm_mday,2," ")},"%g":function(g){return p(g).toString().substring(2)},"%G":function(g){return p(g)},"%H":function(g){return l(g.tm_hour,2)},"%I":function(g){g=g.tm_hour;0==g?g=12:12<g&&(g-=12);return l(g,2)},"%j":function(g){return l(g.tm_mday+arraySum(isLeapYear(g.tm_year+
1900)?MONTH_DAYS_LEAP:MONTH_DAYS_REGULAR,g.tm_mon-1),3)},"%m":function(g){return l(g.tm_mon+1,2)},"%M":function(g){return l(g.tm_min,2)},"%n":function(){return"\n"},"%p":function(g){return 0<=g.tm_hour&&12>g.tm_hour?"AM":"PM"},"%S":function(g){return l(g.tm_sec,2)},"%t":function(){return"\t"},"%u":function(g){return g.tm_wday||7},"%U":function(g){return l(Math.floor((g.tm_yday+7-g.tm_wday)/7),2)},"%V":function(g){var t=Math.floor((g.tm_yday+7-(g.tm_wday+6)%7)/7);2>=(g.tm_wday+371-g.tm_yday-2)%7&&
t++;if(t)53==t&&(r=(g.tm_wday+371-g.tm_yday)%7,4==r||3==r&&isLeapYear(g.tm_year)||(t=1));else{t=52;var r=(g.tm_wday+7-g.tm_yday-1)%7;(4==r||5==r&&isLeapYear(g.tm_year%400-1))&&t++}return l(t,2)},"%w":function(g){return g.tm_wday},"%W":function(g){return l(Math.floor((g.tm_yday+7-(g.tm_wday+6)%7)/7),2)},"%y":function(g){return(g.tm_year+1900).toString().substring(2)},"%Y":function(g){return g.tm_year+1900},"%z":function(g){g=g.tm_gmtoff;var t=0<=g;g=Math.abs(g)/60;return(t?"+":"-")+String("0000"+(g/
60*100+g%60)).slice(-4)},"%Z":function(g){return g.tm_zone},"%%":function(){return"%"}};c=c.replace(/%%/g,"\x00\x00");for(h in q)c.includes(h)&&(c=c.replace(new RegExp(h,"g"),q[h](d)));c=c.replace(/\0\0/g,"%");h=intArrayFromString(c,!1);if(h.length>b)return 0;writeArrayToMemory(h,a);return h.length-1},_strftime_l=function(a,b,c,d,m){return _strftime(a,b,c,d)},getCFunc=function(a){var b=Module["_"+a];assert(b,"Cannot call unknown function "+a+", make sure it is exported");return b},ccall=function(a,
b,c,d,m){m={string:function(q){var h=0;null!==q&&void 0!==q&&0!==q&&(h=stringToUTF8OnStack(q));return h},array:function(q){var h=stackAlloc(q.length);writeArrayToMemory(q,h);return h}};a=getCFunc(a);var l=[],k=0;assert("array"!==b,'Return type should not be "array".');if(d)for(var n=0;n<d.length;n++){var p=m[c[n]];p?(0===k&&(k=stackSave()),l[n]=p(d[n])):l[n]=d[n]}c=a.apply(null,l);return c=function(q){0!==k&&stackRestore(k);q="string"===b?UTF8ToString(q):"boolean"===b?!!q:q;return q}(c)},cwrap=function(a,
b,c,d){return function(){return ccall(a,b,c,arguments,d)}},UTF32ToString=function(a,b){assert(0==a%4,"Pointer passed to UTF32ToString must be aligned to four bytes!");for(var c=0,d="";!(c>=b/4);){var m=HEAP32[a+4*c>>2];if(0==m)break;++c;65536<=m?(m-=65536,d+=String.fromCharCode(55296|m>>10,56320|m&1023)):d+=String.fromCharCode(m)}return d},uleb128Encode=function(a,b){assert(16384>a);128>a?b.push(a):b.push(a%128|128,a>>7)},sigToWasmTypes=function(a){assert(!a.includes("j"),"i64 not permitted in function signatures when WASM_BIGINT is disabled");
for(var b={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},c={parameters:[],results:"v"==a[0]?[]:[b[a[0]]]},d=1;d<a.length;++d)assert(a[d]in b,"invalid signature char: "+a[d]),c.parameters.push(b[a[d]]);return c},generateFuncType=function(a,b){var c=a.slice(0,1);a=a.slice(1);var d={i:127,p:127,j:126,f:125,d:124,e:111};b.push(96);uleb128Encode(a.length,b);for(var m=0;m<a.length;++m)assert(a[m]in d,"invalid signature char: "+a[m]),b.push(d[a[m]]);"v"==c?b.push(0):b.push(1,d[c])},convertJsFunctionToWasm=
function(a,b){assert(!b.includes("j"),"i64 not permitted in function signatures when WASM_BIGINT is disabled");if("function"==typeof WebAssembly.Function)return new WebAssembly.Function(sigToWasmTypes(b),a);var c=[1];generateFuncType(b,c);b=[0,97,115,109,1,0,0,0,1];uleb128Encode(c.length,b);b.push.apply(b,c);b.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);c=new WebAssembly.Module(new Uint8Array(b));return(new WebAssembly.Instance(c,{e:{f:a}})).exports.f},wasmTableMirror=[],wasmTable,getWasmTableEntry=
function(a){var b=wasmTableMirror[a];b||(a>=wasmTableMirror.length&&(wasmTableMirror.length=a+1),wasmTableMirror[a]=b=wasmTable.get(a));assert(wasmTable.get(a)==b,"JavaScript-side Wasm function table mirror is out of date!");return b},updateTableMap=function(a,b){if(functionsInTableMap)for(var c=a;c<a+b;c++){var d=getWasmTableEntry(c);d&&functionsInTableMap.set(d,c)}},functionsInTableMap,getFunctionAddress=function(a){functionsInTableMap||(functionsInTableMap=new WeakMap,updateTableMap(0,wasmTable.length));
return functionsInTableMap.get(a)||0},freeTableIndexes=[],getEmptyTableSlot=function(){if(freeTableIndexes.length)return freeTableIndexes.pop();try{wasmTable.grow(1)}catch(a){if(!(a instanceof RangeError))throw a;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.";}return wasmTable.length-1},setWasmTableEntry=function(a,b){wasmTable.set(a,b);wasmTableMirror[a]=wasmTable.get(a)},addFunction=function(a,b){assert("undefined"!=typeof a);var c=getFunctionAddress(a);if(c)return c;c=getEmptyTableSlot();
try{setWasmTableEntry(c,a)}catch(d){if(!(d instanceof TypeError))throw d;assert("undefined"!=typeof b,"Missing signature argument to addFunction: "+a);b=convertJsFunctionToWasm(a,b);setWasmTableEntry(c,b)}functionsInTableMap.set(a,c);return c},removeFunction=function(a){functionsInTableMap.delete(getWasmTableEntry(a));setWasmTableEntry(a,null);freeTableIndexes.push(a)},FSNode=function(a,b,c,d){a||(a=this);this.parent=a;this.mount=a.mount;this.mounted=null;this.id=FS.nextInode++;this.name=b;this.mode=
c;this.node_ops={};this.stream_ops={};this.rdev=d},readMode=365,writeMode=146;Object.defineProperties(FSNode.prototype,{read:{get:function(){return(this.mode&readMode)===readMode},set:function(a){a?this.mode|=readMode:this.mode&=~readMode}},write:{get:function(){return(this.mode&writeMode)===writeMode},set:function(a){a?this.mode|=writeMode:this.mode&=~writeMode}},isFolder:{get:function(){return FS.isDir(this.mode)}},isDevice:{get:function(){return FS.isChrdev(this.mode)}}});FS.FSNode=FSNode;
FS.createPreloadedFile=FS_createPreloadedFile;FS.staticInit();
ERRNO_CODES={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,
EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,
ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135};function checkIncomingModuleAPI(){ignoredModuleProp("fetchSettings")}
var wasmImports={__assert_fail:___assert_fail,__cxa_throw:___cxa_throw,__syscall__newselect:___syscall__newselect,__syscall_connect:___syscall_connect,__syscall_fcntl64:___syscall_fcntl64,__syscall_ioctl:___syscall_ioctl,__syscall_recvfrom:___syscall_recvfrom,__syscall_sendto:___syscall_sendto,__syscall_socket:___syscall_socket,_localtime_js:__localtime_js,_tzset_js:__tzset_js,abort:_abort,emscripten_asm_const_int:_emscripten_asm_const_int,emscripten_date_now:_emscripten_date_now,emscripten_memcpy_js:_emscripten_memcpy_js,
emscripten_resize_heap:_emscripten_resize_heap,environ_get:_environ_get,environ_sizes_get:_environ_sizes_get,fd_close:_fd_close,fd_read:_fd_read,fd_seek:_fd_seek,fd_write:_fd_write,getentropy:_getentropy,strftime:_strftime,strftime_l:_strftime_l},wasmExports=createWasm(),___wasm_call_ctors=createExportWrapper("__wasm_call_ctors"),_PhotonPeerCreate=Module._PhotonPeerCreate=createExportWrapper("PhotonPeerCreate"),_free=Module._free=createExportWrapper("free"),_malloc=Module._malloc=createExportWrapper("malloc"),
_PhotonPeerDestroy=Module._PhotonPeerDestroy=createExportWrapper("PhotonPeerDestroy"),_PhotonPeerConnect=Module._PhotonPeerConnect=createExportWrapper("PhotonPeerConnect"),_PhotonPeerDisconnect=Module._PhotonPeerDisconnect=createExportWrapper("PhotonPeerDisconnect"),_PhotonPeerState=Module._PhotonPeerState=createExportWrapper("PhotonPeerState"),_PhotonPeerService=Module._PhotonPeerService=createExportWrapper("PhotonPeerService"),_PhotonPeerSetDebugOutputLevel=Module._PhotonPeerSetDebugOutputLevel=
createExportWrapper("PhotonPeerSetDebugOutputLevel"),_PhotonPeerOpCustom=Module._PhotonPeerOpCustom=createExportWrapper("PhotonPeerOpCustom"),_PhotonPeerFetchServerTimestamp=Module._PhotonPeerFetchServerTimestamp=createExportWrapper("PhotonPeerFetchServerTimestamp"),_PhotonPeerGetServerTime=Module._PhotonPeerGetServerTime=createExportWrapper("PhotonPeerGetServerTime"),_PhotonPeerGetRoundTripTime=Module._PhotonPeerGetRoundTripTime=createExportWrapper("PhotonPeerGetRoundTripTime"),_PhotonOperationRequestCreate=
Module._PhotonOperationRequestCreate=createExportWrapper("PhotonOperationRequestCreate"),_PhotonOperationRequestDestroy=Module._PhotonOperationRequestDestroy=createExportWrapper("PhotonOperationRequestDestroy"),_PhotonOperationRequestSetParam=Module._PhotonOperationRequestSetParam=createExportWrapper("PhotonOperationRequestSetParam"),_PhotonTypesByte=Module._PhotonTypesByte=createExportWrapper("PhotonTypesByte"),_PhotonTypesShort=Module._PhotonTypesShort=createExportWrapper("PhotonTypesShort"),_PhotonTypesInt=
Module._PhotonTypesInt=createExportWrapper("PhotonTypesInt"),_PhotonTypesLong=Module._PhotonTypesLong=createExportWrapper("PhotonTypesLong"),_PhotonTypesFloat=Module._PhotonTypesFloat=createExportWrapper("PhotonTypesFloat"),_PhotonTypesDouble=Module._PhotonTypesDouble=createExportWrapper("PhotonTypesDouble"),_PhotonTypesBool=Module._PhotonTypesBool=createExportWrapper("PhotonTypesBool"),_PhotonTypesString=Module._PhotonTypesString=createExportWrapper("PhotonTypesString"),_PhotonTypesTable=Module._PhotonTypesTable=
createExportWrapper("PhotonTypesTable"),_PhotonTypesDictBase=Module._PhotonTypesDictBase=createExportWrapper("PhotonTypesDictBase"),_PhotonTypesDictBaseFromDict=Module._PhotonTypesDictBaseFromDict=createExportWrapper("PhotonTypesDictBaseFromDict"),_PhotonTypesDict=Module._PhotonTypesDict=createExportWrapper("PhotonTypesDict"),_PhotonTypesArray=Module._PhotonTypesArray=createExportWrapper("PhotonTypesArray"),_PhotonTypesDestroy=Module._PhotonTypesDestroy=createExportWrapper("PhotonTypesDestroy"),_PhotonTypesGetType=
Module._PhotonTypesGetType=createExportWrapper("PhotonTypesGetType"),_PhotonTypesGetByte=Module._PhotonTypesGetByte=createExportWrapper("PhotonTypesGetByte"),_PhotonTypesGetShort=Module._PhotonTypesGetShort=createExportWrapper("PhotonTypesGetShort"),_PhotonTypesGetInt=Module._PhotonTypesGetInt=createExportWrapper("PhotonTypesGetInt"),_PhotonTypesGetLongLow=Module._PhotonTypesGetLongLow=createExportWrapper("PhotonTypesGetLongLow"),_PhotonTypesGetLongHigh=Module._PhotonTypesGetLongHigh=createExportWrapper("PhotonTypesGetLongHigh"),
_PhotonTypesGetFloat=Module._PhotonTypesGetFloat=createExportWrapper("PhotonTypesGetFloat"),_PhotonTypesGetDouble=Module._PhotonTypesGetDouble=createExportWrapper("PhotonTypesGetDouble"),_PhotonTypesGetString=Module._PhotonTypesGetString=createExportWrapper("PhotonTypesGetString"),_PhotonTypesGetBool=Module._PhotonTypesGetBool=createExportWrapper("PhotonTypesGetBool"),_PhotonTypesGetTable=Module._PhotonTypesGetTable=createExportWrapper("PhotonTypesGetTable"),_PhotonTypesStringAt=Module._PhotonTypesStringAt=
createExportWrapper("PhotonTypesStringAt"),_PhotonTypesBoolAt=Module._PhotonTypesBoolAt=createExportWrapper("PhotonTypesBoolAt"),_PhotonTypesTableAt=Module._PhotonTypesTableAt=createExportWrapper("PhotonTypesTableAt"),_PhotonTypesObjectAt=Module._PhotonTypesObjectAt=createExportWrapper("PhotonTypesObjectAt"),_PhotonTypesTableSize=Module._PhotonTypesTableSize=createExportWrapper("PhotonTypesTableSize"),_PhotonTypesTablePut=Module._PhotonTypesTablePut=createExportWrapper("PhotonTypesTablePut"),_PhotonTypesTablePutNull=
Module._PhotonTypesTablePutNull=createExportWrapper("PhotonTypesTablePutNull"),_PhotonTypesTableKeyAt=Module._PhotonTypesTableKeyAt=createExportWrapper("PhotonTypesTableKeyAt"),_PhotonTypesTableValueAt=Module._PhotonTypesTableValueAt=createExportWrapper("PhotonTypesTableValueAt"),_PhotonTypesDictSize=Module._PhotonTypesDictSize=createExportWrapper("PhotonTypesDictSize"),_PhotonTypesDictBasePut=Module._PhotonTypesDictBasePut=createExportWrapper("PhotonTypesDictBasePut"),_PhotonTypesDictKeyAt=Module._PhotonTypesDictKeyAt=
createExportWrapper("PhotonTypesDictKeyAt"),_PhotonTypesDictValueAt=Module._PhotonTypesDictValueAt=createExportWrapper("PhotonTypesDictValueAt"),_PhotonTypesByteDictSize=Module._PhotonTypesByteDictSize=createExportWrapper("PhotonTypesByteDictSize"),_PhotonTypesByteDictPut=Module._PhotonTypesByteDictPut=createExportWrapper("PhotonTypesByteDictPut"),_PhotonTypesByteDictKeyAt=Module._PhotonTypesByteDictKeyAt=createExportWrapper("PhotonTypesByteDictKeyAt"),_PhotonTypesByteDictValueAt=Module._PhotonTypesByteDictValueAt=
createExportWrapper("PhotonTypesByteDictValueAt"),_PhotonTypesIsArray=Module._PhotonTypesIsArray=createExportWrapper("PhotonTypesIsArray"),_PhotonTypesArraySize=Module._PhotonTypesArraySize=createExportWrapper("PhotonTypesArraySize"),_PhotonTypesArrayDataAddress=Module._PhotonTypesArrayDataAddress=createExportWrapper("PhotonTypesArrayDataAddress"),___errno_location=createExportWrapper("__errno_location"),_htons=createExportWrapper("htons"),_fflush=Module._fflush=createExportWrapper("fflush"),_htonl=
createExportWrapper("htonl"),_ntohs=createExportWrapper("ntohs"),setTempRet0=createExportWrapper("setTempRet0"),_emscripten_stack_init=function(){return(_emscripten_stack_init=wasmExports.emscripten_stack_init)()},_emscripten_stack_get_free=function(){return(_emscripten_stack_get_free=wasmExports.emscripten_stack_get_free)()},_emscripten_stack_get_base=function(){return(_emscripten_stack_get_base=wasmExports.emscripten_stack_get_base)()},_emscripten_stack_get_end=function(){return(_emscripten_stack_get_end=
wasmExports.emscripten_stack_get_end)()},stackSave=createExportWrapper("stackSave"),stackRestore=createExportWrapper("stackRestore"),stackAlloc=createExportWrapper("stackAlloc"),_emscripten_stack_get_current=function(){return(_emscripten_stack_get_current=wasmExports.emscripten_stack_get_current)()},___cxa_demangle=createExportWrapper("__cxa_demangle"),___cxa_is_pointer_type=createExportWrapper("__cxa_is_pointer_type"),dynCall_viijii=Module.dynCall_viijii=createExportWrapper("dynCall_viijii"),dynCall_jiji=
Module.dynCall_jiji=createExportWrapper("dynCall_jiji"),dynCall_iiiiij=Module.dynCall_iiiiij=createExportWrapper("dynCall_iiiiij"),dynCall_iiiiijj=Module.dynCall_iiiiijj=createExportWrapper("dynCall_iiiiijj"),dynCall_iiiiiijj=Module.dynCall_iiiiiijj=createExportWrapper("dynCall_iiiiiijj");Module.ccall=ccall;Module.cwrap=cwrap;Module.addFunction=addFunction;Module.removeFunction=removeFunction;Module.setValue=setValue;Module.UTF8ToString=UTF8ToString;Module.stringToUTF8=stringToUTF8;
Module.lengthBytesUTF8=lengthBytesUTF8;Module.UTF32ToString=UTF32ToString;var missingLibrarySymbols="writeI53ToI64 writeI53ToI64Clamped writeI53ToI64Signaling writeI53ToU64Clamped writeI53ToU64Signaling readI53FromI64 readI53FromU64 convertI32PairToI53 convertU32PairToI53 exitJS getHostByName getCallstack emscriptenLog convertPCtoSourceLocation runMainThreadEmAsm jstoi_s listenOnce autoResumeAudioContext dynCallLegacy getDynCaller dynCall handleException keepRuntimeAlive runtimeKeepalivePush runtimeKeepalivePop callUserCallback maybeExit asmjsMangle handleAllocatorInit HandleAllocator getNativeTypeSize STACK_SIZE STACK_ALIGN POINTER_SIZE ASSERTIONS reallyNegative unSign strLen reSign formatString intArrayToString AsciiToString UTF16ToString stringToUTF16 lengthBytesUTF16 stringToUTF32 lengthBytesUTF32 registerKeyEventCallback maybeCStringToJsString findEventTarget findCanvasEventTarget getBoundingClientRect fillMouseEventData registerMouseEventCallback registerWheelEventCallback registerUiEventCallback registerFocusEventCallback fillDeviceOrientationEventData registerDeviceOrientationEventCallback fillDeviceMotionEventData registerDeviceMotionEventCallback screenOrientation fillOrientationChangeEventData registerOrientationChangeEventCallback fillFullscreenChangeEventData registerFullscreenChangeEventCallback JSEvents_requestFullscreen JSEvents_resizeCanvasForFullscreen registerRestoreOldStyle hideEverythingExceptGivenElement restoreHiddenElements setLetterbox softFullscreenResizeWebGLRenderTarget doRequestFullscreen fillPointerlockChangeEventData registerPointerlockChangeEventCallback registerPointerlockErrorEventCallback requestPointerLock fillVisibilityChangeEventData registerVisibilityChangeEventCallback registerTouchEventCallback fillGamepadEventData registerGamepadEventCallback registerBeforeUnloadEventCallback fillBatteryEventData battery registerBatteryEventCallback setCanvasElementSize getCanvasElementSize checkWasiClock wasiRightsToMuslOFlags wasiOFlagsToMuslOFlags createDyncallWrapper safeSetTimeout setImmediateWrapped clearImmediateWrapped polyfillSetImmediate getPromise makePromise idsToPromises makePromiseCallback findMatchingCatch setMainLoop FS_unlink FS_mkdirTree _setNetworkCallback heapObjectForWebGLType heapAccessShiftForWebGLHeap webgl_enable_ANGLE_instanced_arrays webgl_enable_OES_vertex_array_object webgl_enable_WEBGL_draw_buffers webgl_enable_WEBGL_multi_draw emscriptenWebGLGet computeUnpackAlignedImageSize colorChannelsInGlTextureFormat emscriptenWebGLGetTexPixelData __glGenObject emscriptenWebGLGetUniform webglGetUniformLocation webglPrepareUniformLocationsBeforeFirstUse webglGetLeftBracePos emscriptenWebGLGetVertexAttrib __glGetActiveAttribOrUniform writeGLArray registerWebGlEventCallback runAndAbortIfError SDL_unicode SDL_ttfContext SDL_audio ALLOC_NORMAL ALLOC_STACK allocate writeStringToMemory writeAsciiToMemory".split(" ");
missingLibrarySymbols.forEach(missingLibrarySymbol);var unexportedSymbols="run addOnPreRun addOnInit addOnPreMain addOnExit addOnPostRun addRunDependency removeRunDependency FS_createFolder FS_createPath FS_createLazyFile FS_createLink FS_createDevice FS_readFile out err callMain abort wasmMemory wasmExports stackAlloc stackSave stackRestore getTempRet0 setTempRet0 writeStackCookie checkStackCookie convertI32PairToI53Checked ptrToString zeroMemory getHeapMax growMemory ENV MONTH_DAYS_REGULAR MONTH_DAYS_LEAP MONTH_DAYS_REGULAR_CUMULATIVE MONTH_DAYS_LEAP_CUMULATIVE isLeapYear ydayFromDate arraySum addDays ERRNO_CODES ERRNO_MESSAGES setErrNo inetPton4 inetNtop4 inetPton6 inetNtop6 readSockaddr writeSockaddr DNS Protocols Sockets initRandomFill randomFill timers warnOnce UNWIND_CACHE readEmAsmArgsArray readEmAsmArgs runEmAsmFunction jstoi_q getExecutableName asyncLoad alignMemory mmapAlloc wasmTable noExitRuntime getCFunc uleb128Encode sigToWasmTypes generateFuncType convertJsFunctionToWasm freeTableIndexes functionsInTableMap getEmptyTableSlot updateTableMap getFunctionAddress getValue PATH PATH_FS UTF8Decoder UTF8ArrayToString stringToUTF8Array intArrayFromString stringToAscii UTF16Decoder stringToNewUTF8 stringToUTF8OnStack writeArrayToMemory JSEvents specialHTMLTargets currentFullscreenStrategy restoreOldWindowedStyle demangle demangleAll jsStackTrace stackTrace ExitStatus getEnvStrings doReadv doWritev promiseMap uncaughtExceptionCount exceptionLast exceptionCaught ExceptionInfo Browser wget SYSCALLS getSocketFromFD getSocketAddress preloadPlugins FS_createPreloadedFile FS_modeStringToFlags FS_getMode FS_stdin_getChar_buffer FS_stdin_getChar FS FS_createDataFile MEMFS TTY PIPEFS SOCKFS tempFixedLengthArray miniTempWebGLFloatBuffers miniTempWebGLIntBuffers GL emscripten_webgl_power_preferences AL GLUT EGL GLEW IDBStore SDL SDL_gfx allocateUTF8 allocateUTF8OnStack".split(" ");
unexportedSymbols.forEach(unexportedRuntimeSymbol);var calledRun;dependenciesFulfilled=function runCaller(){calledRun||run();calledRun||(dependenciesFulfilled=runCaller)};function stackCheckInit(){_emscripten_stack_init();writeStackCookie()}
function run(){function a(){if(!calledRun&&(calledRun=!0,Module.calledRun=!0,!ABORT)){initRuntime();if(Module.onRuntimeInitialized)Module.onRuntimeInitialized();assert(!Module._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]');postRun()}}0<runDependencies||(stackCheckInit(),preRun(),0<runDependencies||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1);a()},1)):a(),checkStackCookie()))}
function checkUnflushedContent(){var a=out,b=err,c=!1;out=err=function(d){c=!0};try{_fflush(0),["stdout","stderr"].forEach(function(d){(d=FS.analyzePath("/dev/"+d))&&(d=TTY.ttys[d.object.rdev])&&d.output&&d.output.length&&(c=!0)})}catch(d){}out=a;err=b;c&&warnOnce("stdio streams had content in them that was not flushed. you should set EXIT_RUNTIME to 1 (see the Emscripten FAQ), or make sure to emit a newline when you printf etc.")}
if(Module.preInit)for("function"==typeof Module.preInit&&(Module.preInit=[Module.preInit]);0<Module.preInit.length;)Module.preInit.pop()();run();var Photon;Module=Module||{};
Module.onRuntimeInitialized=function(a){return function(){a&&a()||function(b){var c={};(function(d){d.Create=function(m,l,k,n,p){l=addFunction(l,"vi");k=addFunction(k,"vipip");n=addFunction(n,"vip");p=addFunction(p,"vip");m=Module.ccall("PhotonPeerCreate","number",["number","number","number","number","number"],[m,l,k,n,p]);c[m]=[l,k,n,p];return m};d.Destroy=function(m){for(var l=c[m],k=0;k<l.length;k++)removeFunction(l[k]);Module.ccall("PhotonPeerDestroy",["number"],[m])};d.Connect=Module.cwrap("PhotonPeerConnect",
"number",["number","string","string"]);d.Disconnect=Module.cwrap("PhotonPeerDisconnect",null,["number"]);d.State=Module.cwrap("PhotonPeerState","number",["number"]);d.Service=Module.cwrap("PhotonPeerService",null,["number"]);d.SetDebugOutputLevel=Module.cwrap("PhotonPeerSetDebugOutputLevel","number",["number","number"]);d.OpCustom=Module.cwrap("PhotonPeerOpCustom","number",["number","number","number","number","number"]);d.OperationRequestCreate=Module.cwrap("PhotonOperationRequestCreate","number",
["number"]);d.OperationRequestDestroy=Module.cwrap("PhotonOperationRequestDestroy",null,["number"]);d.OperationRequestSetParam=Module.cwrap("PhotonOperationRequestSetParam",null,["number","number","number"]);d.FetchServerTimestamp=Module.cwrap("PhotonPeerFetchServerTimestamp",null,["number"]);d.GetServerTime=Module.cwrap("PhotonPeerGetServerTime","number",["number"]);d.GetRoundTripTime=Module.cwrap("PhotonPeerGetRoundTripTime","number",["number"])})(b.EmPhotonPeerLib||(b.EmPhotonPeerLib={}));(function(d){function m(k){var n=
k.length*k.BYTES_PER_ELEMENT,p=_malloc(n);(new Uint8Array(Module.HEAPU8.buffer,p,n)).set(new Uint8Array(k.buffer));return p}var l;(function(k){k.BYTE=98;k.SHORT=107;k.INTEGER=105;k.LONG=108;k.FLOAT=102;k.DOUBLE=100;k.BOOLEAN=111;k.STRING=115;k.HASHTABLE=104;k.DICTIONARY=68;k.OBJECT=122;k.ARRAY=121;k.BYTEARRAY=120;k.PHOTON_COMMAND=112;k.EG_NULL=42;k.CUSTOM=99;k.UNKNOWN=0})(l=b.EmTypesLib.TypeCode||(b.EmTypesLib.TypeCode={}));d.UTF8ToString=Module.UTF8ToString;d.stringToUTF8=Module.stringToUTF8;d.Byte=
Module.cwrap("PhotonTypesByte","number",["number"]);d.Short=Module.cwrap("PhotonTypesShort","number",["number"]);d.Int=Module.cwrap("PhotonTypesInt","number",["number"]);d.Long=Module.cwrap("PhotonTypesLong","number",["number","number"]);d.Float=Module.cwrap("PhotonTypesFloat","number",["number"]);d.Double=Module.cwrap("PhotonTypesDouble","number",["number"]);d.String=Module.cwrap("PhotonTypesString","number",["string"]);d.Bool=Module.cwrap("PhotonTypesBool","number",["number"]);d.Table=Module.cwrap("PhotonTypesTable",
"number");d.DictBase=Module.cwrap("PhotonTypesDictBase","number",["number","number"]);d.DictBaseFromDict=Module.cwrap("PhotonTypesDictBaseFromDict","number",["number"]);d.Dict=Module.cwrap("PhotonTypesDict","number",["number"]);d.ToTypedArray=function(k,n,p){k=b.EmTypesLib.ArrayDataAddress(k,n);k=new Uint8Array(Module.HEAPU8.buffer,k,p.length*p.BYTES_PER_ELEMENT);(new Uint8Array(p.buffer,p.byteOffset)).set(k);return p};d.TypedArray=function(k,n){var p=n.length*n.BYTES_PER_ELEMENT,q=_malloc(p);(new Uint8Array(Module.HEAPU8.buffer,
q,p)).set(new Uint8Array(n.buffer));return q?(k=Module.ccall("PhotonTypesArray","number",["number","number","number"],[k,q,n.length]),_free(q),k):0};d.Array=function(k,n){var p=0,q=[];switch(k){case l.BYTE:p=m(new Int8Array(n));break;case l.SHORT:p=m(new Int16Array(n));break;case l.INTEGER:p=m(new Int32Array(n));break;case l.LONG:throw Error("TypeExt.Long Arrays are not supported, use BigInt64Array");case l.FLOAT:p=m(new Float32Array(n));break;case l.DOUBLE:p=m(new Float64Array(n));break;case l.STRING:p=
_malloc(4*n.length);q.push(p);for(var h=0;h<n.length;h++){var e=Module.lengthBytesUTF8(n[h]),f=_malloc(e+1);q.push(f);Module.stringToUTF8(n[h],f,e+1);Module.setValue(p+4*h,f,"*")}break;case l.BOOLEAN:p=_malloc(n.length);q.push(p);for(h=0;h<n.length;h++)Module.setValue(p+h,n[h],"i8");break;case l.OBJECT:for(p=_malloc(4*n.length),q.push(p),h=0;h<n.length;h++)Module.setValue(p+4*h,n[h],"*")}if(p){k=Module.ccall("PhotonTypesArray","number",["number","number","number"],[k,p,k==l.LONG?n.length/2:n.length]);
for(h=0;h<q.length;h++)_free(q[h]);return k}return 0};d.Destroy=Module.cwrap("PhotonTypesDestroy",null,["number"]);d.GetType=Module.cwrap("PhotonTypesGetType","number",["number"]);d.GetByte=Module.cwrap("PhotonTypesGetByte","number",["number"]);d.GetShort=Module.cwrap("PhotonTypesGetShort","number",["number"]);d.GetInt=Module.cwrap("PhotonTypesGetInt","number",["number"]);d.GetLongLow=Module.cwrap("PhotonTypesGetLongLow","number",["number"]);d.GetLongHigh=Module.cwrap("PhotonTypesGetLongHigh","number",
["number"]);d.GetFloat=Module.cwrap("PhotonTypesGetFloat","number",["number"]);d.GetDouble=Module.cwrap("PhotonTypesGetDouble","number",["number"]);d.GetString=function(k){k=Module.ccall("PhotonTypesGetString","number",["number"],[k]);return UTF32ToString(k)};d.GetBool=function(k){return 0!=Module.ccall("PhotonTypesGetBool","number",["number"],[k])};d.GetTable=Module.cwrap("PhotonTypesGetTable","number",["number"]);d.TableSize=Module.cwrap("PhotonTypesTableSize","number",["number"]);d.TablePut=Module.cwrap("PhotonTypesTablePut",
null,["number","number","number"]);d.TablePutNull=Module.cwrap("PhotonTypesTablePutNull",null,["number","number"]);d.TableKeyAt=Module.cwrap("PhotonTypesTableKeyAt","number",["number","number"]);d.TableValueAt=Module.cwrap("PhotonTypesTableValueAt","number",["number","number"]);d.DictSize=Module.cwrap("PhotonTypesDictSize","number",["number"]);d.DictBasePut=Module.cwrap("PhotonTypesDictBasePut",null,["number","number","number"]);d.DictKeyAt=Module.cwrap("PhotonTypesDictKeyAt","number",["number","number"]);
d.DictValueAt=Module.cwrap("PhotonTypesDictValueAt","number",["number","number"]);d.ByteDictSize=Module.cwrap("PhotonTypesByteDictSize","number",["number"]);d.ByteDictPut=Module.cwrap("PhotonTypesByteDictPut",null,["number","number","number"]);d.ByteDictKeyAt=Module.cwrap("PhotonTypesByteDictKeyAt","number",["number","number"]);d.ByteDictValueAt=Module.cwrap("PhotonTypesByteDictValueAt","number",["number","number"]);d.IsArray=function(k){return 0!=Module.ccall("PhotonTypesIsArray","number",["number"],
[k])};d.ArraySize=Module.cwrap("PhotonTypesArraySize","number",["number"]);d.ArrayDataAddress=Module.cwrap("PhotonTypesArrayDataAddress","number",["number","number"]);d.StringAt=function(k,n){k=Module.ccall("PhotonTypesStringAt","number",["number","number"],[k,n]);return UTF32ToString(k)};d.BoolAt=function(k,n){return 0!=Module.ccall("PhotonTypesBoolAt","number",["number","number"],[k,n])};d.TableAt=Module.cwrap("PhotonTypesTableAt","number",["number","number"]);d.ObjectAt=Module.cwrap("PhotonTypesObjectAt",
"number",["number","number"])})(b.EmTypesLib||(b.EmTypesLib={}))}(Photon||(Photon={}))}}(Module.onRuntimeInitialized);Module=Module||{};Module.onRuntimeInitialized=function(a){return function(){a&&a();Photon.isLoaded=!0;Photon.onLoad&&Photon.onLoad()}}(Module.onRuntimeInitialized);
var __extends=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,m){d.__proto__=m}||function(d,m){for(var l in m)Object.prototype.hasOwnProperty.call(m,l)&&(d[l]=m[l])};return a(b,c)};return function(b,c){function d(){this.constructor=b}if("function"!==typeof c&&null!==c)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}();
(function(a){var b;(function(d){d[d.OFF=0]="OFF";d[d.ERROR=1]="ERROR";d[d.WARN=2]="WARN";d[d.INFO=3]="INFO";d[d.DEBUG=4]="DEBUG"})(b=a.LogLevel||(a.LogLevel={}));var c=function(){function d(m,l){void 0===m&&(m="");void 0===l&&(l=b.INFO);this.prefix=m;this.level=l}d.prototype.setPrefix=function(m){this.prefix=m};d.prototype.getPrefix=function(){return this.prefix};d.prototype.setLevel=function(m){m=Math.max(m,b.OFF);this.level=m=Math.min(m,b.DEBUG)};d.setExceptionHandler=function(m){this.exceptionHandler=
m};d.prototype.isLevelEnabled=function(m){return m<=this.level};d.prototype.getLevel=function(){return this.level};d.prototype.debug=function(m){for(var l=[],k=1;k<arguments.length;k++)l[k-1]=arguments[k];this.log(b.DEBUG,m,l)};d.prototype.info=function(m){for(var l=[],k=1;k<arguments.length;k++)l[k-1]=arguments[k];this.log(b.INFO,m,l)};d.prototype.warn=function(m){for(var l=[],k=1;k<arguments.length;k++)l[k-1]=arguments[k];this.log(b.WARN,m,l)};d.prototype.error=function(m){for(var l=[],k=1;k<arguments.length;k++)l[k-
1]=arguments[k];this.log(b.ERROR,m,l)};d.prototype.exception=function(m,l){for(var k=[],n=2;n<arguments.length;n++)k[n-2]=arguments[n];if(!d.exceptionHandler||!d.exceptionHandler(m,this.format0(l,k)))throw Error(this.format0("["+m+"] "+l,k));};d.prototype.format=function(m){for(var l=[],k=1;k<arguments.length;k++)l[k-1]=arguments[k];return this.format0(m,l)};d.prototype.formatArr=function(m,l){return this.format0(m,l)};d.prototype.log=function(m,l,k){if(m<=this.level&&"undefined"!==typeof console&&
void 0!==l)try{var n;(n=console.hasOwnProperty(d.log_types[m])?console[d.log_types[m]]:console.log)&&n.apply(console,[this.prefix,l].concat(k))}catch(p){}};d.prototype.format0=function(m,l){return(""==this.prefix?"":this.prefix+" ")+m+" "+l.map(function(k){if(void 0!==k)switch(typeof k){case "object":try{return JSON.stringify(k)}catch(n){return k.toString()+"("+n+")"}default:return k.toString()}}).join(" ")};d.log_types=["error","error","warn","info","debug"];return d}();a.Logger=c;c=function(){function d(){}
d.isArray=function(m){return"[object Array]"===Object.prototype.toString.call(m)};d.getPropertyOrElse=function(m,l,k){return m.hasOwnProperty(l)?m[l]:k};return d}();a.Util=c})(Photon||(Photon={}));
(function(a){a.IsEmscriptenBuildInternal=!0;var b;(function(n){n[n.BYTE=98]="BYTE";n[n.SHORT=107]="SHORT";n[n.INTEGER=105]="INTEGER";n[n.LONG=108]="LONG";n[n.FLOAT=102]="FLOAT";n[n.DOUBLE=100]="DOUBLE";n[n.BOOLEAN=111]="BOOLEAN";n[n.STRING=115]="STRING";n[n.HASHTABLE=104]="HASHTABLE";n[n.DICTIONARY=68]="DICTIONARY";n[n.OBJECT=122]="OBJECT";n[n.ARRAY=121]="ARRAY";n[n.BYTEARRAY=120]="BYTEARRAY";n[n.PHOTON_COMMAND=112]="PHOTON_COMMAND";n[n.EG_NULL=42]="EG_NULL";n[n.CUSTOM=99]="CUSTOM";n[n.UNKNOWN=0]=
"UNKNOWN"})(b||(b={}));var c;(function(n){n[n.None=0]="None";n[n.Byte=1]="Byte";n[n.Short=2]="Short";n[n.Int=3]="Int";n[n.Long=4]="Long";n[n.Float=5]="Float";n[n.Double=6]="Double";n[n.String=7]="String";n[n.Bool=8]="Bool";n[n.Table=9]="Table";n[n.Dict=10]="Dict";n[n.Object=11]="Object"})(c=a.TypeExtType||(a.TypeExtType={}));var d=function(){function n(p,q,h,e,f){void 0===h&&(h=0);this.type=p;this.value=q;this.longHiBytes=h;this.keyType=e;this.valType=f}n.prototype.ToJS=function(){return this.type==
c.Long?this:this.value};n.prototype.GetTypedKeyTable=function(){return this.typedKeyTable};return n}(),m=function(){return function(n,p){void 0===p&&(p=-1);this.ptr=n;this.arrIdx=p}}(),l=function(){function n(p){this.base=p}n.prototype.Size=function(){return a.EmTypesLib.DictSize(this.base)};n.prototype.KeyAt=function(p){return k.native2js(a.EmTypesLib.DictKeyAt(this.base,p))};n.prototype.ValueAt=function(p){return k.native2js(a.EmTypesLib.DictValueAt(this.base,p))};return n}();a.NativeDictBase=l;
var k=function(){function n(){}n.Is=function(p){return p instanceof d};n.Byte=function(p){return new d(c.Byte,p)};n.Short=function(p){return new d(c.Short,p)};n.Int=function(p){return new d(c.Int,p)};n.Float=function(p){return new d(c.Float,p)};n.Double=function(p){return new d(c.Double,p)};n.Long=function(p,q){void 0===q&&(q=0);if(Array.isArray(p))throw Error("TypeExt.Long Arrays are not supported, use BigInt64Array");return new d(c.Long,p,q)};n.String=function(p){return new d(c.String,p)};n.Bool=
function(p){return new d(c.Bool,p)};n.Dict=function(p,q,h){return new d(c.Dict,h,0,p,q)};n.GetDict=function(p,q,h){h=a.EmTypesLib.DictBaseFromDict(n.type2typeCode(p),n.type2typeCode(q),h.ptr);0==h&&this.logger.exception(301,"GetDict: Unsupported dictionary key/value types",c[p]+"("+p+")/"+c[q]+"("+q+")");return new l(h)};n.TableTypedKeys=function(){return new d(c.Table,{})};n.DictTypedKeys=function(p,q){return new d(c.Dict,{},0,p,q)};n.PutTypedKey=function(p,q,h){p.value||(p.value={});p.typedKeyTable||
(p.typedKeyTable=[]);p.value[q.value]=h;p.typedKeyTable.push(q,h)};n.type2typeCode=function(p){switch(p){case c.Byte:return b.BYTE;case c.Short:return b.SHORT;case c.Int:return b.INTEGER;case c.Long:return b.LONG;case c.Float:return b.FLOAT;case c.Double:return b.DOUBLE;case c.String:return b.STRING;case c.Bool:return b.BOOLEAN;case c.Dict:return b.DICTIONARY;case c.Object:return b.OBJECT;default:return b.UNKNOWN}};n.js2native=function(p,q){if(void 0!==q){if(null===q)return null;q=n.js2native0(p,
q);0!=q&&p.push(q);return q}};n.js2native0=function(p,q){if(q instanceof d){if(Array.isArray(q.value)){var h=q.value;p=n.type2typeCode(q.type);return a.EmTypesLib.Array(p,h)}switch(q.type){case c.Byte:return a.EmTypesLib.Byte(q.value);case c.Short:return a.EmTypesLib.Short(q.value);case c.Int:return a.EmTypesLib.Int(q.value);case c.Long:return a.EmTypesLib.Long(q.value,q.longHiBytes);case c.Float:return a.EmTypesLib.Float(q.value);case c.Double:return a.EmTypesLib.Double(q.value);case c.String:return a.EmTypesLib.String(q.value);
case c.Bool:return a.EmTypesLib.Bool(q.value);case c.Table:h=a.EmTypesLib.Table();var e=q.GetTypedKeyTable();if(e)for(q=0;q<e.length;q+=2)null===e[q+1]?a.EmTypesLib.TablePutNull(h,n.js2native(p,e[q])):a.EmTypesLib.TablePut(h,n.js2native(p,e[q]),n.js2native(p,e[q+1]));return h;case c.Dict:h=a.EmTypesLib.DictBase(n.type2typeCode(q.keyType),n.type2typeCode(q.valType));0==h&&this.logger.exception(302,"js2native0: Unsupported dictionary key/value types",c[q.keyType]+"("+q.keyType+")/"+c[q.valType]+"("+
q.valType+")");if(e=q.GetTypedKeyTable())for(q=0;q<e.length;q+=2)a.EmTypesLib.DictBasePut(h,n.js2native(p,e[q]),n.js2native(p,e[q+1]));else for(var f in q.value){e=new d(q.keyType,f);var g=q.value[f];a.EmTypesLib.DictBasePut(h,n.js2native(p,e),n.js2native(p,g))}return a.EmTypesLib.Dict(h);default:n.logger.exception(303,"js2native: unsupported data type "+q.type+" for value ",q)}}else{if(Array.isArray(q)){h=q;f=[];for(q=0;q<h.length;q++)f.push(n.js2native(p,h[q]));return a.EmTypesLib.Array(b.OBJECT,
f)}if(q instanceof Int8Array||q instanceof Uint8Array)return a.EmTypesLib.TypedArray(b.BYTE,q);if(q instanceof Int16Array||q instanceof Uint16Array)return a.EmTypesLib.TypedArray(b.SHORT,q);if(q instanceof Int32Array||q instanceof Uint32Array)return a.EmTypesLib.TypedArray(b.INTEGER,q);if(q instanceof BigInt64Array||q instanceof BigUint64Array)return a.EmTypesLib.TypedArray(b.LONG,q);if(q instanceof Float32Array)return a.EmTypesLib.TypedArray(b.FLOAT,q);if(q instanceof Float64Array)return a.EmTypesLib.TypedArray(b.DOUBLE,
q);if("number"==typeof q)return a.EmTypesLib.Double(q);if("string"==typeof q)return a.EmTypesLib.String(q);if("boolean"==typeof q)return a.EmTypesLib.Bool(q);if("object"==typeof q){h=a.EmTypesLib.Table();for(f in q)null===q[f]?a.EmTypesLib.TablePutNull(h,n.js2native(p,f)):a.EmTypesLib.TablePut(h,n.js2native(p,f),n.js2native(p,q[f]));return h}n.logger.exception(304,"js2native: unsupported data type for value:",q)}return 0};n.native2js=function(p){var q=a.EmTypesLib.GetType(p);if(a.EmTypesLib.IsArray(p)){var h=
a.EmTypesLib.ArraySize(p);if(q==b.BYTE)return a.EmTypesLib.ToTypedArray(q,p,new Uint8Array(h));if(q==b.SHORT)return a.EmTypesLib.ToTypedArray(q,p,new Int16Array(h));if(q==b.INTEGER)return a.EmTypesLib.ToTypedArray(q,p,new Int32Array(h));if(q==b.LONG)return a.EmTypesLib.ToTypedArray(q,p,new BigInt64Array(h));if(q==b.FLOAT)return a.EmTypesLib.ToTypedArray(q,p,new Float32Array(h));if(q==b.DOUBLE)return a.EmTypesLib.ToTypedArray(q,p,new Float64Array(h));for(var e=[],f=0;f<h;f++)switch(q){case b.STRING:e[f]=
a.EmTypesLib.StringAt(p,f);break;case b.BOOLEAN:e[f]=a.EmTypesLib.BoolAt(p,f);break;case b.HASHTABLE:e[f]=n.native2js(a.EmTypesLib.TableAt(p,f));break;case b.DICTIONARY:e[f]=new m(p,f);break;case b.OBJECT:e[f]=n.native2js(a.EmTypesLib.ObjectAt(p,f));break;default:this.logger.exception(305,"native2js: Unsupported data type ",q," for value ",p)}return e}switch(q){case b.BYTE:return a.EmTypesLib.GetByte(p);case b.SHORT:return a.EmTypesLib.GetShort(p);case b.INTEGER:return a.EmTypesLib.GetInt(p);case b.LONG:return n.Long(a.EmTypesLib.GetLongLow(p),
a.EmTypesLib.GetLongHigh(p));case b.FLOAT:return a.EmTypesLib.GetFloat(p);case b.DOUBLE:return a.EmTypesLib.GetDouble(p);case b.STRING:return a.EmTypesLib.GetString(p);case b.BOOLEAN:return a.EmTypesLib.GetBool(p);case b.HASHTABLE:q=a.EmTypesLib.GetTable(p);p={};for(f=0;f<a.EmTypesLib.TableSize(q);f++)p[this.native2js(a.EmTypesLib.TableKeyAt(q,f))]=this.native2js(a.EmTypesLib.TableValueAt(q,f));return p;case b.DICTIONARY:return new m(p);case b.EG_NULL:return null;default:this.logger.exception(306,
"native2js: Unsupported data type:",q)}};n.logger=new a.Logger("TypeExt");return n}();a.TypeExt=k})(Photon||(Photon={}));
(function(a){var b;a.setOnLoad=function(l){a.isLoaded?l():a.onLoad=l};var c;(function(l){l[l.EXCEPTION_ON_CONNECT=1023]="EXCEPTION_ON_CONNECT";l[l.CONNECT=1024]="CONNECT";l[l.DISCONNECT=1025]="DISCONNECT";l[l.EXCEPTION=1026]="EXCEPTION";l[l.QUEUE_OUTGOING_RELIABLE_WARNING=1027]="QUEUE_OUTGOING_RELIABLE_WARNING";l[l.QUEUE_OUTGOING_UNRELIABLE_WARNING=1029]="QUEUE_OUTGOING_UNRELIABLE_WARNING";l[l.SEND_ERROR=1030]="SEND_ERROR";l[l.QUEUE_OUTGOING_ACKS_WARNING=1031]="QUEUE_OUTGOING_ACKS_WARNING";l[l.QUEUE_INCOMING_RELIABLE_WARNING=
1033]="QUEUE_INCOMING_RELIABLE_WARNING";l[l.QUEUE_INCOMING_UNRELIABLE_WARNING=1035]="QUEUE_INCOMING_UNRELIABLE_WARNING";l[l.QUEUE_SENT_WARNING=1037]="QUEUE_SENT_WARNING";l[l.INTERNAL_RECEIVE_EXCEPTION=1039]="INTERNAL_RECEIVE_EXCEPTION";l[l.TIMEOUT_DISCONNECT=1040]="TIMEOUT_DISCONNECT";l[l.DISCONNECT_BY_SERVER=1041]="DISCONNECT_BY_SERVER";l[l.DISCONNECT_BY_SERVER_USER_LIMIT=1042]="DISCONNECT_BY_SERVER_USER_LIMIT";l[l.DISCONNECT_BY_SERVER_LOGIC=1043]="DISCONNECT_BY_SERVER_LOGIC";l[l.ENCRYPTION_ESTABLISHED=
1048]="ENCRYPTION_ESTABLISHED";l[l.ENCRYPTION_FAILED_TO_ESTABLISH=1049]="ENCRYPTION_FAILED_TO_ESTABLISH"})(c||(c={}));var d;(function(l){l[l.DISCONNECTED=0]="DISCONNECTED";l[l.CONNECTING=1]="CONNECTING";l[l.INITIALIZING_APPLICATION=2]="INITIALIZING_APPLICATION";l[l.CONNECTED=3]="CONNECTED";l[l.DISCONNECTING=4]="DISCONNECTING"})(d||(d={}));(function(l){l[l.Ws=0]="Ws";l[l.Wss=1]="Wss"})(a.ConnectionProtocol||(a.ConnectionProtocol={}));var m=function(){function l(k,n,p,q){void 0===p&&(p="");void 0===
q&&(q="");this.protocol=k;this.address=n;this.subprotocol=p;this.closed=!1;this._peerStatusListeners={};this._eventListeners={};this._responseListeners={};this.lastRtt=0;this.initTimestamp=Date.now();this.peer=a.EmPhotonPeerLib.Create(k==a.ConnectionProtocol.Wss,this.onStatusChangedFunc(),this.onOpResponseFunc(),this.onEventFunc(),this.debugReturnFunc());this._logger=new a.Logger(q&&""!=q?q+":":"")}l.prototype.Destroy=function(){this.timer&&clearInterval(this.timer);a.EmPhotonPeerLib.Destroy(this.peer)};
l.prototype.isConnecting=function(){return a.EmPhotonPeerLib.State(this.peer)==d.CONNECTING};l.prototype.getRtt=function(){return a.EmPhotonPeerLib.GetRoundTripTime(this.peer)};l.prototype.getServerTimeMs=function(){return a.EmPhotonPeerLib.GetServerTime(this.peer)};l.prototype.ping=function(k){void 0===k&&(k=!1);k&&a.EmPhotonPeerLib.FetchServerTimestamp(this.peer)};l.prototype.isConnected=function(){return a.EmPhotonPeerLib.State(this.peer)==d.CONNECTED};l.prototype.isClosing=function(){return a.EmPhotonPeerLib.State(this.peer)==
d.DISCONNECTING};l.prototype.connect=function(k){a.EmPhotonPeerLib.Connect(this.peer,this.address,k);this.startService()};l.prototype.startService=function(){var k=this.peer,n=this;this.timer&&clearInterval(this.timer);this.timer=setInterval(function(){n.closed||a.EmPhotonPeerLib.Service(k)},l.serviceIntervalMs)};l.prototype.disconnect=function(){a.EmPhotonPeerLib.Disconnect(this.peer)};l.prototype.sendOperation=function(k,n,p,q){void 0===p&&(p=!1);void 0===q&&(q=0);a.Util.isArray(n)||(void 0===n?
n=[]:this._logger.exception(201,"PhotonPeer[sendOperation] - Trying to send non array data:",n));for(var h=[],e=a.EmPhotonPeerLib.OperationRequestCreate(k),f=0;f<n.length;f+=2){var g=a.TypeExt.js2native(h,n[f+1]);void 0!=g&&a.EmPhotonPeerLib.OperationRequestSetParam(e,n[f],g)}for(f=0;f<h.length;f++)a.EmTypesLib.Destroy(h[f]);a.EmPhotonPeerLib.OpCustom(this.peer,e,p,q,!1);a.EmPhotonPeerLib.OperationRequestDestroy(e);this._logger.debug("PhotonPeer[sendOperation] - Sending request:",k)};l.prototype.addPeerStatusListener=
function(k,n){this._addListener(this._peerStatusListeners,k,n)};l.prototype.addEventListener=function(k,n){this._addListener(this._eventListeners,k.toString(),n)};l.prototype.addResponseListener=function(k,n){this._addListener(this._responseListeners,k.toString(),n)};l.prototype.removePeerStatusListener=function(k,n){this._removeListener(this._peerStatusListeners,k,n)};l.prototype.removeEventListener=function(k,n){this._removeListener(this._eventListeners,k.toString(),n)};l.prototype.removeResponseListener=
function(k,n){this._removeListener(this._responseListeners,k.toString(),n)};l.prototype.removePeerStatusListenersForCode=function(k){this._removeListenersForCode(this._peerStatusListeners,k)};l.prototype.removeEventListenersForCode=function(k){this._removeListenersForCode(this._eventListeners,k.toString())};l.prototype.removeResponseListenersForCode=function(k){this._removeListenersForCode(this._responseListeners,k.toString())};l.prototype.setLogLevel=function(k){var n;this._logger.setLevel(k);k=
(n={},n[a.LogLevel.DEBUG]=4,n[a.LogLevel.INFO]=3,n[a.LogLevel.WARN]=2,n[a.LogLevel.ERROR]=1,n[a.LogLevel.OFF]=0,n)[k];void 0!=k&&a.EmPhotonPeerLib.SetDebugOutputLevel(this.peer,k)};l.prototype.onUnhandledEvent=function(k,n){this._logger.warn("PhotonPeer: No handler for event",k,"registered.")};l.prototype.onUnhandledResponse=function(k,n){this._logger.warn("PhotonPeer: No handler for response",k,"registered.")};l.prototype._dispatchEvent=function(k,n,p){if(!(p&&this.onEventNative&&this.onEventNative(k,
p)||this._dispatch(this._eventListeners,k.toString(),n,"event")))this.onUnhandledEvent(k,n)};l.prototype._dispatchResponse=function(k,n){if(!this._dispatch(this._responseListeners,k.toString(),n,"response"))this.onUnhandledResponse(k,n)};l.prototype.nativeByteDict2js=function(k){for(var n={},p=0;p<a.EmTypesLib.ByteDictSize(k);p++)n[a.EmTypesLib.ByteDictKeyAt(k,p)]=a.TypeExt.native2js(a.EmTypesLib.ByteDictValueAt(k,p));return n};l.prototype.debugReturnFunc=function(){var k=this;return function(n,p){p=
a.EmTypesLib.UTF8ToString(p);switch(n){case 1:k._logger.error(p);break;case 2:k._logger.warn(p);break;case 3:k._logger.info(p);break;case 4:k._logger.debug(p);break;default:k._logger.info("[unknown log level "+n+"]"+p)}}};l.prototype.onEventFunc=function(){var k=this;return function(n,p){k._dispatchEvent(n,{vals:k.nativeByteDict2js(p)},p)}};l.prototype.onOpResponseFunc=function(){var k=this;return function(n,p,q,h){k._dispatchResponse(q,{errCode:n,errMsg:a.EmTypesLib.UTF8ToString(p),vals:k.nativeByteDict2js(h)})}};
l.prototype.onStatusChangedFunc=function(){var k=this;return function(n){var p=l.StatusCodeEmToJs[n];k._logger.debug("PhotonPeer onStatusChangedFunc",n,"->",p);p&&k._dispatchPeerStatus(p)}};l.prototype._addListener=function(k,n,p){n in k||(k[n]=[]);p&&"function"===typeof p?(this._logger.debug("PhotonPeer[_addListener] - Adding listener for event",n),k[n].push(p)):this._logger.error("PhotonPeer[_addListener] - Listener",n,"is not a function but of type",typeof p,". No listener added!");return this};
l.prototype._dispatch=function(k,n,p,q){if(n in k){k=k[n];n=0;for(q=k.length;n<q;n++)a.Util.isArray(p)||(p=[p]),k[n].apply(this,void 0===p?[]:p);return!0}return!1};l.prototype._dispatchPeerStatus=function(k){this._dispatch(this._peerStatusListeners,k,void 0,"peerStatus")||this._logger.warn("PhotonPeer[_dispatchPeerStatus] - No handler for ",k,"registered.")};l.prototype._removeListener=function(k,n,p){if(n in k){var q=k[n].length;k[n]=k[n].filter(function(h){return h!=p});this._logger.debug("PhotonPeer[_removeListener] - Removing listener for event",
n,"removed:",q-k[n].length)}return this};l.prototype._removeListenersForCode=function(k,n){this._logger.debug("PhotonPeer[_removeListenersForCode] - Removing all listeners for event",n);n in k&&(k[n]=[]);return this};l.serviceIntervalMs=20;l.StatusCodes={connecting:"connecting",connect:"connect",connectFailed:"connectFailed",disconnect:"disconnect",connectClosed:"connectClosed",error:"error",timeout:"timeout"};l.StatusCodeEmToJs=(b={},b[c.EXCEPTION_ON_CONNECT]=l.StatusCodes.connectFailed,b[c.CONNECT]=
l.StatusCodes.connect,b[c.DISCONNECT]=l.StatusCodes.disconnect,b[c.EXCEPTION]=l.StatusCodes.error,b[c.QUEUE_OUTGOING_RELIABLE_WARNING]=l.StatusCodes.connectFailed,b[c.QUEUE_OUTGOING_UNRELIABLE_WARNING]=l.StatusCodes.connectFailed,b[c.SEND_ERROR]=l.StatusCodes.error,b[c.INTERNAL_RECEIVE_EXCEPTION]=l.StatusCodes.error,b[c.TIMEOUT_DISCONNECT]=l.StatusCodes.timeout,b[c.DISCONNECT_BY_SERVER]=l.StatusCodes.connectClosed,b[c.DISCONNECT_BY_SERVER_USER_LIMIT]=l.StatusCodes.connectClosed,b[c.DISCONNECT_BY_SERVER_LOGIC]=
l.StatusCodes.connectClosed,b[c.ENCRYPTION_FAILED_TO_ESTABLISH]=l.StatusCodes.error,b);return l}();a.PhotonPeer=m})(Photon||(Photon={}));
(function(a){(function(b){var c,d=function(){function h(e,f,g){this.name=e;this.actorNr=f;this.isLocal=g;this.userId="";this.customProperties={};this.suspended=!1}h.prototype.getRoom=function(){return this.loadBalancingClient?this.loadBalancingClient.myRoom():null};h.prototype.raiseEvent=function(e,f,g){this.loadBalancingClient&&this.loadBalancingClient.raiseEvent(e,f,g)};h.prototype.setProp=function(e,f,g){void 0===g&&(g=void 0);if(this.loadBalancingClient&&this.loadBalancingClient.isJoinedToRoom()){var t=
a.TypeExt.TableTypedKeys();a.TypeExt.PutTypedKey(t,a.TypeExt.Byte(e),f);if(void 0!==g){var r=a.TypeExt.TableTypedKeys();a.TypeExt.PutTypedKey(r,a.TypeExt.Byte(e),g)}this.loadBalancingClient._setPropertiesOfActor(this.actorNr,t,!1,r);return void 0===g}return!0};h.prototype.setName=function(e){this.name!=e&&this.setProp(b.Constants.ActorProperties.PlayerName,e)&&(this.name=e)};h.prototype.onPropertiesChange=function(e,f){};h.prototype.getCustomProperty=function(e){return this.customProperties[e]};h.prototype.getCustomPropertyOrElse=
function(e,f){return a.Util.getPropertyOrElse(this.customProperties,e,f)};h.prototype.setCustomProperty=function(e,f,g,t){var r;void 0===g&&(g=!1);var u={};u[e]=f;var v;void 0!==t&&(v=(r={},r[e]=t,r));(r=this.loadBalancingClient&&this.loadBalancingClient.isJoinedToRoom())&&this.loadBalancingClient&&this.loadBalancingClient._setPropertiesOfActor(this.actorNr,u,g,v);r&&void 0!==t||(this.customProperties[e]=f,this.onPropertiesChange(u,!0))};h.prototype.setCustomProperties=function(e,f,g){void 0===f&&
(f=!1);var t=this.loadBalancingClient&&this.loadBalancingClient.isJoinedToRoom();t&&this.loadBalancingClient&&this.loadBalancingClient._setPropertiesOfActor(this.actorNr,e,f,g);if(!t||void 0===g){for(var r in e)this.customProperties[r]=e[r];this.onPropertiesChange(e,!0)}};h.prototype.isSuspended=function(){return this.suspended};h.prototype._getAllProperties=function(){var e={};e[b.Constants.ActorProperties.PlayerName]=this.name;for(var f in this.customProperties)e[f]=this.customProperties[f];return e};
h.prototype._setLBC=function(e){this.loadBalancingClient=e};h.prototype.getCustomProperties=function(){var e={},f;for(f in this.customProperties)e[f]=this.customProperties[f];return e};h.prototype._updateFromResponse=function(e){this.actorNr=e[b.Constants.ParameterCode.ActorNr];e=e[b.Constants.ParameterCode.PlayerProperties];if(void 0!==e){var f=e[b.Constants.ActorProperties.PlayerName];void 0!==f&&(this.name=f);f=e[b.Constants.ActorProperties.UserId];void 0!==f&&(this.userId=f);this._updateFromProps(e)}};
h.prototype._updateMyActorFromResponse=function(e){this.actorNr=e[b.Constants.ParameterCode.ActorNr]};h.prototype.updateIfExists=function(e,f,g){return g.hasOwnProperty(f)?g[f]:e};h.prototype._updateFromProps=function(e){if(e){this.name=this.updateIfExists(this.name,b.Constants.ActorProperties.PlayerName,e);var f={},g;for(g in e)parseInt(g).toString()!=g&&this.customProperties[g]!==e[g]&&(this.customProperties[g]=e[g],f[g]=e[g]);this.onPropertiesChange(f,!1)}};h.prototype._setSuspended=function(e){this.suspended=
e};h._getActorNrFromResponse=function(e){return e[b.Constants.ParameterCode.ActorNr]};return h}();b.Actor=d;var m=function(){function h(e){this.address=this.name="";this.maxPlayers=0;this.isOpen=this.isVisible=!0;this.suspendedPlayerLiveTime=this.playerTTL=this.emptyRoomLiveTime=this.roomTTL=this.playerCount=0;this.cleanupCacheOnLeave=this.removed=!1;this.masterClientId=0;this._customProperties={};this._propsListedInLobby=[];this.name=e}h.prototype.getCustomProperties=function(){var e={},f;for(f in this._customProperties)e[f]=
this._customProperties[f];return e};h.prototype.getPropsListedInLobby=function(){for(var e=[],f=0;f<this._propsListedInLobby.length;f++)e[f]=this._propsListedInLobby[f];return e};h.prototype.onPropertiesChange=function(e,f){};h.prototype.getCustomProperty=function(e){return this._customProperties[e]};h.prototype.getCustomPropertyOrElse=function(e,f){return a.Util.getPropertyOrElse(this._customProperties,e,f)};h.prototype._updateFromMasterResponse=function(e){this.address=e[b.Constants.ParameterCode.Address];
if(e=e[b.Constants.ParameterCode.RoomName])this.name=e};h.prototype._updateFromProps=function(e){if(e){this.maxPlayers=this.updateIfExists(this.maxPlayers,b.Constants.GameProperties.MaxPlayers,e);this.isVisible=this.updateIfExists(this.isVisible,b.Constants.GameProperties.IsVisible,e);this.isOpen=this.updateIfExists(this.isOpen,b.Constants.GameProperties.IsOpen,e);this.playerCount=this.updateIfExists(this.playerCount,b.Constants.GameProperties.PlayerCount,e);this.removed=this.updateIfExists(this.removed,
b.Constants.GameProperties.Removed,e);this._propsListedInLobby=this.updateIfExists(this._propsListedInLobby,b.Constants.GameProperties.PropsListedInLobby,e);this.cleanupCacheOnLeave=this.updateIfExists(this.cleanupCacheOnLeave,b.Constants.GameProperties.CleanupCacheOnLeave,e);this.masterClientId=this.updateIfExists(this.masterClientId,b.Constants.GameProperties.MasterClientId,e);this.roomTTL=this.emptyRoomLiveTime=this.updateIfExists(this.roomTTL,b.Constants.GameProperties.RoomTTL,e);this.playerTTL=
this.suspendedPlayerLiveTime=this.updateIfExists(this.playerTTL,b.Constants.GameProperties.PlayerTTL,e);this.expectedUsers=this.updateIfExists(this.expectedUsers,b.Constants.GameProperties.ExpectedUsers,e);var f={},g;for(g in e)parseInt(g).toString()!=g&&this._customProperties[g]!==e[g]&&(this._customProperties[g]=e[g],f[g]=e[g]);this.onPropertiesChange(f,!1)}};h.prototype._updateFromEvent=function(e){e&&(this.masterClientId=this.updateIfExists(this.masterClientId,b.Constants.ParameterCode.MasterClientId,
e))};h.prototype.updateIfExists=function(e,f,g){return g.hasOwnProperty(f)?g[f]:e};return h}();b.RoomInfo=m;var l=function(h){function e(f){return h.call(this,f)||this}__extends(e,h);e.prototype.setCustomProperty=function(f,g,t,r){var u;void 0===t&&(t=!1);var v={};v[f]=g;var w;void 0!==r&&(w=(u={},u[f]=r,u));(u=this.loadBalancingClient&&this.loadBalancingClient.isJoinedToRoom())&&this.loadBalancingClient&&this.loadBalancingClient._setPropertiesOfRoom(v,t,w);u&&void 0!==r||(this._customProperties[f]=
g,this.onPropertiesChange(v,!0))};e.prototype.setCustomProperties=function(f,g,t){void 0===g&&(g=!1);var r=this.loadBalancingClient&&this.loadBalancingClient.isJoinedToRoom();r&&this.loadBalancingClient&&this.loadBalancingClient._setPropertiesOfRoom(f,g,t);if(!r||void 0===t){for(var u in f)this._customProperties[u]=f[u];this.onPropertiesChange(f,!0)}};e.prototype.setProp=function(f,g,t){void 0===t&&(t=void 0);if(this.loadBalancingClient&&this.loadBalancingClient.isJoinedToRoom()){var r=a.TypeExt.TableTypedKeys();
a.TypeExt.PutTypedKey(r,a.TypeExt.Byte(f),g);if(void 0!==t){var u=a.TypeExt.TableTypedKeys();a.TypeExt.PutTypedKey(u,a.TypeExt.Byte(f),t)}this.loadBalancingClient._setPropertiesOfRoom(r,!1,u);return void 0===t}return!0};e.prototype.setIsVisible=function(f){this.isVisible!=f&&this.setProp(b.Constants.GameProperties.IsVisible,a.TypeExt.Bool(f),a.TypeExt.Bool(this.isVisible))&&(this.isVisible=f)};e.prototype.setIsOpen=function(f){this.isOpen!=f&&this.setProp(b.Constants.GameProperties.IsOpen,a.TypeExt.Bool(f),
a.TypeExt.Bool(this.isOpen))&&(this.isOpen=f)};e.prototype.setMaxPlayers=function(f){this.maxPlayers!=f&&this.setProp(b.Constants.GameProperties.MaxPlayers,a.TypeExt.Byte(f),a.TypeExt.Byte(this.maxPlayers))&&(this.maxPlayers=f)};e.prototype.setRoomTTL=function(f){this.roomTTL!=f&&this.setProp(b.Constants.GameProperties.RoomTTL,a.TypeExt.Int(f))&&(this.roomTTL=this.emptyRoomLiveTime=f)};e.prototype.setEmptyRoomLiveTime=function(f){this.setRoomTTL(f)};e.prototype.setPlayerTTL=function(f){this.playerTTL!=
f&&this.setProp(b.Constants.GameProperties.PlayerTTL,a.TypeExt.Int(f))&&(this.playerTTL=this.suspendedPlayerLiveTime=f)};e.prototype.setSuspendedPlayerLiveTime=function(f){this.setPlayerTTL(f)};e.prototype.setPlugins=function(f){this.plugins=f};e.prototype.setPropsListedInLobby=function(f){this._propsListedInLobby=f};e.prototype.setExpectedUsers=function(f){var g=null,t=null;f&&0!=f.length&&(g=a.TypeExt.String(f));this.expectedUsers&&0!=this.expectedUsers.length&&(t=a.TypeExt.String(this.expectedUsers));
this.setProp(b.Constants.GameProperties.ExpectedUsers,g,t)&&(this.expectedUsers=f)};e.prototype.clearExpectedUsers=function(){var f=null;this.expectedUsers&&0!=this.expectedUsers.length&&(f=a.TypeExt.String(this.expectedUsers));this.setProp(b.Constants.GameProperties.ExpectedUsers,null,f)&&(this.expectedUsers=void 0)};e.prototype.setMasterClient=function(f){this.setProp(b.Constants.GameProperties.MasterClientId,f,this.masterClientId)&&(this.masterClientId=f)};e.prototype._setLBC=function(f){this.loadBalancingClient=
f};return e}(m);b.Room=l;var k=function(){function h(e,f,g){this.appId=f;this.appVersion=g;this.onEventNative=null;this.connectionProtocol=0;this.nameServerAddress=this.masterServerAddress="";this.gamePeerWaitingForDisconnect=!1;this.autoJoinLobby=!0;this.connectOptions={};this.createRoomOptions={};this.joinRoomOptions={};this.roomInfos=[];this.roomInfosDict={};this.actors={};this.actorsArray=[];this.lowestActorId=0;this.userId="";this.userAuthType=b.Constants.CustomAuthenticationType.None;this.userAuthData=
this.userAuthParameters="";this.findFriendsRequestList=[];this.lobbyStatsRequestList=[];this.state_=h.State.Uninitialized;this.logger=new a.Logger("Client:");this.validNextState={};if("number"==typeof e)switch(this.connectionProtocol=e,e){case a.ConnectionProtocol.Ws:this.masterServerAddress="";this.nameServerAddress="ws://ns.photonengine.io:9093";break;case a.ConnectionProtocol.Wss:this.masterServerAddress="";this.nameServerAddress="wss://ns.photonengine.io:19093";break;default:this.nameServerAddress=
this.masterServerAddress="wrong_protocol_error",this.logger.error("Wrong protocol: ",e)}else"string"==typeof e?(this.connectionProtocol=a.ConnectionProtocol.Ws,this.nameServerAddress=this.masterServerAddress=e):(this.connectionProtocol=a.ConnectionProtocol.Ws,this.nameServerAddress=this.masterServerAddress="wrong_protocol_type_error",this.logger.error("Wrong protocol type: ",typeof e));this.initValidNextState();this.currentRoom=this.roomFactoryInternal("");this._myActor=this.actorFactoryInternal("",
-1,!0);this.addActor(this._myActor)}h.prototype.onStateChange=function(e){};h.prototype.onError=function(e,f){};h.prototype.onOperationResponse=function(e,f,g,t){};h.prototype.onEvent=function(e,f,g){};h.prototype.onRoomList=function(e){};h.prototype.onRoomListUpdate=function(e,f,g,t){};h.prototype.onMyRoomPropertiesChange=function(){};h.prototype.onActorPropertiesChange=function(e){};h.prototype.onJoinRoom=function(e){};h.prototype.onActorJoin=function(e){};h.prototype.onActorLeave=function(e,f){};
h.prototype.onActorSuspend=function(e){};h.prototype.onFindFriendsResult=function(e,f,g){};h.prototype.onLobbyStats=function(e,f,g){};h.prototype.onAppStats=function(e,f,g){};h.prototype.onGetRegionsResult=function(e,f,g){};h.prototype.onWebRpcResult=function(e,f,g,t,r){};h.prototype.onServerErrorInfo=function(e){};h.prototype.roomFactory=function(e){return new l(e)};h.prototype.actorFactory=function(e,f,g){return new d(e,f,g)};h.prototype.myActor=function(){return this._myActor};h.prototype.myRoom=
function(){return this.currentRoom};h.prototype.myRoomActors=function(){return this.actors};h.prototype.myRoomActorCount=function(){return this.actorsArray.length};h.prototype.myRoomActorsArray=function(){return this.actorsArray};h.prototype.myRoomMasterActorNr=function(){return this.myRoom().masterClientId?this.myRoom().masterClientId:this.lowestActorId};h.prototype.updateRtt=function(){this.gamePeer&&this.gamePeer.ping()};h.prototype.syncServerTime=function(){this.gamePeer&&this.gamePeer.ping(!0)};
h.prototype.getRtt=function(){return this.gamePeer?this.gamePeer.getRtt():0};h.prototype.getServerTimeMs=function(){return this.gamePeer?this.gamePeer.getServerTimeMs():0};h.prototype.roomFactoryInternal=function(e){void 0===e&&(e="");e=this.roomFactory(e);e._setLBC(this);return e};h.prototype.actorFactoryInternal=function(e,f,g){void 0===e&&(e="");void 0===f&&(f=-1);void 0===g&&(g=!1);e=this.actorFactory(e,f,g);e._setLBC(this);return e};h.prototype.setAppId=function(e){this.appId=e};h.prototype.setAppVersion=
function(e){this.appVersion=e};h.prototype.setNameServerAddress=function(e){this.nameServerAddress=e};h.prototype.getNameServerAddress=function(){return this.nameServerAddress};h.prototype.setMasterServerAddress=function(e){this.masterServerAddress=e};h.prototype.getMasterServerAddress=function(){return this.nameServerAddress};h.prototype.setUserId=function(e){this.userId=e};h.prototype.getUserId=function(){return this.userId};h.prototype.setCustomAuthentication=function(e,f,g){void 0===f&&(f=a.LoadBalancing.Constants.CustomAuthenticationType.Custom);
this.userAuthType=f;this.userAuthParameters=e;this.userAuthData=g};h.prototype.connect=function(e){"boolean"===typeof e&&(e=e?{keepMasterConnection:!0}:{keepMasterConnection:!1});e||(e={});if(this.checkNextState(h.State.ConnectingToMasterserver,!0)){this.changeState(h.State.ConnectingToMasterserver);this.logger.info("Connecting to Master",this.masterServerAddress);this.connectOptions={};for(var f in e)this.connectOptions[f]=e[f];this.masterPeer&&this.masterPeer.Destroy();this.masterPeer=new p(this,
this.connectionProtocol,this.masterServerAddress,"");this.initMasterPeer(this.masterPeer);this.masterPeer.connect(this.appId);return!0}return!1};h.prototype.connectToNameServer=function(e){e||(e={});if(this.checkNextState(h.State.ConnectingToNameServer,!0)){this.changeState(h.State.ConnectingToNameServer);this.logger.info("Connecting to NameServer",this.nameServerAddress);this.connectOptions={};for(var f in e)this.connectOptions[f]=e[f];this.nameServerPeer&&this.nameServerPeer.Destroy();this.nameServerPeer=
new n(this,this.connectionProtocol,this.nameServerAddress,"");this.initNameServerPeer(this.nameServerPeer);this.nameServerPeer.connect(this.appId);return!0}return!1};h.prototype.reconnectToMaster=function(){if(this.state()!=h.State.Disconnected&&this.state()!=h.State.Error)return this.logger.warn("reconnectToMaster() failed. Can only connect while in state 'Disconnected' or 'Error'. Current state: ",h.StateToName(this.state())),!1;if(!this.masterServerAddress)return this.logger.warn("reconnectToMaster() failed. MasterServerAddress is null or empty."),
!1;if(!this.connectOptions.userAuthSecret)return this.logger.warn("reconnectToMaster() failed. It seems the client doesn't have any previous authentication token to re-connect."),!1;this.changeState(h.State.Disconnected);return this.connect(this.connectOptions)};h.prototype.reconnectAndRejoin=function(){if(this.state()!=h.State.Disconnected&&this.state()!=h.State.Error)return this.logger.warn("reconnectToMaster() failed. Can only connect while in state 'Disconnected' or 'Error'. Current state: ",
h.StateToName(this.state())),!1;if(!this.currentRoom.address)return this.logger.warn("reconnectAndRejoin() failed. It seems the client wasn't connected to a game server before (no address)."),!1;if(!this.connectOptions.userAuthSecret)return this.logger.warn("reconnectToMaster() failed. It seems the client doesn't have any previous authentication token to re-connect."),!1;this.joinRoomOptions={rejoin:!0};this.changeState(h.State.Disconnected);return this.connectToGameServer(b.Constants.OperationCode.JoinGame)};
h.prototype.fillCreateRoomOptions=function(e,f,g){f=f||{};var t=a.TypeExt.TableTypedKeys();void 0!==f.isVisible&&a.TypeExt.PutTypedKey(t,a.TypeExt.Byte(b.Constants.GameProperties.IsVisible),a.TypeExt.Bool(f.isVisible));void 0!==f.isOpen&&a.TypeExt.PutTypedKey(t,a.TypeExt.Byte(b.Constants.GameProperties.IsOpen),a.TypeExt.Bool(f.isOpen));void 0!==f.maxPlayers&&a.TypeExt.PutTypedKey(t,a.TypeExt.Byte(b.Constants.GameProperties.MaxPlayers),a.TypeExt.Byte(f.maxPlayers));void 0!==f.propsListedInLobby&&a.TypeExt.PutTypedKey(t,
a.TypeExt.Byte(b.Constants.GameProperties.PropsListedInLobby),a.TypeExt.String(f.propsListedInLobby));if(void 0!==f.customGameProperties)for(var r in f.customGameProperties)a.TypeExt.PutTypedKey(t,a.TypeExt.String(r),f.customGameProperties[r]);e.push(g,t);e.push(b.Constants.ParameterCode.CleanupCacheOnLeave,!0);e.push(b.Constants.ParameterCode.Broadcast,!0);void 0!==f.emptyRoomLiveTime&&e.push(b.Constants.ParameterCode.RoomTTL,a.TypeExt.Int(f.emptyRoomLiveTime));void 0!==f.roomTTL&&e.push(b.Constants.ParameterCode.RoomTTL,
a.TypeExt.Int(f.roomTTL));void 0!==f.suspendedPlayerLiveTime&&e.push(b.Constants.ParameterCode.PlayerTTL,a.TypeExt.Int(f.suspendedPlayerLiveTime));void 0!==f.playerTTL&&e.push(b.Constants.ParameterCode.PlayerTTL,a.TypeExt.Int(f.playerTTL));void 0!==f.plugins&&e.push(b.Constants.ParameterCode.Plugins,a.TypeExt.String(f.plugins));e.push(b.Constants.ParameterCode.CheckUserOnJoin,!0);e.push(b.Constants.ParameterCode.PublishUserId,!0);f.lobbyName&&(e.push(b.Constants.ParameterCode.LobbyName),e.push(f.lobbyName),
void 0!=f.lobbyType&&(e.push(b.Constants.ParameterCode.LobbyType),e.push(a.TypeExt.Byte(f.lobbyType))));f.expectedUsers&&e.push(b.Constants.ParameterCode.Add,a.TypeExt.String(f.expectedUsers))};h.prototype.createRoomFromMy=function(e,f){this.joinRoomOptions={};this.createRoomOptions={};this.currentRoom.name=e?e:"";f=this.copyCreateOptionsFromMyRoom(f);this.masterPeer&&this.createRoomInternal(this.masterPeer,f)};h.prototype.copyCreateOptionsFromMyRoom=function(e){e=e||{};e.isVisible=this.currentRoom.isVisible;
e.isOpen=this.currentRoom.isOpen;e.maxPlayers=this.currentRoom.maxPlayers;e.customGameProperties=this.currentRoom.getCustomProperties();e.propsListedInLobby=this.currentRoom.getPropsListedInLobby();e.roomTTL=this.currentRoom.roomTTL;e.playerTTL=this.currentRoom.playerTTL;e.plugins=this.currentRoom.plugins;e.expectedUsers=this.currentRoom.expectedUsers;return e};h.prototype.createRoom=function(e,f){this.joinRoomOptions={};this.createRoomOptions={};this.currentRoom=this.roomFactoryInternal(e?e:"");
return this.masterPeer?(this.createRoomInternal(this.masterPeer,f),!0):!1};h.prototype.joinRoom=function(e,f,g){if(!this.masterPeer)return!1;this.joinRoomOptions=f||{};this.createRoomOptions=g||{};var t=[];f&&(f.createIfNotExists&&(t.push(b.Constants.ParameterCode.JoinMode,a.TypeExt.Byte(h.JoinMode.CreateIfNotExists)),this.fillCreateRoomOptions(t,g,b.Constants.ParameterCode.GameProperties)),f.rejoin&&t.push(b.Constants.ParameterCode.JoinMode,a.TypeExt.Byte(h.JoinMode.RejoinOnly)),f.expectedUsers&&
t.push(b.Constants.ParameterCode.Add,a.TypeExt.String(f.expectedUsers)));this.currentRoom=this.roomFactoryInternal(e);t.push(b.Constants.ParameterCode.RoomName,e);this.logger.info("Join Room",e,f,g,"...");this.masterPeer.sendOperation(b.Constants.OperationCode.JoinGame,t);return!0};h.prototype.fillJoinRandomRoomOptions=function(e,f){if(f){void 0!=f.matchingType&&f.matchingType!=b.Constants.MatchmakingMode.FillRoom&&(e.push(b.Constants.ParameterCode.MatchMakingType),e.push(a.TypeExt.Byte(f.matchingType)));
var g=a.TypeExt.TableTypedKeys(),t=!1;if(void 0!=f.expectedCustomRoomProperties)for(var r in f.expectedCustomRoomProperties)a.TypeExt.PutTypedKey(g,a.TypeExt.String(r),f.expectedCustomRoomProperties[r]),t=!0;void 0!=f.expectedMaxPlayers&&0<f.expectedMaxPlayers&&(a.TypeExt.PutTypedKey(g,a.TypeExt.Byte(b.Constants.GameProperties.MaxPlayers),a.TypeExt.Byte(f.expectedMaxPlayers)),t=!0);t&&(e.push(b.Constants.ParameterCode.GameProperties),e.push(g));f.lobbyName&&(e.push(b.Constants.ParameterCode.LobbyName),
e.push(f.lobbyName),void 0!=f.lobbyType&&(e.push(b.Constants.ParameterCode.LobbyType),e.push(a.TypeExt.Byte(f.lobbyType))));f.sqlLobbyFilter&&(e.push(b.Constants.ParameterCode.Data),e.push(f.sqlLobbyFilter));f.expectedUsers&&e.push(b.Constants.ParameterCode.Add,a.TypeExt.String(f.expectedUsers))}};h.prototype.joinRandomRoom=function(e){if(!this.masterPeer)return!1;this.joinRoomOptions={};this.createRoomOptions={};var f=[];this.fillJoinRandomRoomOptions(f,e);this.logger.info("Join Random Room",e&&
e.lobbyName,e&&e.lobbyType,"...");this.masterPeer.sendOperation(b.Constants.OperationCode.JoinRandomGame,f);return!0};h.prototype.joinRandomOrCreateRoom=function(e,f,g){if(!this.masterPeer)return!1;this.joinRoomOptions={createIfNotExists:!0};this.createRoomOptions=g||{};var t=[];this.fillJoinRandomRoomOptions(t,e);t.push(b.Constants.ParameterCode.JoinMode,a.TypeExt.Byte(h.JoinMode.CreateIfNotExists));f&&t.push(b.Constants.ParameterCode.RoomName,f);this.fillCreateRoomOptions(t,g,b.Constants.ParameterCode.Properties);
this.logger.info("Join Random or Create Room",e&&e.lobbyName,e&&e.lobbyType,f,t,"...");this.masterPeer.sendOperation(b.Constants.OperationCode.JoinRandomGame,t);return!0};h.prototype._setPropertiesOfRoom=function(e,f,g){if(this.gamePeer){var t=[];t.push(b.Constants.ParameterCode.Properties);t.push(e);t.push(b.Constants.ParameterCode.Broadcast);t.push(!0);f&&(t.push(b.Constants.ParameterCode.WebFlags),t.push(a.TypeExt.Byte(1)));g&&(t.push(b.Constants.ParameterCode.ExpectedValues),t.push(g));this.gamePeer.sendOperation(b.Constants.OperationCode.SetProperties,
t)}};h.prototype._setPropertiesOfActor=function(e,f,g,t){if(this.gamePeer){var r=[];r.push(b.Constants.ParameterCode.ActorNr);r.push(a.TypeExt.Int(e));r.push(b.Constants.ParameterCode.Properties);r.push(f);r.push(b.Constants.ParameterCode.Broadcast);r.push(!0);g&&(r.push(b.Constants.ParameterCode.WebFlags),r.push(a.TypeExt.Byte(1)));t&&(r.push(b.Constants.ParameterCode.ExpectedValues),r.push(t));this.gamePeer.sendOperation(b.Constants.OperationCode.SetProperties,r)}};h.prototype.disconnect=function(){this.nameServerPeer&&
this.nameServerPeer.disconnect();this._cleanupNameServerPeerData();this.masterPeer&&this.masterPeer.disconnect();this._cleanupMasterPeerData();this.gamePeer&&this.gamePeer.disconnect();this._cleanupGamePeerData();this.changeState(h.State.Disconnected)};h.prototype.suspendRoom=function(e){if(this.isJoinedToRoom()){if(this.gamePeer){var f=[];e&&e.sendAuthCookie&&f.push(b.Constants.ParameterCode.WebFlags,a.TypeExt.Byte(2));f.push(b.Constants.ParameterCode.IsInactive,!0);this.gamePeer.sendOperation(b.Constants.OperationCode.Leave,
f);this.gamePeerWaitingForDisconnect=!0}this._cleanupGamePeerData();this.isConnectedToMaster()?this.changeState(h.State.JoinedLobby):(this.changeState(h.State.Disconnected),this.connect(this.connectOptions))}};h.prototype.leaveRoom=function(e){if(this.isJoinedToRoom()){if(this.gamePeer){var f=[];e&&e.sendAuthCookie&&f.push(b.Constants.ParameterCode.WebFlags,a.TypeExt.Byte(2));this.gamePeer.sendOperation(b.Constants.OperationCode.Leave,f);this.gamePeerWaitingForDisconnect=!0}this._cleanupGamePeerData();
this.isConnectedToMaster()?this.changeState(h.State.JoinedLobby):(this.changeState(h.State.Disconnected),this.connect(this.connectOptions))}};h.prototype.raiseEvent=function(e,f,g){this.gamePeer&&this.isJoinedToRoom()&&this.gamePeer.raiseEvent(e,f,g)};h.prototype.changeGroups=function(e,f){this.gamePeer&&this.isJoinedToRoom()&&(this.logger.debug("Group change:",e,f),this.gamePeer.changeGroups(e,f))};h.prototype.findFriends=function(e){if(this.masterPeer&&this.isConnectedToMaster())if(e&&"object"==
typeof e){this.findFriendsRequestList=[];for(var f=0;f<e.length;++f)if("string"==typeof e[f])this.findFriendsRequestList[f]=e[f];else{this.logger.error("FindFriends request error:","Friend name is not a string",f);this.onFindFriendsResult(-1,"Friend name is not a string "+f,{});return}this.logger.debug("Find friends:",e);this.masterPeer.findFriends(this.findFriendsRequestList)}else this.logger.error("FindFriends request error:","Parameter is not an array"),this.onFindFriendsResult(-1,"Parameter is not an array",
{});else this.logger.error("FindFriends request error:","Not connected to Master"),this.onFindFriendsResult(h.PeerErrorCode.MasterError,"Not connected to Master",{})};h.prototype.requestLobbyStats=function(e){if(this.masterPeer&&this.isConnectedToMaster()){this.lobbyStatsRequestList=[];if(e)if("object"==typeof e)for(var f=0;f<e.length;++f){var g=e[f];if("object"==typeof g){var t=g[0];if(t){if(void 0===g[1])g=b.Constants.LobbyType.Default;else if("number"==typeof g[1])g=g[1];else{this.requestLobbyStatsErr("Lobby type is invalid",
f);return}this.lobbyStatsRequestList[f]=[t.toString(),g]}else{this.requestLobbyStatsErr("Lobby name is empty",f);return}}else{this.requestLobbyStatsErr("Lobby id is not an array",f);return}}else{this.requestLobbyStatsErr("Parameter is not an array");return}this.masterPeer.requestLobbyStats(this.lobbyStatsRequestList)}else this.logger.error("LobbyState request error:","Not connected to Master"),this.onLobbyStats(h.PeerErrorCode.MasterError,"Not connected to Master",[])};h.prototype.requestLobbyStatsErr=
function(e,f){void 0===f&&(f="");this.logger.error("LobbyState request error:",e,f);this.onLobbyStats(-1,e+" "+f,[])};h.prototype.getRegions=function(){this.nameServerPeer&&this.isConnectedToNameServer()?(this.logger.debug("GetRegions..."),this.nameServerPeer.getRegions(this.appId)):(this.logger.error("GetRegions request error:","Not connected to NameServer"),this.onGetRegionsResult(h.PeerErrorCode.NameServerError,"Not connected to NameServer",{}))};h.prototype.webRpc=function(e,f,g){this.masterPeer&&
this.isConnectedToMaster()?(this.logger.debug("WebRpc..."),this.masterPeer.webRpc(e,f,g)):this.gamePeer&&this.isJoinedToRoom()?(this.logger.debug("WebRpc..."),this.gamePeer.webRpc(e,f,g)):(this.logger.error("WebRpc request error:","Connected to neither Master nor Game server"),this.onWebRpcResult(h.PeerErrorCode.MasterError,"Connected to neither Master nor Game server",e,0,{}))};h.prototype.connectToRegionMaster=function(e){if(this.nameServerPeer&&this.isConnectedToNameServer())return this.logger.debug("Connecting to Region Master",
e,"..."),this.nameServerPeer.opAuth(this.appId,this.appVersion,this.userAuthType,this.userAuthParameters,this.userAuthData,this.userId,e),!0;if(this.connectToNameServer({region:e}))return!0;this.logger.error("Connecting to Region Master error:","Not connected to NameServer");return!1};h.prototype.state=function(){return this.state_};h.prototype.isConnectedToMaster=function(){return this.masterPeer&&this.masterPeer.isConnected()};h.prototype.isConnectedToNameServer=function(){return this.nameServerPeer&&
this.nameServerPeer.isConnected()};h.prototype.isInLobby=function(){return this.state()==h.State.JoinedLobby};h.prototype.isJoinedToRoom=function(){return this.state()==h.State.Joined};h.prototype.isConnectedToGame=function(){return this.isJoinedToRoom()};h.prototype.availableRooms=function(){return this.roomInfos};h.prototype.setLogLevel=function(e){this.logger.setLevel(e);this.nameServerPeer&&this.nameServerPeer.setLogLevel(e);this.masterPeer&&this.masterPeer.setLogLevel(e);this.gamePeer&&this.gamePeer.setLogLevel(e)};
h.prototype.addRoom=function(e){this.roomInfos.push(e);this.roomInfosDict[e.name]=e};h.prototype.clearRooms=function(){this.roomInfos=[];this.roomInfosDict={}};h.prototype.purgeRemovedRooms=function(){this.roomInfos=this.roomInfos.filter(function(f){return!f.removed});for(var e in this.roomInfosDict)this.roomInfosDict[e].removed&&delete this.roomInfosDict[e]};h.prototype.addActor=function(e){this.actors[e.actorNr]=e;this.actorsArray.push(e);this.currentRoom.playerCount=this.actorsArray.length;if(0==
this.lowestActorId||this.lowestActorId>e.actorNr)this.lowestActorId=e.actorNr};h.prototype.removeActor=function(e){delete this.actors[e];this.actorsArray=this.actorsArray.filter(function(f){return f.actorNr!=e});this.currentRoom.playerCount=this.actorsArray.length;this.lowestActorId==e&&(this.lowestActorId=0<this.actorsArray.length?this.actorsArray.reduce(function(f,g){return f.actorNr<g.actorNr?f:g}).actorNr:0)};h.prototype.clearActors=function(){this.actors={};this.actorsArray=[];this.lowestActorId=
this.currentRoom.playerCount=0};h.prototype.changeState=function(e){this.logger.info("State:",h.StateToName(this.state()),"->",h.StateToName(e));this.state_=e;this.onStateChange(e)};h.prototype.createRoomInternal=function(e,f){var g=[];this.currentRoom.name&&g.push(b.Constants.ParameterCode.RoomName,this.currentRoom.name);this.fillCreateRoomOptions(g,f,b.Constants.ParameterCode.GameProperties);e===this.masterPeer&&(this.createRoomOptions=f);e===this.gamePeer&&(g.push(b.Constants.ParameterCode.PlayerProperties),
g.push(this._myActor._getAllProperties()));var t=e==this.gamePeer?this.gamePeer._logger:this.masterPeer?this.masterPeer._logger:null;t&&t.info("Create Room",f&&f.lobbyName,f&&f.lobbyType,"...");e.sendOperation(b.Constants.OperationCode.CreateGame,g)};h.prototype.updateUserIdAndNickname=function(e,f){var g=e[b.Constants.ParameterCode.UserId];void 0!=g&&(this.setUserId(g),f.info("Setting userId sent by server:",g));e=e[b.Constants.ParameterCode.Nickname];void 0!=e&&(this.myActor().setName(e),f.info("Setting nickname sent by server:",
e))};h.prototype.initNameServerPeer=function(e){var f=this;e.setLogLevel(this.logger.getLevel());e.addPeerStatusListener(a.PhotonPeer.StatusCodes.error,function(){f.changeState(h.State.Error);f._onErrorInternal(h.PeerErrorCode.NameServerError,"NameServer peer error")});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.connectFailed,function(){f.changeState(h.State.Error);f._onErrorInternal(h.PeerErrorCode.NameServerConnectFailed,"NameServer peer connect failed. "+f.nameServerAddress)});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.timeout,
function(){f.changeState(h.State.Error);f._onErrorInternal(h.PeerErrorCode.NameServerTimeout,"NameServer peer timeout")});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.connecting,function(){});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.connect,function(){e._logger.info("Connected");f.changeState(h.State.ConnectedToNameServer);void 0!=f.connectOptions.region&&e.opAuth(f.appId,f.appVersion,f.userAuthType,f.userAuthParameters,f.userAuthData,f.userId,f.connectOptions.region)});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.disconnect,
function(){e==f.nameServerPeer&&(f._cleanupNameServerPeerData(),e._logger.info("Disconnected"))});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.connectClosed,function(){e._logger.info("Server closed connection");f.changeState(h.State.Error);f._onErrorInternal(h.PeerErrorCode.NameServerConnectClosed,"NameServer server closed connection")});e.addResponseListener(b.Constants.OperationCode.GetRegions,function(g){e._logger.debug("resp GetRegions",g);var t={};if(0==g.errCode){var r=g.vals[b.Constants.ParameterCode.Region],
u=g.vals[b.Constants.ParameterCode.Address],v;for(v in r)t[r[v]]=u[v]}else e._logger.error("GetRegions request error.",g.errCode);f.onGetRegionsResult(g.errCode,g.errMsg,t)});e.addResponseListener(b.Constants.OperationCode.Authenticate,function(g){e._logger.debug("resp Authenticate",g);0==g.errCode?(e._logger.info("Authenticated"),e.disconnect(),f.updateUserIdAndNickname(g.vals,e._logger),f.masterServerAddress=g.vals[b.Constants.ParameterCode.Address],e._logger.info("Connecting to Master server",
f.masterServerAddress,"..."),f.connectOptions.userAuthSecret=g.vals[b.Constants.ParameterCode.Secret],f.connect(f.connectOptions)):(f.changeState(h.State.Error),f._onErrorInternal(h.PeerErrorCode.NameServerAuthenticationFailed,"NameServer authentication failed: "+g.errCode+" "+g.errMsg))})};h.prototype.initMasterPeer=function(e){var f=this;e.setLogLevel(this.logger.getLevel());e.addPeerStatusListener(a.PhotonPeer.StatusCodes.error,function(){f.changeState(h.State.Error);f._onErrorInternal(h.PeerErrorCode.MasterError,
"Master peer error")});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.connectFailed,function(){f.changeState(h.State.Error);f._onErrorInternal(h.PeerErrorCode.MasterConnectFailed,"Master peer connect failed: "+f.masterServerAddress)});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.timeout,function(){f.changeState(h.State.Error);f._onErrorInternal(h.PeerErrorCode.MasterTimeout,"Master peer error timeout")});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.connecting,function(){});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.connect,
function(){e._logger.info("Connected");var g=[];f.connectOptions.userAuthSecret?(g.push(b.Constants.ParameterCode.Secret,f.connectOptions.userAuthSecret),e.sendOperation(b.Constants.OperationCode.Authenticate,g),e._logger.info("Authenticate with secret...")):(g.push(b.Constants.ParameterCode.ApplicationId),g.push(f.appId),g.push(b.Constants.ParameterCode.AppVersion),g.push(f.appVersion),f.userAuthType!=b.Constants.CustomAuthenticationType.None&&(g.push(b.Constants.ParameterCode.ClientAuthenticationType,
a.TypeExt.Byte(f.userAuthType)),g.push(b.Constants.ParameterCode.ClientAuthenticationParams,f.userAuthParameters),f.userAuthData&&g.push(b.Constants.ParameterCode.ClientAuthenticationData,f.userAuthData)),f.userId&&g.push(b.Constants.ParameterCode.UserId,f.userId),f.connectOptions.lobbyStats&&g.push(b.Constants.ParameterCode.LobbyStats,!0),e.sendOperation(b.Constants.OperationCode.Authenticate,g),e._logger.info("Authenticate..."))});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.disconnect,function(){e==
f.masterPeer&&(f._cleanupMasterPeerData(),e._logger.info("Disconnected"))});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.connectClosed,function(){e._logger.info("Server closed connection");f.changeState(h.State.Error);f._onErrorInternal(h.PeerErrorCode.MasterConnectClosed,"Master server closed connection")});e.addEventListener(b.Constants.EventCode.GameList,function(g){g=g.vals[b.Constants.ParameterCode.GameList];f.clearRooms();for(var t in g){var r=new m(t);r._updateFromProps(g[t]);f.addRoom(r)}f.onRoomList(f.roomInfos);
e._logger.debug("ev GameList",f.roomInfos,g)});e.addEventListener(b.Constants.EventCode.GameListUpdate,function(g){g=g.vals[b.Constants.ParameterCode.GameList];var t=[],r=[],u=[],v;for(v in g){var w=f.roomInfos.filter(function(x){return x.name==v});0<w.length?(w=w[0],w._updateFromProps(g[v]),w.removed?u.push(w):t.push(w)):(w=new m(v),w._updateFromProps(g[v]),f.addRoom(w),r.push(w))}f.purgeRemovedRooms();f.onRoomListUpdate(f.roomInfos,t,r,u);e._logger.debug("ev GameListUpdate:",f.roomInfos,"u:",t,
"a:",r,"r:",u,g)});e.addResponseListener(b.Constants.OperationCode.Authenticate,function(g){e._logger.debug("resp Authenticate",g);g.errCode?(f.changeState(h.State.Error),f._onErrorInternal(h.PeerErrorCode.MasterAuthenticationFailed,"Master authentication failed: "+g.errCode+" "+g.errMsg)):(e._logger.info("Authenticated"),f.updateUserIdAndNickname(g.vals,e._logger),void 0!=g.vals[b.Constants.ParameterCode.Secret]&&(f.connectOptions.userAuthSecret=g.vals[b.Constants.ParameterCode.Secret]),f.changeState(h.State.ConnectedToMaster),
g=[],f.connectOptions.lobbyName&&(g.push(b.Constants.ParameterCode.LobbyName),g.push(f.connectOptions.lobbyName),void 0!=f.connectOptions.lobbyType&&(g.push(b.Constants.ParameterCode.LobbyType),g.push(a.TypeExt.Byte(f.connectOptions.lobbyType)))),f.autoJoinLobby&&(e.sendOperation(b.Constants.OperationCode.JoinLobby,g),e._logger.info("Join Lobby",f.connectOptions.lobbyName,f.connectOptions.lobbyType,"...")))});e.addResponseListener(b.Constants.OperationCode.JoinLobby,function(g){e._logger.debug("resp JoinLobby",
g);g.errCode||(e._logger.info("Joined to Lobby"),void 0!=g.vals[b.Constants.ParameterCode.Secret]&&(f.connectOptions.userAuthSecret=g.vals[b.Constants.ParameterCode.Secret]),f.changeState(h.State.JoinedLobby));f._onOperationResponseInternal2(b.Constants.OperationCode.JoinLobby,g)});e.addResponseListener(b.Constants.OperationCode.CreateGame,function(g){e._logger.debug("resp CreateGame",g);g.errCode||(void 0!=g.vals[b.Constants.ParameterCode.Secret]&&(f.connectOptions.userAuthSecret=g.vals[b.Constants.ParameterCode.Secret]),
f.currentRoom._updateFromMasterResponse(g.vals),e._logger.debug("Created/Joined "+f.currentRoom.name),f.connectToGameServer(b.Constants.OperationCode.CreateGame));f._onOperationResponseInternal2(b.Constants.OperationCode.CreateGame,g)});e.addResponseListener(b.Constants.OperationCode.JoinGame,function(g){e._logger.debug("resp JoinGame",g);g.errCode||(void 0!=g.vals[b.Constants.ParameterCode.Secret]&&(f.connectOptions.userAuthSecret=g.vals[b.Constants.ParameterCode.Secret]),f.currentRoom._updateFromMasterResponse(g.vals),
e._logger.debug("Joined "+f.currentRoom.name),f.connectToGameServer(b.Constants.OperationCode.JoinGame));f._onOperationResponseInternal2(b.Constants.OperationCode.JoinGame,g)});e.addResponseListener(b.Constants.OperationCode.JoinRandomGame,function(g){e._logger.debug("resp JoinRandomGame",g);g.errCode||(void 0!=g.vals[b.Constants.ParameterCode.Secret]&&(f.connectOptions.userAuthSecret=g.vals[b.Constants.ParameterCode.Secret]),f.currentRoom._updateFromMasterResponse(g.vals),e._logger.debug("Joined "+
f.currentRoom.name),f.connectToGameServer(b.Constants.OperationCode.JoinRandomGame));f._onOperationResponseInternal2(b.Constants.OperationCode.JoinRandomGame,g)});e.addResponseListener(b.Constants.OperationCode.FindFriends,function(g){e._logger.debug("resp FindFriends",g);var t={};if(g.errCode)e._logger.error("FindFriends request error:",g.errCode);else for(var r=g.vals[b.Constants.ParameterCode.FindFriendsResponseOnlineList]||{},u=g.vals[b.Constants.ParameterCode.FindFriendsResponseRoomIdList]||
{},v=0;v<f.findFriendsRequestList.length;++v){var w=f.findFriendsRequestList[v];w&&(t[w]={online:r[v],roomId:u[v]})}f.onFindFriendsResult(g.errCode,g.errMsg,t)});e.addResponseListener(b.Constants.OperationCode.LobbyStats,function(g){e._logger.debug("resp LobbyStats",g);var t=[];if(g.errCode)e._logger.error("LobbyStats request error:",g.errCode);else{var r=g.vals[b.Constants.ParameterCode.LobbyName],u=g.vals[b.Constants.ParameterCode.LobbyType]||{},v=g.vals[b.Constants.ParameterCode.PeerCount]||{},
w=g.vals[b.Constants.ParameterCode.GameCount]||{};if(r)for(var x=0;x<r.length;++x)t[x]={lobbyName:r[x],lobbyType:u[x],peerCount:v[x],gameCount:w[x]};else for(x=0;x<f.lobbyStatsRequestList.length;++x)r=f.lobbyStatsRequestList[x],t[x]={lobbyName:r[0],lobbyType:r[1],peerCount:v[x],gameCount:w[x]}}f.onLobbyStats(g.errCode,g.errMsg,t)});e.addEventListener(b.Constants.EventCode.LobbyStats,function(g){e._logger.debug("ev LobbyStats",g);var t=[],r=g.vals[b.Constants.ParameterCode.LobbyName],u=g.vals[b.Constants.ParameterCode.LobbyType]||
{},v=g.vals[b.Constants.ParameterCode.PeerCount]||{};g=g.vals[b.Constants.ParameterCode.GameCount]||{};if(r)for(var w=0;w<r.length;++w)t[w]={lobbyName:r[w],lobbyType:u[w],peerCount:v[w],gameCount:g[w]};f.onLobbyStats(0,"",t)});e.addEventListener(b.Constants.EventCode.AppStats,function(g){e._logger.debug("ev AppStats",g);f.onAppStats(0,"",{peerCount:g.vals[b.Constants.ParameterCode.PeerCount],masterPeerCount:g.vals[b.Constants.ParameterCode.MasterPeerCount],gameCount:g.vals[b.Constants.ParameterCode.GameCount]})});
e.addResponseListener(b.Constants.OperationCode.Rpc,e.webRpcHandler(this))};h.prototype.connectToGameServer=function(e){!this.connectOptions.keepMasterConnection&&this.masterPeer&&this.masterPeer.disconnect();return this.checkNextState(h.State.ConnectingToGameserver,!0)?(this.logger.info("Connecting to Game",this.currentRoom.address),this.gamePeer&&this.gamePeer.Destroy(),this.gamePeer=new q(this,this.connectionProtocol,this.currentRoom.address,""),this.gamePeerWaitingForDisconnect=!1,this.initGamePeer(this.gamePeer,
e),this.gamePeer.connect(this.appId),this.changeState(h.State.ConnectingToGameserver),!0):!1};h.prototype.initGamePeer=function(e,f){var g=this;e.setLogLevel(this.logger.getLevel());e.addPeerStatusListener(a.PhotonPeer.StatusCodes.error,function(){g.changeState(h.State.Error);g._onErrorInternal(h.PeerErrorCode.GameError,"Game peer error")});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.connectFailed,function(){g.changeState(h.State.Error);g._onErrorInternal(h.PeerErrorCode.GameConnectFailed,"Game peer connect failed: "+
g.currentRoom.address)});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.timeout,function(){g.changeState(h.State.Error);g._onErrorInternal(h.PeerErrorCode.GameTimeout,"Game peer timeout")});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.connect,function(){e._logger.info("Connected");var r=[];r.push(b.Constants.ParameterCode.ApplicationId);r.push(g.appId);r.push(b.Constants.ParameterCode.AppVersion);r.push(g.appVersion);void 0!=g.connectOptions.userAuthSecret&&(r.push(b.Constants.ParameterCode.Secret),
r.push(g.connectOptions.userAuthSecret));g.userAuthType!=b.Constants.CustomAuthenticationType.None&&(r.push(b.Constants.ParameterCode.ClientAuthenticationType),r.push(a.TypeExt.Byte(g.userAuthType)));g.userId&&r.push(b.Constants.ParameterCode.UserId,g.userId);e.sendOperation(b.Constants.OperationCode.Authenticate,r);e._logger.info("Authenticate...")});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.disconnect,function(){e==g.gamePeer&&(g._cleanupGamePeerData(),e._logger.info("Disconnected"))});e.addPeerStatusListener(a.PhotonPeer.StatusCodes.connectClosed,
function(){e._logger.info("Server closed connection");g.gamePeerWaitingForDisconnect||(g.changeState(h.State.Error),g._onErrorInternal(h.PeerErrorCode.GameConnectClosed,"Game server closed connection"))});e.addResponseListener(b.Constants.OperationCode.Authenticate,function(r){e._logger.debug("resp Authenticate",r);r.errCode?(g.changeState(h.State.Error),g._onErrorInternal(h.PeerErrorCode.GameAuthenticationFailed,"Game authentication failed: "+r.errCode+" "+r.errMsg)):(e._logger.info("Authenticated"),
e._logger.info("Connected"),f==b.Constants.OperationCode.CreateGame?g.createRoomInternal(e,g.createRoomOptions):(r=[],r.push(b.Constants.ParameterCode.RoomName),r.push(g.currentRoom.name),r.push(b.Constants.ParameterCode.Broadcast),r.push(!0),r.push(b.Constants.ParameterCode.PlayerProperties),r.push(g._myActor._getAllProperties()),g.joinRoomOptions.createIfNotExists&&(r.push(b.Constants.ParameterCode.JoinMode,a.TypeExt.Byte(h.JoinMode.CreateIfNotExists)),g.fillCreateRoomOptions(r,g.createRoomOptions,
b.Constants.ParameterCode.GameProperties)),g.joinRoomOptions.rejoin&&r.push(b.Constants.ParameterCode.JoinMode,a.TypeExt.Byte(h.JoinMode.RejoinOnly)),g.joinRoomOptions.expectedUsers&&r.push(b.Constants.ParameterCode.Add,a.TypeExt.String(g.joinRoomOptions.expectedUsers)),e.sendOperation(b.Constants.OperationCode.JoinGame,r)),g.changeState(h.State.ConnectedToGameserver))});var t=function(r){return{actorNr:r.actorNr,userId:r.userId,name:r.name,customProperties:r.getCustomProperties()}};e.addResponseListener(b.Constants.OperationCode.CreateGame,
function(r){e._logger.debug("resp CreateGame",r);r.errCode||(g._myActor._updateMyActorFromResponse(r.vals),e._logger.info("myActor: ",t(g._myActor)),g.currentRoom._updateFromProps(r.vals[b.Constants.ParameterCode.GameProperties]),g.clearActors(),g.addActor(g._myActor),g.changeState(h.State.Joined),g.onJoinRoom(!0));g._onOperationResponseInternal2(b.Constants.OperationCode.CreateGame,r)});e.addResponseListener(b.Constants.OperationCode.JoinGame,function(r){e._logger.debug("resp JoinGame",r);if(!r.errCode){g._myActor._updateMyActorFromResponse(r.vals);
e._logger.info("myActor: ",t(g._myActor));g.clearActors();g.addActor(g._myActor);var u=r.vals[b.Constants.ParameterCode.ActorList],v=r.vals[b.Constants.ParameterCode.PlayerProperties];if(void 0!==u)for(var w=0;w<u.length;w++){var x=u[w],y;void 0!==v&&(y=v[x]);var z="";void 0!==y&&(z=y[b.Constants.ActorProperties.PlayerName]);x==g._myActor.actorNr?x=g._myActor:(x=g.actorFactoryInternal(z,x),g.addActor(x));void 0!==y&&(z=y[b.Constants.ActorProperties.UserId],void 0!=z&&(x.userId=z));void 0!==y&&x._updateFromProps(y)}g.currentRoom._updateFromProps(r.vals[b.Constants.ParameterCode.GameProperties]);
g.changeState(h.State.Joined);g.onJoinRoom(!1)}g._onOperationResponseInternal2(b.Constants.OperationCode.JoinGame,r)});e.addResponseListener(b.Constants.OperationCode.SetProperties,function(r){e._logger.debug("resp SetProperties",r);g._onOperationResponseInternal2(b.Constants.OperationCode.SetProperties,r)});e.addResponseListener(b.Constants.OperationCode.Leave,function(r){e._logger.debug("resp Leave",r);e.disconnect();g._onOperationResponseInternal2(b.Constants.OperationCode.Leave,r)});e.addResponseListener(b.Constants.OperationCode.Rpc,
e.webRpcHandler(this));e.addEventListener(b.Constants.EventCode.Join,function(r){e._logger.debug("ev Join",r);if(d._getActorNrFromResponse(r.vals)===g._myActor.actorNr)g._myActor._updateFromResponse(r.vals),g.onActorJoin(g._myActor);else{var u=g.actorFactoryInternal();u._updateFromResponse(r.vals);g.addActor(u);g.onActorJoin(u)}});e.addEventListener(b.Constants.EventCode.Leave,function(r){e._logger.debug("ev Leave",r);g.myRoom()._updateFromEvent(r.vals);var u=d._getActorNrFromResponse(r.vals);if(u&&
g.actors[u]){var v=g.actors[u];r.vals[b.Constants.ParameterCode.IsInactive]?(v._setSuspended(!0),g.onActorSuspend(v)):(g.removeActor(u),g.onActorLeave(v,!1))}});e.addEventListener(b.Constants.EventCode.Disconnect,function(r){e._logger.debug("ev Disconnect",r);(r=d._getActorNrFromResponse(r.vals))&&g.actors[r]&&(r=g.actors[r],r._setSuspended(!0),g.onActorSuspend(r))});e.addEventListener(b.Constants.EventCode.PropertiesChanged,function(r){e._logger.debug("ev PropertiesChanged",r);var u=r.vals[b.Constants.ParameterCode.TargetActorNr];
void 0!==u&&0<u?void 0!==g.actors[u]&&(u=g.actors[u],u._updateFromProps(r.vals[b.Constants.ParameterCode.Properties]),g.onActorPropertiesChange(u)):(g.currentRoom._updateFromProps(r.vals[b.Constants.ParameterCode.Properties]),g.onMyRoomPropertiesChange())});e.addEventListener(b.Constants.EventCode.AuthEvent,function(r){e._logger.debug("ev AuthEvent",r);g.connectOptions.userAuthSecret=r.vals[b.Constants.ParameterCode.Secret]});e.addEventListener(b.Constants.EventCode.ErrorInfo,function(r){e._logger.debug("ev ErrorInfo",
r);g.onServerErrorInfo(r.vals[b.Constants.ParameterCode.Info])})};h.prototype._cleanupNameServerPeerData=function(){};h.prototype._cleanupMasterPeerData=function(){};h.prototype._cleanupGamePeerData=function(){for(var e in this.actors)this.onActorLeave(this.actors[e],!0);this.clearActors();this.addActor(this._myActor)};h.prototype._onOperationResponseInternal2=function(e,f){f.errCode&&this.logger.warn("Operation",e,"error:",f.errMsg,"("+f.errCode+")");this.onOperationResponse(f.errCode,f.errMsg,e,
f.vals)};h.prototype._onErrorInternal=function(e,f){this.logger.error("Error:",e,f);this.onError(e,f)};h.prototype.initValidNextState=function(){this.validNextState[h.State.Error]=[h.State.ConnectingToMasterserver,h.State.ConnectingToNameServer];this.validNextState[h.State.Uninitialized]=[h.State.ConnectingToMasterserver,h.State.ConnectingToNameServer];this.validNextState[h.State.ConnectedToNameServer]=[h.State.ConnectingToMasterserver];this.validNextState[h.State.Disconnected]=[h.State.ConnectingToGameserver,
h.State.ConnectingToMasterserver,h.State.ConnectingToNameServer];this.validNextState[h.State.ConnectedToMaster]=[h.State.JoinedLobby,h.State.ConnectingToGameserver];this.validNextState[h.State.JoinedLobby]=[h.State.ConnectingToGameserver];this.validNextState[h.State.ConnectingToGameserver]=[h.State.ConnectedToGameserver];this.validNextState[h.State.ConnectedToGameserver]=[h.State.Joined]};h.prototype.checkNextState=function(e,f){void 0===f&&(f=!1);var g=this.validNextState[this.state()];(g=g&&0<=
g.indexOf(e))||(f?this.logger.error("LoadBalancingPeer checkNextState fail: "+h.StateToName(this.state())+" -> "+h.StateToName(e)):this.logger.exception(501,"LoadBalancingPeer checkNextState fail: "+h.StateToName(this.state())+" -> "+h.StateToName(e)));return g};h.StateToName=function(e){return h.stateName[e]};h.JoinMode={Default:0,CreateIfNotExists:1,RejoinOnly:3};h.PeerErrorCode={Ok:0,MasterError:1001,MasterConnectFailed:1002,MasterConnectClosed:1003,MasterTimeout:1004,MasterEncryptionEstablishError:1005,
MasterAuthenticationFailed:1101,GameError:2001,GameConnectFailed:2002,GameConnectClosed:2003,GameTimeout:2004,GameEncryptionEstablishError:2005,GameAuthenticationFailed:2101,NameServerError:3001,NameServerConnectFailed:3002,NameServerConnectClosed:3003,NameServerTimeout:3004,NameServerEncryptionEstablishError:3005,NameServerAuthenticationFailed:3101};h.State={Error:-1,Uninitialized:0,ConnectingToNameServer:1,ConnectedToNameServer:2,ConnectingToMasterserver:3,ConnectedToMaster:4,JoinedLobby:5,ConnectingToGameserver:6,
ConnectedToGameserver:7,Joined:8,Disconnected:10};h.stateName=(c={},c[h.State.Error]="Error",c[h.State.Uninitialized]="Uninitialized",c[h.State.ConnectingToNameServer]="ConnectingToNameServer",c[h.State.ConnectedToNameServer]="ConnectedToNameServer",c[h.State.ConnectingToMasterserver]="ConnectingToMasterserver",c[h.State.ConnectedToMaster]="ConnectedToMaster",c[h.State.JoinedLobby]="JoinedLobby",c[h.State.ConnectingToGameserver]="ConnectingToGameserver",c[h.State.ConnectedToGameserver]="ConnectedToGameserver",
c[h.State.Joined]="Joined",c[h.State.Disconnected]="Disconnected",c);return h}();b.LoadBalancingClient=k;k=function(h){function e(){return null!==h&&h.apply(this,arguments)||this}__extends(e,h);e.prototype.webRpc=function(f,g,t){var r=[];r.push(b.Constants.ParameterCode.UriPath,f);r.push(b.Constants.ParameterCode.RpcCallParams,g);t&&t.sendAuthCookie&&r.push(b.Constants.ParameterCode.WebFlags,a.TypeExt.Byte(2));this.sendOperation(b.Constants.OperationCode.Rpc,r)};e.prototype.webRpcHandler=function(f){var g=
this;return function(t){g._logger.debug("resp Rpc",t);if(0==t.errCode){var r=t.vals[b.Constants.ParameterCode.UriPath];var u=t.vals[b.Constants.ParameterCode.RpcCallRetData];var v=t.vals[b.Constants.ParameterCode.RpcCallRetCode]}else g._logger.error("WebRpc request error:",t.errCode);f.onWebRpcResult(t.errCode,t.errMsg,r,v,u)}};return e}(a.PhotonPeer);b.LbcPeer=k;var n=function(h){function e(f,g,t,r){g=h.call(this,g,t,r,f.logger.getPrefix()+" NameServer")||this;g.client=f;return g}__extends(e,h);
e.prototype.onUnhandledEvent=function(f,g){this.client.onEvent(f,g.vals[b.Constants.ParameterCode.CustomEventContent],g.vals[b.Constants.ParameterCode.ActorNr])};e.prototype.onUnhandledResponse=function(f,g){this.client.onOperationResponse(g.errCode,g.errMsg,f,g.vals)};e.prototype.getRegions=function(f){var g=[];g.push(b.Constants.ParameterCode.ApplicationId,f);this.sendOperation(b.Constants.OperationCode.GetRegions,g,!0,0)};e.prototype.opAuth=function(f,g,t,r,u,v,w){var x=[];x.push(b.Constants.ParameterCode.ApplicationId,
f);x.push(b.Constants.ParameterCode.AppVersion,g);t!=b.Constants.CustomAuthenticationType.None&&(x.push(b.Constants.ParameterCode.ClientAuthenticationType,a.TypeExt.Byte(t)),x.push(b.Constants.ParameterCode.ClientAuthenticationParams,r),u&&x.push(b.Constants.ParameterCode.ClientAuthenticationData,u));v&&x.push(b.Constants.ParameterCode.UserId,v);x.push(b.Constants.ParameterCode.Region,w);this.sendOperation(b.Constants.OperationCode.Authenticate,x,!0,0);this._logger.info("Authenticate...")};return e}(k);
b.NameServerPeer=n;var p=function(h){function e(f,g,t,r){g=h.call(this,g,t,r,f.logger.getPrefix()+" Master")||this;g.client=f;return g}__extends(e,h);e.prototype.onUnhandledEvent=function(f,g){this.client.onEvent(f,g.vals[b.Constants.ParameterCode.CustomEventContent],g.vals[b.Constants.ParameterCode.ActorNr])};e.prototype.onUnhandledResponse=function(f,g){this.client.onOperationResponse(g.errCode,g.errMsg,f,g.vals)};e.prototype.findFriends=function(f){var g=[];g.push(b.Constants.ParameterCode.FindFriendsRequestList);
g.push(a.TypeExt.String(f));this.sendOperation(b.Constants.OperationCode.FindFriends,g)};e.prototype.requestLobbyStats=function(f){var g=[];if(f&&0<f.length){for(var t=[],r=[],u=0;u<f.length;++u)t[u]=f[u][0],r[u]=f[u][1];g.push(b.Constants.ParameterCode.LobbyName);g.push(a.TypeExt.String(t));g.push(b.Constants.ParameterCode.LobbyType);g.push(a.TypeExt.Byte(r))}this.sendOperation(b.Constants.OperationCode.LobbyStats,g)};return e}(k);b.MasterPeer=p;var q=function(h){function e(f,g,t,r){var u=h.call(this,
g,t,r,f.logger.getPrefix()+" Game")||this;u.client=f;u.onEventNative=function(v,w){return u.client.onEventNative?u.client.onEventNative(v,w):!1};return u}__extends(e,h);e.prototype.onUnhandledEvent=function(f,g){this.client.onEvent(f,g.vals[b.Constants.ParameterCode.CustomEventContent],g.vals[b.Constants.ParameterCode.ActorNr])};e.prototype.onUnhandledResponse=function(f,g){this.client.onOperationResponse(g.errCode,g.errMsg,f,g.vals)};e.prototype.raiseEvent=function(f,g,t){if(this.client.isJoinedToRoom())this._logger.debug("raiseEvent",
f,g,t),f=[b.Constants.ParameterCode.Code,a.TypeExt.Byte(f),b.Constants.ParameterCode.Data,g],t&&(void 0!=t.receivers&&t.receivers!==b.Constants.ReceiverGroup.Others&&(f.push(b.Constants.ParameterCode.ReceiverGroup),f.push(a.TypeExt.Byte(t.receivers))),void 0!=t.cache&&t.cache!==b.Constants.EventCaching.DoNotCache&&(f.push(b.Constants.ParameterCode.Cache),f.push(a.TypeExt.Byte(t.cache))),void 0!=t.interestGroup&&(this.checkGroupNumber(t.interestGroup)?(f.push(b.Constants.ParameterCode.Group),f.push(a.TypeExt.Byte(t.interestGroup))):
this._logger.exception(502,"raiseEvent - Group not a number: "+t.interestGroup)),void 0!=t.targetActors&&(f.push(b.Constants.ParameterCode.ActorList),f.push(a.TypeExt.Int(t.targetActors))),t.webForward&&(f.push(b.Constants.ParameterCode.WebFlags),f.push(a.TypeExt.Byte(1)))),this.sendOperation(b.Constants.OperationCode.RaiseEvent,f);else throw Error("raiseEvent - Not joined!");};e.prototype.changeGroups=function(f,g){var t=[];null!=f&&void 0!=f&&(this.checkGroupArray(f,"groupsToRemove"),t.push(b.Constants.ParameterCode.Remove),
t.push(a.TypeExt.Byte(f)));null!=g&&void 0!=g&&(this.checkGroupArray(g,"groupsToAdd"),t.push(b.Constants.ParameterCode.Add),t.push(a.TypeExt.Byte(g)));this.sendOperation(b.Constants.OperationCode.ChangeGroups,t)};e.prototype.checkGroupNumber=function(f){return!("number"!=typeof f||isNaN(f)||Infinity===f||-Infinity===f)};e.prototype.checkGroupArray=function(f,g){if(a.Util.isArray(f))for(var t=0;t<f.length;++t){var r=f[t];this.checkGroupNumber(r)||this._logger.exception(503,"changeGroups - "+g+" ("+
f+") not an array of numbers: element "+t+" = "+r)}else this._logger.exception(504,"changeGroups - groupsToRemove not an array: "+f)};return e}(k);b.GamePeer=q})(a.LoadBalancing||(a.LoadBalancing={}))})(Photon||(Photon={}));
(function(a){a=a.Lite||(a.Lite={});a=a.Constants||(a.Constants={});a.LiteOpKey={ActorList:252,ActorNr:254,ActorProperties:249,Add:238,Broadcast:250,Cache:247,Code:244,Data:245,GameId:255,GameProperties:248,Group:240,Properties:251,ReceiverGroup:246,Remove:239,TargetActorNr:253,RoomTTL:236};a.LiteEventCode={Join:255,Leave:254,PropertiesChanged:253};a.LiteOpCode={ChangeGroups:248,GetProperties:251,Join:255,Leave:254,RaiseEvent:253,SetProperties:252}})(Photon||(Photon={}));
(function(a){var b=a.LoadBalancing||(a.LoadBalancing={});b=b.Constants||(b.Constants={});var c=a.Lite.Constants.LiteOpKey,d=a.Lite.Constants.LiteOpCode;a=a.Lite.Constants.LiteEventCode;b.ErrorCode={Ok:0,OperationNotAllowedInCurrentState:-3,InvalidOperationCode:-2,InternalServerError:-1,InvalidAuthentication:32767,GameIdAlreadyExists:32766,GameFull:32765,GameClosed:32764,ServerFull:32762,UserBlocked:32761,NoRandomMatchFound:32760,GameDoesNotExist:32758,MaxCcuReached:32757,InvalidRegion:32756,CustomAuthenticationFailed:32755,
AuthenticationTicketExpired:32753,PluginReportedError:32752,PluginMismatch:32751,JoinFailedPeerAlreadyJoined:32750,JoinFailedFoundInactiveJoiner:32749,JoinFailedWithRejoinerNotFound:32748,JoinFailedFoundExcludedUserId:32747,JoinFailedFoundActiveJoiner:32746,HttpLimitReached:32745,ExternalHttpCallFailed:32744,OperationLimitReached:32743,SlotError:32742,InvalidEncryptionParameters:32741};b.ActorProperties={PlayerName:255,UserId:253};b.GameProperties={MaxPlayers:255,IsVisible:254,IsOpen:253,PlayerCount:252,
Removed:251,PropsListedInLobby:250,CleanupCacheOnLeave:249,MasterClientId:248,ExpectedUsers:247,PlayerTTL:246,RoomTTL:245};b.EventCode={GameList:230,GameListUpdate:229,QueueState:228,AppStats:226,AzureNodeInfo:210,Join:a.Join,Leave:a.Leave,PropertiesChanged:a.PropertiesChanged,Disconnect:252,LobbyStats:224,ErrorInfo:251,AuthEvent:223};b.ParameterCode={Address:230,PeerCount:229,GameCount:228,MasterPeerCount:227,UserId:225,ApplicationId:224,Position:223,MatchMakingType:223,GameList:222,Secret:221,AppVersion:220,
AzureNodeInfo:210,AzureLocalNodeId:209,AzureMasterNodeId:208,RoomName:c.GameId,Broadcast:c.Broadcast,ActorList:c.ActorList,ActorNr:c.ActorNr,PlayerProperties:c.ActorProperties,CustomEventContent:c.Data,Data:c.Data,Code:c.Code,GameProperties:c.GameProperties,Properties:c.Properties,TargetActorNr:c.TargetActorNr,ReceiverGroup:c.ReceiverGroup,Cache:c.Cache,CleanupCacheOnLeave:241,Group:c.Group,Remove:c.Remove,Add:c.Add,RoomTTL:c.RoomTTL,PlayerTTL:235,Plugins:204,ClientAuthenticationType:217,ClientAuthenticationParams:216,
ClientAuthenticationData:214,JoinMode:215,MasterClientId:203,FindFriendsRequestList:1,FindFriendsResponseOnlineList:1,FindFriendsResponseRoomIdList:2,LobbyName:213,LobbyType:212,LobbyStats:211,Region:210,IsInactive:233,CheckUserOnJoin:232,ExpectedValues:231,UriPath:209,RpcCallParams:208,RpcCallRetCode:207,RpcCallRetMessage:206,RpcCallRetData:208,WebFlags:234,Nickname:202,PublishUserId:239,Info:218};b.OperationCode={Authenticate:230,JoinLobby:229,LeaveLobby:228,CreateGame:227,JoinGame:226,JoinRandomGame:225,
Leave:d.Leave,RaiseEvent:d.RaiseEvent,SetProperties:d.SetProperties,GetProperties:d.GetProperties,ChangeGroups:d.ChangeGroups,FindFriends:222,LobbyStats:221,GetRegions:220,Rpc:219};b.MatchmakingMode={FillRoom:0,SerialMatching:1,RandomMatching:2};b.EventCaching={DoNotCache:0,MergeCache:1,ReplaceCache:2,RemoveCache:3,AddToRoomCache:4,AddToRoomCacheGlobal:5,RemoveFromRoomCache:6,RemoveFromRoomCacheForActorsLeft:7};b.ReceiverGroup={Others:0,All:1,MasterClient:2};b.CustomAuthenticationType={Custom:0,Steam:1,
Facebook:2,Oculus:3,PlayStation4:4,Xbox:5,Viveport:10,NintendoSwitch:11,PlayStation5:12,Epic:13,FacebookGaming:15,None:255};b.LobbyType={Default:0,SqlLobby:2,AsyncRandomLobby:3}})(Photon||(Photon={}));
(function(a){(function(b){(function(c){var d;c.ParameterCode={Channels:0,Channel:1,Messages:2,Message:3,Senders:4,Sender:5,ChannelUserCount:6,UserId:225,MsgId:8,MsgIds:9,SubscribeResults:15,Status:10,Friends:11,SkipMessage:12,HistoryLength:14,WebFlags:21,Properties:22,ChannelSubscribers:23};c.OperationCode={Subscribe:0,Unsubscribe:1,Publish:2,SendPrivate:3,ChannelHistory:4,UpdateStatus:5,AddFriendds:6,RemoveFriends:7};c.EventCode={ChatMessages:0,Users:1,PrivateMessage:2,FriendsList:3,StatusUpdate:4,
Subscribe:5,Unsubscribe:6,UserSubscribe:8,UserUnsubscribe:9};c.UserStatus={Offline:0,Invisible:1,Online:2,Away:3,Dnd:4,Lfg:5,Playing:6};var m=(d={},d[c.UserStatus.Offline]="Offline",d[c.UserStatus.Invisible]="Invisible",d[c.UserStatus.Online]="Online",d[c.UserStatus.Away]="Away",d[c.UserStatus.Dnd]="Dnd",d[c.UserStatus.Lfg]="Lfg",d[c.UserStatus.Playing]="Playing",d);c.ChannelProperties={MaxSubscribers:255,PublishSubscribers:254};c.UserStatusToName=function(l){return m[l]}})(b.Constants||(b.Constants=
{}))})(a.Chat||(a.Chat={}))})(Photon||(Photon={}));
(function(a){(function(b){var c,d=function(){function k(n,p){this.sender=n;this.content=p}k.prototype.getSender=function(){return this.sender};k.prototype.getContent=function(){return this.content};return k}();b.Message=d;var m=function(){function k(n,p){this.name=n;this.isPrivat=p;this.messages=[];this.lastId=0;this.properties={};this.publishSubscribers=!1;this.maxSubscribers=0;this.subscribers={}}k.prototype.getName=function(){return this.name};k.prototype.isPrivate=function(){return this.isPrivat};
k.prototype.getMessages=function(){return this.messages};k.prototype.getLastId=function(){return this.lastId};k.prototype.clearMessages=function(){this.messages.splice(0)};k.prototype.addMessages=function(n,p){for(var q=[],h=0;h<n.length;h++)if(h<p.length){var e=new d(n[h],p[h]);this.messages.push(e);q.push(e)}return q};k.prototype.readProperties=function(n){if(n){for(var p in n)this.properties[p]=null==n[p]?void 0:n[p];p=n[b.Constants.ChannelProperties.PublishSubscribers];void 0!=p&&(this.publishSubscribers=
p);p=n[b.Constants.ChannelProperties.MaxSubscribers];void 0!=p&&(this.maxSubscribers=p)}};k.prototype.addSubscriber=function(n){return this.subscribers[n]||Object.keys(this.subscribers).length>this.maxSubscribers?!1:this.subscribers[n]=!0};k.prototype.removeSubscriber=function(n){if(!this.subscribers[n])return!1;delete this.subscribers[n];return!0};k.prototype.reset=function(){this.subscribers={};this.properties={}};return k}();b.Channel=m;var l=function(k){function n(p,q,h){p=k.call(this,p,q,h)||
this;p.DefaultMaxSubscribers=100;p.publicChannels={};p.privateChannels={};p.subscribeRequests=[];p.unsubscribeRequests=[];p.autoJoinLobby=!1;return p}__extends(n,k);n.prototype.onStateChange=function(p){};n.prototype.onError=function(p,q){};n.prototype.onSubscribeResult=function(p){};n.prototype.onUnsubscribeResult=function(p){};n.prototype.onChatMessages=function(p,q){};n.prototype.onPrivateMessage=function(p,q){};n.prototype.onUserStatusUpdate=function(p,q,h,e){};n.prototype.onUserSubscribe=function(p,
q){};n.prototype.onUserUnsubscribe=function(p,q){};n.prototype.connectToNameServer=function(p){return k.prototype.connectToNameServer.call(this,p)};n.prototype.connectToRegionFrontEnd=function(p){return this.connectToRegionMaster(p)};n.prototype.isConnectedToFrontEnd=function(){return this.state()==n.ChatState.ConnectedToFrontEnd};n.prototype.subscribe=function(p,q){"number"==typeof q&&(q={historyLength:q});if(this.masterPeer&&this.isConnectedToFrontEnd()){this.logger.debug("Subscribe channels:",
p);var h=[];h.push(b.Constants.ParameterCode.Channels,a.TypeExt.String(p));if(q&&(q.historyLength&&h.push(b.Constants.ParameterCode.HistoryLength,a.TypeExt.Int(q.historyLength)),q.lastIds&&(h.push(b.Constants.ParameterCode.MsgIds,a.TypeExt.Int(q.lastIds)),void 0===q.historyLength&&h.push(b.Constants.ParameterCode.HistoryLength,a.TypeExt.Int(-1))),q.createOptions&&q.createOptions.publishSubscribers)){if(q.createOptions.maxSubscribers>this.DefaultMaxSubscribers)return this.logger.error("Cannot set MaxSubscribers > "+
this.DefaultMaxSubscribers+" when PublishSubscribers == true."),!1;p=a.TypeExt.DictTypedKeys(a.TypeExtType.Object,a.TypeExtType.Object);a.TypeExt.PutTypedKey(p,a.TypeExt.Byte(b.Constants.ChannelProperties.PublishSubscribers),!0);a.TypeExt.PutTypedKey(p,a.TypeExt.Byte(b.Constants.ChannelProperties.MaxSubscribers),a.TypeExt.Int(q.createOptions.maxSubscribers));h.push(b.Constants.ParameterCode.Properties,p)}this.masterPeer.sendOperation(b.Constants.OperationCode.Subscribe,h);return!0}this.logger.error("subscribe request error:",
"Not connected to Front End");return!1};n.prototype.unsubscribe=function(p){if(this.masterPeer&&this.isConnectedToFrontEnd()){this.logger.debug("Unsubscribe channels:",p);var q=[];q.push(b.Constants.ParameterCode.Channels,a.TypeExt.String(p));this.masterPeer.sendOperation(b.Constants.OperationCode.Unsubscribe,q);return!0}this.logger.error("unsubscribe request error:","Not connected to Front End");return!1};n.prototype.publishMessage=function(p,q,h){if(this.masterPeer&&this.isConnectedToFrontEnd()){var e=
[];e.push(b.Constants.ParameterCode.Channel,p);e.push(b.Constants.ParameterCode.Message,q);h&&h.webForward&&(e.push(b.Constants.ParameterCode.WebFlags),e.push(a.TypeExt.Byte(1)));this.masterPeer.sendOperation(b.Constants.OperationCode.Publish,e);return!0}this.logger.error("publishMessage request error:","Not connected to Front End");return!1};n.prototype.sendPrivateMessage=function(p,q,h){if(this.masterPeer&&this.isConnectedToFrontEnd()){var e=[];e.push(b.Constants.ParameterCode.UserId,p);e.push(b.Constants.ParameterCode.Message,
q);h&&h.webForward&&(e.push(b.Constants.ParameterCode.WebFlags),e.push(a.TypeExt.Byte(1)));this.masterPeer.sendOperation(b.Constants.OperationCode.SendPrivate,e);return!0}this.logger.error("sendPrivateMessage request error:","Not connected to Front End");return!1};n.prototype.setUserStatus=function(p,q,h){void 0===q&&(q=null);void 0===h&&(h=!1);if(this.masterPeer&&this.isConnectedToFrontEnd()){var e=[];e.push(b.Constants.ParameterCode.Status,a.TypeExt.Int(p));h?e.push(b.Constants.ParameterCode.SkipMessage,
!0):e.push(b.Constants.ParameterCode.Message,q);this.masterPeer.sendOperation(b.Constants.OperationCode.UpdateStatus,e);return!0}this.logger.error("setUserStatus request error:","Not connected to Front End");return!1};n.prototype.addFriends=function(p){if(this.masterPeer&&this.isConnectedToFrontEnd()){var q=[];q.push(b.Constants.ParameterCode.Friends,a.TypeExt.String(p));this.masterPeer.sendOperation(b.Constants.OperationCode.AddFriendds,q);return!0}this.logger.error("addFriends request error:","Not connected to Front End");
return!1};n.prototype.removeFriends=function(p){if(this.masterPeer&&this.isConnectedToFrontEnd()){var q=[];q.push(b.Constants.ParameterCode.Friends,a.TypeExt.String(p));this.masterPeer.sendOperation(b.Constants.OperationCode.RemoveFriends,q);return!0}this.logger.error("removeFriends request error:","Not connected to Front End");return!1};n.prototype.getPublicChannels=function(){return this.publicChannels};n.prototype.getPrivateChannels=function(){return this.privateChannels};n.prototype.getOrAddChannel=
function(p,q,h){void 0==p[q]&&(p[q]=new m(q,h));return p[q]};n.prototype.initMasterPeer=function(p){var q=this;k.prototype.initMasterPeer.call(this,p);p.addEventListener(b.Constants.EventCode.ChatMessages,function(h){var e=h.vals[b.Constants.ParameterCode.Senders],f=h.vals[b.Constants.ParameterCode.Messages],g=h.vals[b.Constants.ParameterCode.Channel],t=q.publicChannels[g];t?(e=t.addMessages(e,f),t.lastId=h.vals[b.Constants.ParameterCode.MsgId],q.onChatMessages(g,e)):p._logger.warn("ev ChatMessages: Got message from unsubscribed channel ",
g)});p.addEventListener(b.Constants.EventCode.PrivateMessage,function(h){var e=h.vals[b.Constants.ParameterCode.Sender],f=h.vals[b.Constants.ParameterCode.Message],g=h.vals[b.Constants.ParameterCode.UserId];g=q.getUserId()==e?g:e;q.getOrAddChannel(q.privateChannels,g,!0).lastId=h.vals[b.Constants.ParameterCode.MsgId];q.onPrivateMessage(g,new d(e,f))});p.addEventListener(b.Constants.EventCode.StatusUpdate,function(h){var e=h.vals[b.Constants.ParameterCode.Message];q.onUserStatusUpdate(h.vals[b.Constants.ParameterCode.Sender],
h.vals[b.Constants.ParameterCode.Status],void 0!==e,e)});p.addEventListener(b.Constants.EventCode.Subscribe,function(h){p._logger.debug("ev Subscribe",h);var e={},f=h.vals[b.Constants.ParameterCode.Channels]||[],g=h.vals[b.Constants.ParameterCode.SubscribeResults]||[],t=!1,r=h.vals[b.Constants.ParameterCode.Properties];h=h.vals[b.Constants.ParameterCode.ChannelSubscribers];void 0!=r&&(1==f.length?t=!0:q.logger.error("Subscribe event for multiple channels with channels properties returned. Ignoring properties."));
for(var u=0;u<f.length;u++){var v=f[u];e[v]=!1;if(u<g.length&&g[u]){var w=q.getOrAddChannel(q.publicChannels,v,!1);w.reset();e[v]=!0;if(t&&(w.readProperties(r),h))for(u=0;u<h.length;u++)if(!w.addSubscriber(h[u])){p._logger.error("Subscribe: channel '"+v+"' max subscribers exceeded");break}}}q.onSubscribeResult(e)});p.addEventListener(b.Constants.EventCode.Unsubscribe,function(h){p._logger.debug("ev Unsubscribe",h);var e={};h=h.vals[b.Constants.ParameterCode.Channels]||[];for(var f=0;f<h.length;f++){var g=
h[f];delete q.publicChannels[g];e[g]=!0}q.onUnsubscribeResult(e)});p.addEventListener(b.Constants.EventCode.UserSubscribe,function(h){p._logger.debug("ev UserSubscribe",h);var e=h.vals[b.Constants.ParameterCode.Channel];h=h.vals[b.Constants.ParameterCode.UserId];var f=q.publicChannels[e];void 0==f?p._logger.error("UserSubscribe: channel '"+e+"' not found"):f.addSubscriber(h)||p._logger.error("UserSubscribe: channel '"+e+"' max subscribers exceeded");q.onUserSubscribe(e,h)});p.addEventListener(b.Constants.EventCode.UserUnsubscribe,
function(h){p._logger.debug("ev UserUnsubscribe",h);var e=h.vals[b.Constants.ParameterCode.Channel];h=h.vals[b.Constants.ParameterCode.UserId];var f=q.publicChannels[e];void 0==f?p._logger.debug("UserUnsubscribe: channel '"+e+"' not found"):f.removeSubscriber(h)||p._logger.debug("UserUnsubscribe: subscriber '"+h+"' not found in channel '"+e+"'");q.onUserUnsubscribe(e,h)})};n.StateToName=function(p){var q=n.chatStateName[p];return void 0===q?k.StateToName.call(this,p):q};n.ChatPeerErrorCode={Ok:0,
FrontEndError:1001,FrontEndConnectFailed:1002,FrontEndConnectClosed:1003,FrontEndTimeout:1004,FrontEndEncryptionEstablishError:1005,FrontEndAuthenticationFailed:1101,NameServerError:3001,NameServerConnectFailed:3002,NameServerConnectClosed:3003,NameServerTimeout:3004,NameServerEncryptionEstablishError:300,NameServerAuthenticationFailed:3101};n.ChatState={Error:-1,Uninitialized:0,ConnectingToNameServer:1,ConnectedToNameServer:2,ConnectingToFrontEnd:3,ConnectedToFrontEnd:4,Disconnected:10};n.chatStateName=
(c={},c[n.ChatState.Error]="Error",c[n.ChatState.Uninitialized]="Uninitialized",c[n.ChatState.ConnectingToNameServer]="ConnectingToNameServer",c[n.ChatState.ConnectedToNameServer]="ConnectedToNameServer",c[n.ChatState.ConnectingToFrontEnd]="ConnectingToFrontEnd",c[n.ChatState.ConnectedToFrontEnd]="ConnectedToFrontEnd",c[n.ChatState.Disconnected]="Disconnected",c);return n}(a.LoadBalancing.LoadBalancingClient);b.ChatClient=l})(a.Chat||(a.Chat={}))})(Photon||(Photon={}));
(function(a){a.IsEmscriptenBuild=a.IsEmscriptenBuildInternal;a.Version="4.4.0.0"})(Photon||(Photon={}));
