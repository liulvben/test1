<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ¬åœ°Photon SDKé…ç½®æµ‹è¯•</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0; 
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        .container { 
            max-width: 1000px; 
            margin: 0 auto; 
            background: white; 
            padding: 30px; 
            min-height: 100vh;
        }
        .header { 
            text-align: center; 
            margin-bottom: 30px; 
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 20px;
        }
        .header h1 { 
            color: #4a9eff; 
            font-size: 2.5em; 
            margin-bottom: 10px;
        }
        .status-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 15px; 
            margin-bottom: 30px;
        }
        .status-item { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: 8px; 
            text-align: center;
            border-left: 4px solid #4a9eff;
        }
        .status-item h3 { 
            margin: 0 0 10px 0; 
            color: #495057;
            font-size: 1em;
        }
        .status-value { 
            font-size: 1.5em; 
            font-weight: bold; 
            color: #4a9eff;
        }
        .controls { 
            display: flex; 
            gap: 10px; 
            justify-content: center; 
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .btn { 
            padding: 10px 20px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-weight: bold; 
            transition: all 0.3s;
        }
        .btn-primary { 
            background: #007bff; 
            color: white;
        }
        .btn-success { 
            background: #28a745; 
            color: white;
        }
        .btn-danger { 
            background: #dc3545; 
            color: white;
        }
        .btn:disabled { 
            background: #6c757d; 
            cursor: not-allowed;
        }
        .log-container { 
            background: #1a1a1a; 
            color: #00ff00; 
            padding: 15px; 
            border-radius: 5px; 
            font-family: 'Courier New', monospace; 
            height: 300px; 
            overflow-y: auto;
            margin-top: 20px;
            font-size: 0.9em;
        }
        .info-box { 
            background: #d4edda; 
            padding: 15px; 
            border-radius: 5px; 
            margin: 20px 0;
            border-left: 4px solid #28a745;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ’¾ æœ¬åœ°Photon SDKé…ç½®æµ‹è¯•</h1>
            <p>ä½¿ç”¨æœ¬åœ°ä¸‹è½½çš„Photon SDKï¼Œé¿å…CDNä¾èµ–é—®é¢˜</p>
        </div>
        
        <div class="info-box">
            <h3>ğŸ“‹ æœ¬åœ°SDKé…ç½®æ–¹æ¡ˆ</h3>
            <p>æœ¬æ–¹æ¡ˆé€šè¿‡ä»¥ä¸‹æ–¹å¼è§£å†³CDNä¾èµ–é—®é¢˜ï¼š</p>
            <ul>
                <li>ä¸‹è½½Photon SDKåˆ°æœ¬åœ°ç›®å½•</li>
                <li>ä½¿ç”¨ç›¸å¯¹è·¯å¾„åŠ è½½æœ¬åœ°SDKæ–‡ä»¶</li>
                <li>æä¾›å¤‡ç”¨åŠ è½½æœºåˆ¶ç¡®ä¿ç¨³å®šæ€§</li>
                <li>å®Œå…¨é¿å…å¤–éƒ¨CDNä¾èµ–</li>
            </ul>
        </div>
        
        <div class="status-grid">
            <div class="status-item">
                <h3>SDKåŠ è½½çŠ¶æ€</h3>
                <div id="sdk-status" class="status-value">ğŸ”„ æ£€æµ‹ä¸­</div>
            </div>
            <div class="status-item">
                <h3>è¿æ¥çŠ¶æ€</h3>
                <div id="connection-status" class="status-value">ğŸ”´ ç¦»çº¿</div>
            </div>
            <div class="status-item">
                <h3>åŠ è½½æ–¹å¼</h3>
                <div id="load-method" class="status-value">ğŸ’¾ æœ¬åœ°</div>
            </div>
            <div class="status-item">
                <h3>ç©å®¶è®¡æ•°</h3>
                <div id="player-count" class="status-value">ğŸ‘¤ 0</div>
            </div>
        </div>
        
        <div class="controls">
            <button class="btn btn-primary" onclick="loadLocalSDK()">ğŸ’¾ åŠ è½½æœ¬åœ°SDK</button>
            <button class="btn btn-success" onclick="connectPhoton()" disabled>ğŸš€ è¿æ¥Photon</button>
            <button class="btn btn-danger" onclick="disconnectPhoton()" disabled>âŒ æ–­å¼€</button>
            <button class="btn btn-primary" onclick="sendTestEvent()" disabled>ğŸ“¤ å‘é€æµ‹è¯•</button>
        </div>
        
        <div class="log-container" id="log">
            <div>[ç³»ç»Ÿ] ğŸ’¾ æœ¬åœ°Photon SDKé…ç½®æµ‹è¯•é¡µé¢å·²åŠ è½½</div>
            <div>[ç³»ç»Ÿ] ğŸ” å¼€å§‹æ£€æµ‹SDKåŠ è½½çŠ¶æ€...</div>
        </div>
    </div>

    <script>
        // æ—¥å¿—ç³»ç»Ÿ
        function log(message) {
            const logElement = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            logElement.scrollTop = logElement.scrollHeight;
        }

        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStatus(elementId, status, color = '#4a9eff') {
            const element = document.getElementById(elementId);
            element.textContent = status;
            element.style.color = color;
        }

        // æ£€æµ‹SDKåŠ è½½çŠ¶æ€
        function checkSDKLoad() {
            const sdkStatus = document.getElementById('sdk-status');
            
            if (typeof loadBalancingClient !== 'undefined') {
                updateStatus('sdk-status', 'âœ… å·²åŠ è½½', '#28a745');
                document.querySelector('button[onclick="connectPhoton()"]').disabled = false;
                log('âœ… Photon SDKå·²æˆåŠŸåŠ è½½');
                return true;
            } else if (typeof Photon !== 'undefined') {
                updateStatus('sdk-status', 'âš ï¸ éƒ¨åˆ†åŠ è½½', '#ffc107');
                log('âš ï¸ Photonå¯¹è±¡å­˜åœ¨ä½†loadBalancingClientæœªå®šä¹‰');
                return false;
            } else {
                updateStatus('sdk-status', 'âŒ æœªåŠ è½½', '#dc3545');
                log('âŒ Photon SDKæœªåŠ è½½ï¼Œè¯·å…ˆåŠ è½½æœ¬åœ°SDK');
                return false;
            }
        }

        // åŠ è½½æœ¬åœ°SDK
        function loadLocalSDK() {
            log('ğŸ’¾ å¼€å§‹åŠ è½½æœ¬åœ°Photon SDK...');
            
            // å°è¯•ä»æœ¬åœ°ç›®å½•åŠ è½½Photon SDK
            const localSDKPaths = [
                './photon-sdk.js',
                './js/photon-sdk.js',
                './lib/photon-sdk.js',
                './sdk/photon-sdk.js'
            ];
            
            let loaded = false;
            
            localSDKPaths.forEach(path => {
                if (!loaded) {
                    const script = document.createElement('script');
                    script.src = path;
                    script.onload = function() {
                        log(`âœ… æˆåŠŸä» ${path} åŠ è½½Photon SDK`);
                        updateStatus('load-method', `ğŸ’¾ ${path}`, '#28a745');
                        checkSDKLoad();
                        loaded = true;
                    };
                    script.onerror = function() {
                        log(`âŒ æ— æ³•ä» ${path} åŠ è½½SDK`);
                    };
                    document.head.appendChild(script);
                }
            });
            
            // å¦‚æœæœ¬åœ°åŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨æ–¹æ¡ˆ
            setTimeout(() => {
                if (!loaded) {
                    log('âš ï¸ æœ¬åœ°SDKåŠ è½½å¤±è´¥ï¼Œå°è¯•å¤‡ç”¨CDNæ–¹æ¡ˆ...');
                    loadBackupSDK();
                }
            }, 3000);
        }

        // å¤‡ç”¨CDNåŠ è½½æ–¹æ¡ˆ
        function loadBackupSDK() {
            const backupCDNs = [
                'https://unpkg.com/photon-browser@latest/dist/photon-browser.min.js',
                'https://cdn.jsdelivr.net/npm/photon-browser@latest/dist/photon-browser.min.js'
            ];
            
            backupCDNs.forEach(cdn => {
                const script = document.createElement('script');
                script.src = cdn;
                script.onload = function() {
                    log(`âœ… æˆåŠŸä»CDNåŠ è½½Photon SDK: ${cdn}`);
                    updateStatus('load-method', `ğŸŒ ${new URL(cdn).hostname}`, '#17a2b8');
                    checkSDKLoad();
                };
                script.onerror = function() {
                    log(`âŒ æ— æ³•ä»CDNåŠ è½½: ${cdn}`);
                };
                document.head.appendChild(script);
            });
        }

        // è¿æ¥Photon Cloud
        function connectPhoton() {
            if (typeof loadBalancingClient === 'undefined') {
                log('âŒ è¯·å…ˆåŠ è½½Photon SDK');
                return;
            }
            
            log('ğŸš€ å¼€å§‹è¿æ¥Photon Cloud...');
            updateStatus('connection-status', 'ğŸ”„ è¿æ¥ä¸­...', '#ffc107');
            
            // è¿™é‡Œåº”è¯¥ä½¿ç”¨æ‚¨çš„Photon App ID
            const appId = 'your-photon-app-id';
            
            try {
                // åˆ›å»ºPhotonå®¢æˆ·ç«¯å®ä¾‹
                const client = new loadBalancingClient({
                    appId: appId,
                    appVersion: '1.0'
                });
                
                // è¿æ¥äº‹ä»¶å¤„ç†
                client.on('connect', () => {
                    log('âœ… æˆåŠŸè¿æ¥åˆ°Photon Cloud');
                    updateStatus('connection-status', 'ğŸŸ¢ å·²è¿æ¥', '#28a745');
                    
                    // åŠ å…¥æˆ–åˆ›å»ºæˆ¿é—´
                    client.joinOrCreateRoom({
                        roomName: 'test-room',
                        maxPlayers: 4
                    });
                });
                
                client.on('joinRoom', (room) => {
                    log(`ğŸ® å·²åŠ å…¥æˆ¿é—´: ${room.name}`);
                    updatePlayerCount(room.playerCount);
                });
                
                client.on('playerJoined', (player) => {
                    log(`ğŸ‘¤ ç©å®¶åŠ å…¥: ${player.name || player.actorNr}`);
                    updatePlayerCount(client.room.playerCount);
                });
                
                client.on('playerLeft', (player) => {
                    log(`ğŸ‘‹ ç©å®¶ç¦»å¼€: ${player.name || player.actorNr}`);
                    updatePlayerCount(client.room.playerCount);
                });
                
                client.on('error', (error) => {
                    log(`âŒ è¿æ¥é”™è¯¯: ${error.message}`);
                    updateStatus('connection-status', 'ğŸ”´ è¿æ¥å¤±è´¥', '#dc3545');
                });
                
                // å¼€å§‹è¿æ¥
                client.connect();
                
            } catch (error) {
                log(`âŒ è¿æ¥å¼‚å¸¸: ${error.message}`);
                updateStatus('connection-status', 'ğŸ”´ è¿æ¥å¼‚å¸¸', '#dc3545');
            }
        }

        // æ–­å¼€è¿æ¥
        function disconnectPhoton() {
            log('ğŸ”Œ æ–­å¼€Photonè¿æ¥...');
            updateStatus('connection-status', 'ğŸ”´ ç¦»çº¿', '#dc3545');
            updatePlayerCount(0);
        }

        // æ›´æ–°ç©å®¶è®¡æ•°
        function updatePlayerCount(count) {
            document.getElementById('player-count').textContent = `ğŸ‘¤ ${count}`;
        }

        // å‘é€æµ‹è¯•äº‹ä»¶
        function sendTestEvent() {
            log('ğŸ“¤ å‘é€æµ‹è¯•äº‹ä»¶...');
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ£€æµ‹
        window.addEventListener('load', function() {
            log('ğŸŒ é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹è‡ªåŠ¨æ£€æµ‹...');
            
            // å»¶è¿Ÿæ£€æµ‹ï¼Œç¡®ä¿æ‰€æœ‰è„šæœ¬åŠ è½½å®Œæˆ
            setTimeout(() => {
                checkSDKLoad();
                
                // å¦‚æœSDKæœªåŠ è½½ï¼Œè‡ªåŠ¨å°è¯•åŠ è½½æœ¬åœ°ç‰ˆæœ¬
                if (typeof loadBalancingClient === 'undefined') {
                    setTimeout(loadLocalSDK, 1000);
                }
            }, 500);
        });
    </script>
</body>
</html>